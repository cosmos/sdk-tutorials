<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Introduce a Leaderboard After Production | Developer Portal</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/svg+xml" href="/favicon-svg.svg">
    <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png">
    <script>const userThemeMode = localStorage?.getItem("vuepress-theme-cosmos-user-theme") || 'dark-mode'
      document.documentElement.className = userThemeMode</script>
    <meta name="description" content="A leaderboard for your in-production blockchain via state migration">
    <meta name="msapplication-TileColor" content="#2e3148">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.a886febc.css" as="style"><link rel="preload" href="/assets/js/app.e7d2f874.js" as="script"><link rel="preload" href="/assets/js/11.39391087.js" as="script"><link rel="preload" href="/assets/js/60.d571514a.js" as="script"><link rel="preload" href="/assets/js/31.7ca06c11.js" as="script"><link rel="preload" href="/assets/js/12.7b770c4a.js" as="script"><link rel="preload" href="/assets/js/51.f36e3bc4.js" as="script"><link rel="preload" href="/assets/js/43.1d7161fa.js" as="script"><link rel="preload" href="/assets/js/29.e215b871.js" as="script"><link rel="preload" href="/assets/js/7.f3d82fac.js" as="script"><link rel="preload" href="/assets/js/14.a9d9e9b7.js" as="script"><link rel="preload" href="/assets/js/28.d92f36b6.js" as="script"><link rel="preload" href="/assets/js/42.502234a2.js" as="script"><link rel="preload" href="/assets/js/128.f972a0c8.js" as="script"><link rel="preload" href="/assets/js/21.9d9ccc09.js" as="script"><link rel="preload" href="/assets/js/5.c35904c3.js" as="script"><link rel="preload" href="/assets/js/17.66ac4eeb.js" as="script"><link rel="preload" href="/assets/js/19.966db46a.js" as="script"><link rel="preload" href="/assets/js/6.40a03b2d.js" as="script"><link rel="preload" href="/assets/js/8.fb2ee7ea.js" as="script"><link rel="preload" href="/assets/js/36.97682ccd.js" as="script"><link rel="preload" href="/assets/js/13.33cabc32.js" as="script"><link rel="preload" href="/assets/js/59.c9a6ce8d.js" as="script"><link rel="preload" href="/assets/js/39.3421a09a.js" as="script"><link rel="prefetch" href="/assets/js/1.1719d940.js"><link rel="prefetch" href="/assets/js/10.0f38fc3b.js"><link rel="prefetch" href="/assets/js/100.28f187f7.js"><link rel="prefetch" href="/assets/js/101.99e2720f.js"><link rel="prefetch" href="/assets/js/102.81ee9a3a.js"><link rel="prefetch" href="/assets/js/103.77f23971.js"><link rel="prefetch" href="/assets/js/104.f8083efc.js"><link rel="prefetch" href="/assets/js/105.7e92b9a1.js"><link rel="prefetch" href="/assets/js/106.ba4a8fae.js"><link rel="prefetch" href="/assets/js/107.9f54c9f5.js"><link rel="prefetch" href="/assets/js/108.4655f866.js"><link rel="prefetch" href="/assets/js/109.4904b2fa.js"><link rel="prefetch" href="/assets/js/110.0ca97bae.js"><link rel="prefetch" href="/assets/js/111.21bce05f.js"><link rel="prefetch" href="/assets/js/112.0e6c78f6.js"><link rel="prefetch" href="/assets/js/113.83704f6c.js"><link rel="prefetch" href="/assets/js/114.32d8b92c.js"><link rel="prefetch" href="/assets/js/115.a21f218d.js"><link rel="prefetch" href="/assets/js/116.97c5ed60.js"><link rel="prefetch" href="/assets/js/117.5dbe042f.js"><link rel="prefetch" href="/assets/js/118.7dae2802.js"><link rel="prefetch" href="/assets/js/119.3b252d66.js"><link rel="prefetch" href="/assets/js/120.d3bf67e6.js"><link rel="prefetch" href="/assets/js/121.5ba74ef0.js"><link rel="prefetch" href="/assets/js/122.8cef4c0f.js"><link rel="prefetch" href="/assets/js/123.8b553d88.js"><link rel="prefetch" href="/assets/js/124.cace3e27.js"><link rel="prefetch" href="/assets/js/125.c9370449.js"><link rel="prefetch" href="/assets/js/126.e04eece7.js"><link rel="prefetch" href="/assets/js/127.6fa0927e.js"><link rel="prefetch" href="/assets/js/129.8f059481.js"><link rel="prefetch" href="/assets/js/130.7456dab9.js"><link rel="prefetch" href="/assets/js/131.5ae54e80.js"><link rel="prefetch" href="/assets/js/132.9484b72b.js"><link rel="prefetch" href="/assets/js/133.eedb4236.js"><link rel="prefetch" href="/assets/js/134.fb1a214f.js"><link rel="prefetch" href="/assets/js/135.62d2f90a.js"><link rel="prefetch" href="/assets/js/136.42c38675.js"><link rel="prefetch" href="/assets/js/137.cb720f97.js"><link rel="prefetch" href="/assets/js/138.0a8430f8.js"><link rel="prefetch" href="/assets/js/139.653ca143.js"><link rel="prefetch" href="/assets/js/140.b395c62e.js"><link rel="prefetch" href="/assets/js/141.8faaae5f.js"><link rel="prefetch" href="/assets/js/142.8137caa8.js"><link rel="prefetch" href="/assets/js/143.921d9926.js"><link rel="prefetch" href="/assets/js/144.accc3762.js"><link rel="prefetch" href="/assets/js/145.a8b48a17.js"><link rel="prefetch" href="/assets/js/146.ac4b57e4.js"><link rel="prefetch" href="/assets/js/147.88a64c4c.js"><link rel="prefetch" href="/assets/js/148.e35abd61.js"><link rel="prefetch" href="/assets/js/149.60678521.js"><link rel="prefetch" href="/assets/js/15.7eaae5b8.js"><link rel="prefetch" href="/assets/js/150.e45780de.js"><link rel="prefetch" href="/assets/js/151.bc995177.js"><link rel="prefetch" href="/assets/js/152.075e8954.js"><link rel="prefetch" href="/assets/js/153.271ba657.js"><link rel="prefetch" href="/assets/js/154.7a686655.js"><link rel="prefetch" href="/assets/js/155.d790cc3e.js"><link rel="prefetch" href="/assets/js/156.f3632807.js"><link rel="prefetch" href="/assets/js/157.23e348fc.js"><link rel="prefetch" href="/assets/js/158.ea2fc486.js"><link rel="prefetch" href="/assets/js/159.037dd87e.js"><link rel="prefetch" href="/assets/js/16.e7bf6454.js"><link rel="prefetch" href="/assets/js/160.3f4a16eb.js"><link rel="prefetch" href="/assets/js/161.d829ca1b.js"><link rel="prefetch" href="/assets/js/162.1a21662d.js"><link rel="prefetch" href="/assets/js/163.16787cc2.js"><link rel="prefetch" href="/assets/js/164.4cd11fcb.js"><link rel="prefetch" href="/assets/js/165.1eef322b.js"><link rel="prefetch" href="/assets/js/166.2c852d27.js"><link rel="prefetch" href="/assets/js/167.65bdda29.js"><link rel="prefetch" href="/assets/js/168.9bee00aa.js"><link rel="prefetch" href="/assets/js/169.a65207f5.js"><link rel="prefetch" href="/assets/js/170.21150d3f.js"><link rel="prefetch" href="/assets/js/171.d54a0f0e.js"><link rel="prefetch" href="/assets/js/172.df0285dd.js"><link rel="prefetch" href="/assets/js/173.22fb7b46.js"><link rel="prefetch" href="/assets/js/174.86141603.js"><link rel="prefetch" href="/assets/js/175.142fe5ed.js"><link rel="prefetch" href="/assets/js/176.11c1e74d.js"><link rel="prefetch" href="/assets/js/177.e9620a98.js"><link rel="prefetch" href="/assets/js/178.a2a33396.js"><link rel="prefetch" href="/assets/js/18.7dec0037.js"><link rel="prefetch" href="/assets/js/20.530f61a5.js"><link rel="prefetch" href="/assets/js/22.df32c229.js"><link rel="prefetch" href="/assets/js/23.50dac89b.js"><link rel="prefetch" href="/assets/js/24.343d37dc.js"><link rel="prefetch" href="/assets/js/25.3cdceea8.js"><link rel="prefetch" href="/assets/js/26.c347af69.js"><link rel="prefetch" href="/assets/js/27.37c887e0.js"><link rel="prefetch" href="/assets/js/3.9294c531.js"><link rel="prefetch" href="/assets/js/30.2b27a3ac.js"><link rel="prefetch" href="/assets/js/32.82afedc0.js"><link rel="prefetch" href="/assets/js/33.197d03fe.js"><link rel="prefetch" href="/assets/js/34.17a4f3f5.js"><link rel="prefetch" href="/assets/js/35.5311312b.js"><link rel="prefetch" href="/assets/js/37.62488aa0.js"><link rel="prefetch" href="/assets/js/38.a4db0207.js"><link rel="prefetch" href="/assets/js/4.7209b182.js"><link rel="prefetch" href="/assets/js/40.c4480ea9.js"><link rel="prefetch" href="/assets/js/41.bdfe721e.js"><link rel="prefetch" href="/assets/js/44.13e35e9f.js"><link rel="prefetch" href="/assets/js/45.dcca7c5d.js"><link rel="prefetch" href="/assets/js/46.debb6651.js"><link rel="prefetch" href="/assets/js/47.3d5fa428.js"><link rel="prefetch" href="/assets/js/48.55397c2b.js"><link rel="prefetch" href="/assets/js/49.a9efe5ea.js"><link rel="prefetch" href="/assets/js/50.2dc04985.js"><link rel="prefetch" href="/assets/js/52.5268e481.js"><link rel="prefetch" href="/assets/js/53.e03e9de9.js"><link rel="prefetch" href="/assets/js/54.74922d97.js"><link rel="prefetch" href="/assets/js/55.41eb632b.js"><link rel="prefetch" href="/assets/js/56.1a26f4f6.js"><link rel="prefetch" href="/assets/js/57.3745b8ea.js"><link rel="prefetch" href="/assets/js/58.dd3678a4.js"><link rel="prefetch" href="/assets/js/61.1915fd44.js"><link rel="prefetch" href="/assets/js/62.507f5b2a.js"><link rel="prefetch" href="/assets/js/63.23043990.js"><link rel="prefetch" href="/assets/js/64.fe4769dc.js"><link rel="prefetch" href="/assets/js/65.38da52de.js"><link rel="prefetch" href="/assets/js/66.09ba8806.js"><link rel="prefetch" href="/assets/js/67.07b0c0f4.js"><link rel="prefetch" href="/assets/js/68.833250bd.js"><link rel="prefetch" href="/assets/js/69.5384e181.js"><link rel="prefetch" href="/assets/js/70.7db56fb9.js"><link rel="prefetch" href="/assets/js/71.72f65030.js"><link rel="prefetch" href="/assets/js/72.7a5a609f.js"><link rel="prefetch" href="/assets/js/73.b4ac3f8d.js"><link rel="prefetch" href="/assets/js/74.14ff443b.js"><link rel="prefetch" href="/assets/js/75.1ca6e693.js"><link rel="prefetch" href="/assets/js/76.4c046251.js"><link rel="prefetch" href="/assets/js/77.2319a67a.js"><link rel="prefetch" href="/assets/js/78.e48d2234.js"><link rel="prefetch" href="/assets/js/79.4636222e.js"><link rel="prefetch" href="/assets/js/80.0ac0e9a1.js"><link rel="prefetch" href="/assets/js/81.24621bec.js"><link rel="prefetch" href="/assets/js/82.5b95e4c3.js"><link rel="prefetch" href="/assets/js/83.8ea87142.js"><link rel="prefetch" href="/assets/js/84.0bcbbd85.js"><link rel="prefetch" href="/assets/js/85.4ae3bdbd.js"><link rel="prefetch" href="/assets/js/86.a2c4af7b.js"><link rel="prefetch" href="/assets/js/87.428e427d.js"><link rel="prefetch" href="/assets/js/88.07305356.js"><link rel="prefetch" href="/assets/js/89.04a72159.js"><link rel="prefetch" href="/assets/js/9.a3454f00.js"><link rel="prefetch" href="/assets/js/90.7e0aae53.js"><link rel="prefetch" href="/assets/js/91.2de4b798.js"><link rel="prefetch" href="/assets/js/92.2a6806f8.js"><link rel="prefetch" href="/assets/js/93.09e04e68.js"><link rel="prefetch" href="/assets/js/94.7273a3fe.js"><link rel="prefetch" href="/assets/js/95.3f937cf6.js"><link rel="prefetch" href="/assets/js/96.fd07662e.js"><link rel="prefetch" href="/assets/js/97.f8f70486.js"><link rel="prefetch" href="/assets/js/98.a45a7518.js"><link rel="prefetch" href="/assets/js/99.9ca895a9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a886febc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-v-3aade422><div class="banner" data-v-40401285 data-v-3aade422><div class="banner-wrapper" data-v-40401285 data-v-40401285><div class="wrapper" data-v-40401285><div class="message" data-v-40401285>By using this website, you agree to our <a href="https://www.cookiesandyou.com" target="_blank" rel="noopener" style="color:#505FFF;" data-v-40401285>Cookie Policy</a>.</div> <div class="box" data-v-40401285><span class="icon-cross" data-v-40401285><svg width="16" height="16" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-40401285><path d="M1.66669 1.66669L12.3334 12.3334M12.3334 1.66669L1.66664 12.3334" stroke="#A2A3AD" stroke-width="1.5" stroke-linecap="round" data-v-40401285></path></svg></span></div></div></div></div><div class="global__layout" data-v-3aade422><div class="header" data-v-b28d69b6 data-v-3aade422><div class="header__nav" data-v-b28d69b6><div class="header__nav__logo" data-v-b28d69b6><a href="/" rel="noreferrer noopener" tag="div" class="logo__image" data-v-b28d69b6><svg width="144" height="28" viewBox="0 0 144 28" fill="black" xmlns="http://www.w3.org/2000/svg" data-v-b28d69b6><path fill-rule="evenodd" clip-rule="evenodd" d="M16 20.0202L14.0251 18.0202C13.275 18.72 12.5167 19.2745 11.7497 19.6829C10.9834 20.091 10.0666 20.2951 9.00008 20.2951C8.16662 20.2951 7.3959 20.1329 6.68758 19.8077C5.97926 19.4826 5.36673 19.0371 4.84999 18.4701C4.33325 17.9035 3.93355 17.2411 3.64989 16.4829C3.36656 15.7247 3.22523 14.9118 3.22523 14.0457C3.22523 13.1789 3.36656 12.3705 3.64989 11.6204C3.93355 10.8706 4.33325 10.2166 4.84999 9.65808C5.36673 9.09989 5.97926 8.6584 6.68758 8.33326C7.3959 8.00846 8.16662 7.8459 9.00008 7.8459C9.99983 7.8459 10.8916 8.0459 11.6748 8.44591C12.4584 8.84558 13.2001 9.37072 13.8997 10.0207L15.8749 7.74606C15.4583 7.34605 15.0168 6.97944 14.55 6.64587C14.0835 6.31264 13.5752 6.02494 13.025 5.78345C12.4749 5.54163 11.8708 5.35444 11.2124 5.22122C10.554 5.08765 9.82477 5.02087 9.02504 5.02087C7.69171 5.02087 6.47508 5.25865 5.37516 5.73354C4.2749 6.20842 3.32507 6.85835 2.525 7.68333C1.72493 8.50831 1.10431 9.47056 0.66245 10.5707C0.220592 11.6706 0 12.8457 0 14.0956C0 15.3621 0.224977 16.5453 0.67493 17.6455C1.12488 18.745 1.74585 19.6991 2.53748 20.5076C3.32912 21.3157 4.26646 21.9531 5.34986 22.4199C6.43326 22.8867 7.61683 23.1198 8.89991 23.1198C9.71684 23.1198 10.4626 23.0489 11.1375 22.9073C11.8125 22.7656 12.4334 22.5575 13.0001 22.2827C13.5667 22.0074 14.096 21.6823 14.5877 21.3076C15.0792 20.9325 15.55 20.5032 16 20.0202" fill="#2E3148"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M55.6691 9.97591C55.6691 9.39376 55.9177 8.8991 56.4152 8.49193C56.9123 8.08409 57.6087 7.88051 58.5037 7.88051C59.2995 7.88051 60.0868 8.03462 60.8657 8.34219C61.645 8.64975 62.4323 9.09461 63.2277 9.67642L64.8688 7.35691C63.9741 6.64184 63.0167 6.09737 61.9972 5.72352C60.9774 5.34933 59.8298 5.16223 58.5534 5.16223C57.6916 5.16223 56.8959 5.2827 56.1706 5.52397C55.4413 5.76491 54.82 6.10982 54.3018 6.55872C53.7838 7.00795 53.3776 7.544 53.0793 8.16754C52.7851 8.79108 52.6359 9.48529 52.6359 10.2502C52.6359 11.0648 52.7643 11.755 53.0213 12.3203C53.2783 12.8857 53.6553 13.3679 54.1444 13.767C54.6332 14.1661 55.2424 14.4985 55.9633 14.7647C56.6886 15.0309 57.5135 15.2715 58.4457 15.4878C59.2582 15.6874 59.9167 15.8785 60.4266 16.0612C60.9322 16.2443 61.33 16.4398 61.6242 16.6474C61.914 16.8554 62.1133 17.0839 62.221 17.3332C62.3287 17.5829 62.3824 17.8652 62.3824 18.1812C62.3824 18.8633 62.1049 19.4037 61.5497 19.8025C60.9942 20.2019 60.2441 20.4011 59.2995 20.4011C58.2055 20.4011 57.2273 20.2056 56.3655 19.8149C55.5034 19.4243 54.65 18.8633 53.8043 18.1314L51.9646 20.3264C53.0089 21.274 54.1444 21.9766 55.3709 22.4339C56.5977 22.8912 57.8821 23.1197 59.2247 23.1197C60.1364 23.1197 60.9738 23.0033 61.7363 22.7708C62.4944 22.5376 63.1492 22.1967 63.688 21.7478C64.2307 21.2989 64.6534 20.7504 64.96 20.102C65.2626 19.4535 65.4159 18.7136 65.4159 17.8821C65.4159 17.1505 65.2958 16.5145 65.0553 15.9741C64.8148 15.4337 64.4585 14.9602 63.9946 14.5524C63.5303 14.1452 62.9419 13.7999 62.2374 13.5173C61.5333 13.2349 60.7208 12.9772 59.809 12.7443C58.9761 12.5448 58.2924 12.3533 57.7496 12.1706C57.2109 11.9879 56.7882 11.7883 56.4772 11.5719C56.1706 11.3559 55.9596 11.1231 55.8432 10.8737C55.7275 10.624 55.6691 10.3249 55.6691 9.97591" fill="#2E3148"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M89.7054 10.223V22.6955H92.7433V5.30359H89.4809L84.1768 13.5276L78.8726 5.30359H75.6106V22.6955H78.6485V10.2726L84.1019 18.4221H84.2017L89.7054 10.223Z" fill="#2E3148"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M118.268 14.0956C118.268 14.9455 118.122 15.7496 117.831 16.5081C117.54 17.2663 117.137 17.9244 116.621 18.4825C116.105 19.0407 115.486 19.4826 114.762 19.8077C114.038 20.1328 113.244 20.2951 112.379 20.2951C111.514 20.2951 110.715 20.1284 109.983 19.7952C109.252 19.4617 108.623 19.0117 108.099 18.4454C107.576 17.8785 107.168 17.2161 106.877 16.4579C106.586 15.6997 106.44 14.8953 106.44 14.0457C106.44 13.1954 106.586 12.3913 106.877 11.6331C107.168 10.8746 107.571 10.2166 108.087 9.65806C108.603 9.09986 109.223 8.65837 109.946 8.33324C110.67 8.00844 111.464 7.84587 112.329 7.84587C113.194 7.84587 113.993 8.01249 114.725 8.34605C115.456 8.67928 116.085 9.12921 116.608 9.69583C117.133 10.2621 117.54 10.9249 117.831 11.6831C118.122 12.4413 118.268 13.2457 118.268 14.0956ZM121.487 14.0457C121.487 12.8123 121.262 11.6456 120.813 10.5455C120.364 9.44593 119.74 8.4874 118.942 7.67085C118.143 6.85397 117.187 6.20842 116.072 5.73354C114.957 5.25865 113.727 5.02087 112.379 5.02087C111.032 5.02087 109.801 5.2627 108.686 5.74602C107.571 6.22933 106.606 6.88331 105.791 7.70829C104.976 8.53327 104.344 9.49585 103.895 10.5957C103.446 11.6956 103.221 12.8622 103.221 14.0956C103.221 15.3287 103.446 16.495 103.895 17.5952C104.344 18.6954 104.968 19.6536 105.766 20.4701C106.565 21.2867 107.521 21.9326 108.636 22.4074C109.75 22.8823 110.981 23.1198 112.329 23.1198C113.676 23.1198 114.908 22.8779 116.022 22.395C117.137 21.9117 118.101 21.2577 118.917 20.4324C119.732 19.6077 120.364 18.6451 120.813 17.5453C121.262 16.4454 121.487 15.2788 121.487 14.0457V14.0457Z" fill="#2E3148"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M134.253 9.97591C134.253 9.39376 134.502 8.8991 134.999 8.49193C135.496 8.08409 136.192 7.88051 137.088 7.88051C137.883 7.88051 138.671 8.03462 139.45 8.34219C140.229 8.64975 141.016 9.09461 141.812 9.67642L143.453 7.35691C142.558 6.64184 141.6 6.09737 140.581 5.72352C139.562 5.34933 138.414 5.16223 137.137 5.16223C136.276 5.16223 135.48 5.2827 134.755 5.52397C134.025 5.76491 133.404 6.10982 132.886 6.55872C132.368 7.00795 131.962 7.544 131.663 8.16754C131.369 8.79108 131.22 9.48529 131.22 10.2502C131.22 11.0648 131.348 11.755 131.605 12.3203C131.862 12.8857 132.239 13.3679 132.728 13.767C133.217 14.1661 133.826 14.4985 134.548 14.7647C135.273 15.0309 136.097 15.2715 137.03 15.4878C137.842 15.6874 138.501 15.8785 139.011 16.0612C139.516 16.2443 139.914 16.4398 140.208 16.6474C140.498 16.8554 140.697 17.0839 140.805 17.3332C140.913 17.5829 140.967 17.8652 140.967 18.1812C140.967 18.8633 140.689 19.4037 140.134 19.8025C139.578 20.2019 138.828 20.4011 137.883 20.4011C136.789 20.4011 135.811 20.2056 134.949 19.8149C134.088 19.4243 133.234 18.8633 132.388 18.1314L130.549 20.3264C131.593 21.274 132.728 21.9766 133.955 22.4339C135.181 22.8912 136.466 23.1197 137.809 23.1197C138.72 23.1197 139.557 23.0033 140.32 22.7708C141.078 22.5376 141.733 22.1967 142.272 21.7478C142.815 21.2989 143.237 20.7504 143.544 20.102C143.846 19.4535 144 18.7136 144 17.8821C144 17.1505 143.879 16.5145 143.639 15.9741C143.399 15.4337 143.043 14.9602 142.578 14.5524C142.114 14.1452 141.526 13.7999 140.821 13.5173C140.117 13.2349 139.304 12.9772 138.393 12.7443C137.56 12.5448 136.876 12.3533 136.334 12.1706C135.795 11.9879 135.372 11.7883 135.061 11.5719C134.755 11.3559 134.543 11.1231 134.427 10.8737C134.311 10.624 134.253 10.3249 134.253 9.97591" fill="#2E3148"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M36.8401 8.78536L28.5159 17.0984C28.4086 16.8904 28.3117 16.6737 28.2249 16.4489C27.9342 15.6936 27.7888 14.8922 27.7888 14.0458C27.7888 13.1987 27.9342 12.3977 28.2249 11.6424C28.5159 10.8867 28.919 10.2312 29.4345 9.67476C29.9499 9.11868 30.5694 8.67885 31.2924 8.35495C32.0158 8.03138 32.8095 7.86942 33.6739 7.86942C34.5386 7.86942 35.3367 8.03541 36.0679 8.36771C36.3397 8.49103 36.5971 8.63013 36.8401 8.78536ZM36.1056 19.786C35.3822 20.1099 34.5884 20.2715 33.7241 20.2715C32.8593 20.2715 32.0613 20.1055 31.3298 19.7736C31.0582 19.6499 30.8008 19.5108 30.5583 19.3552L38.8821 11.0429C38.9894 11.2505 39.0863 11.4669 39.1731 11.692C39.4638 12.4474 39.6092 13.2487 39.6092 14.0955C39.6092 14.9422 39.4638 15.7432 39.1731 16.4989C38.8821 17.2542 38.479 17.9098 37.9635 18.4658C37.4481 19.0219 36.829 19.4621 36.1056 19.786ZM37.365 22.3635C38.479 21.882 39.4433 21.2305 40.2579 20.4083C41.0725 19.5868 41.704 18.6278 42.1529 17.5321C42.602 16.4364 42.8265 15.2742 42.8265 14.0458C42.8265 12.817 42.602 11.6548 42.1529 10.5588C41.8867 9.90893 41.559 9.30883 41.17 8.75813L46.5841 3.35152L44.4328 1.20312L39.0022 6.62619C38.5147 6.29422 37.9854 6.00728 37.4148 5.76502C36.3007 5.29193 35.0706 5.05505 33.7241 5.05505C32.3772 5.05505 31.1471 5.29596 30.033 5.77745C28.919 6.25894 27.9547 6.91045 27.1401 7.73231C26.3255 8.55417 25.6936 9.51312 25.2448 10.6088C24.7959 11.7045 24.5715 12.8668 24.5715 14.0955C24.5715 15.3239 24.7959 16.4858 25.2448 17.5819C25.5113 18.232 25.839 18.8321 26.2279 19.3832L20.8142 24.7891L22.9656 26.9375L28.3958 21.5148C28.8833 21.8467 29.4126 22.1337 29.9832 22.3759C31.0973 22.849 32.3274 23.0856 33.6739 23.0856C35.0208 23.0856 36.2509 22.8447 37.365 22.3635V22.3635Z" fill="#2E3148"></path></svg></a></div><div class="header__search" data-v-b28d69b6><div data-v-59595218 data-v-b28d69b6><div class="searchbar__wrapper" data-v-59595218><div class="searchbar__title" data-v-35a69946 data-v-59595218><div class="container" data-v-35a69946><div class="crumbs tm-title tm-lh-title" data-v-35a69946><div class="crumbs__item" data-v-35a69946><a href="/" class="crumbs__link tm-link router-link-active" data-v-35a69946>Developer Portal</a></div><div class="crumbs__item" data-v-35a69946><a href="/hands-on-exercise/1-ignite-cli/" class="crumbs__link tm-link" data-v-35a69946>Hands-on Exercise</a></div></div><div class="menu" data-v-35a69946><div class="menu__item" style="visibility:visible;" data-v-35a69946><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu__item__icon menu__item__icon__active__false" data-v-35a69946><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 2C0.25 1.58579 0.585786 1.25 1 1.25H6C6.41421 1.25 6.75 1.58579 6.75 2C6.75 2.41421 6.41421 2.75 6 2.75H1C0.585786 2.75 0.25 2.41421 0.25 2ZM17.53 22.7803L16.9997 22.25L17.53 22.7803L17.5301 22.7802L17.5305 22.7798L17.5322 22.7781L17.5388 22.7715L17.5647 22.7456L17.6647 22.6456L18.0367 22.2737L19.2978 21.0126L22.53 17.7803C22.8229 17.4874 22.8229 17.0126 22.53 16.7197C22.2371 16.4268 21.7622 16.4268 21.4693 16.7197L18.2371 19.9519L17.7497 20.4393V8.5C17.7497 6.34186 17.0721 4.51182 15.7802 3.21983C14.4882 1.92783 12.6581 1.25031 10.5 1.25031C10.0858 1.25031 9.75 1.5861 9.75 2.00031C9.75 2.41453 10.0858 2.75031 10.5 2.75031C12.3419 2.75031 13.7617 3.32264 14.7195 4.28049C15.6773 5.23834 16.2497 6.65814 16.2497 8.5L16.2497 20.4393L12.53 16.7197C12.2371 16.4268 11.7622 16.4268 11.4693 16.7197C11.1764 17.0126 11.1764 17.4874 11.4693 17.7803L16.4693 22.7803L16.9997 23.3107L17.53 22.7803ZM1 6.25C0.585786 6.25 0.25 6.58579 0.25 7C0.25 7.41421 0.585786 7.75 1 7.75H10C10.4142 7.75 10.75 7.41421 10.75 7C10.75 6.58579 10.4142 6.25 10 6.25H1ZM0.25 12C0.25 11.5858 0.585786 11.25 1 11.25H12C12.4142 11.25 12.75 11.5858 12.75 12C12.75 12.4142 12.4142 12.75 12 12.75H1C0.585786 12.75 0.25 12.4142 0.25 12ZM1 16.25C0.585786 16.25 0.25 16.5858 0.25 17C0.25 17.4142 0.585786 17.75 1 17.75H8C8.41421 17.75 8.75 17.4142 8.75 17C8.75 16.5858 8.41421 16.25 8 16.25H1Z" data-v-35a69946></path></svg><!----></div></div></div></div><div class="search tm-lh-title tm-rf-1 tm-medium" data-v-59595218><div class="search__icon" data-v-59595218><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-59595218><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div><div class="search__text" data-v-59595218>Search</div></div></div><div class="sheet__sidebar" data-v-205decaf data-v-59595218><!----> <!----></div></div></div><div class="header__nav__links" data-v-b28d69b6></div><div class="header__nav__mobile__menu" data-v-b28d69b6><div class="icon-menu__wrapper" data-v-5d6665a6 data-v-b28d69b6><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-5d6665a6><line x1="2" y1="7.5" x2="22" y2="7.5" stroke="var(--color-text-strong)" data-v-5d6665a6></line><line x1="2" y1="15.5" x2="22" y2="15.5" stroke="var(--color-text-strong)" data-v-5d6665a6></line></svg></div></div></div><div class="header__search__mobile" data-v-b28d69b6><div data-v-59595218 data-v-b28d69b6><div class="searchbar__wrapper" data-v-59595218><div class="searchbar__title" data-v-35a69946 data-v-59595218><div class="container" data-v-35a69946><div class="crumbs tm-title tm-lh-title" data-v-35a69946><div class="crumbs__item" data-v-35a69946><a href="/" class="crumbs__link tm-link router-link-active" data-v-35a69946>Developer Portal</a></div><div class="crumbs__item" data-v-35a69946><a href="/hands-on-exercise/1-ignite-cli/" class="crumbs__link tm-link" data-v-35a69946>Hands-on Exercise</a></div></div><div class="menu" data-v-35a69946><div class="menu__item" style="visibility:visible;" data-v-35a69946><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="menu__item__icon menu__item__icon__active__false" data-v-35a69946><path fill-rule="evenodd" clip-rule="evenodd" d="M0.25 2C0.25 1.58579 0.585786 1.25 1 1.25H6C6.41421 1.25 6.75 1.58579 6.75 2C6.75 2.41421 6.41421 2.75 6 2.75H1C0.585786 2.75 0.25 2.41421 0.25 2ZM17.53 22.7803L16.9997 22.25L17.53 22.7803L17.5301 22.7802L17.5305 22.7798L17.5322 22.7781L17.5388 22.7715L17.5647 22.7456L17.6647 22.6456L18.0367 22.2737L19.2978 21.0126L22.53 17.7803C22.8229 17.4874 22.8229 17.0126 22.53 16.7197C22.2371 16.4268 21.7622 16.4268 21.4693 16.7197L18.2371 19.9519L17.7497 20.4393V8.5C17.7497 6.34186 17.0721 4.51182 15.7802 3.21983C14.4882 1.92783 12.6581 1.25031 10.5 1.25031C10.0858 1.25031 9.75 1.5861 9.75 2.00031C9.75 2.41453 10.0858 2.75031 10.5 2.75031C12.3419 2.75031 13.7617 3.32264 14.7195 4.28049C15.6773 5.23834 16.2497 6.65814 16.2497 8.5L16.2497 20.4393L12.53 16.7197C12.2371 16.4268 11.7622 16.4268 11.4693 16.7197C11.1764 17.0126 11.1764 17.4874 11.4693 17.7803L16.4693 22.7803L16.9997 23.3107L17.53 22.7803ZM1 6.25C0.585786 6.25 0.25 6.58579 0.25 7C0.25 7.41421 0.585786 7.75 1 7.75H10C10.4142 7.75 10.75 7.41421 10.75 7C10.75 6.58579 10.4142 6.25 10 6.25H1ZM0.25 12C0.25 11.5858 0.585786 11.25 1 11.25H12C12.4142 11.25 12.75 11.5858 12.75 12C12.75 12.4142 12.4142 12.75 12 12.75H1C0.585786 12.75 0.25 12.4142 0.25 12ZM1 16.25C0.585786 16.25 0.25 16.5858 0.25 17C0.25 17.4142 0.585786 17.75 1 17.75H8C8.41421 17.75 8.75 17.4142 8.75 17C8.75 16.5858 8.41421 16.25 8 16.25H1Z" data-v-35a69946></path></svg><!----></div></div></div></div><div class="search tm-lh-title tm-rf-1 tm-medium" data-v-59595218><div class="search__icon" data-v-59595218><svg width="100%" height="100%" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-59595218><path fill-rule="evenodd" clip-rule="evenodd" d="M11.5 2.75C6.66751 2.75 2.75 6.66751 2.75 11.5C2.75 16.3325 6.66751 20.25 11.5 20.25C13.6462 20.25 15.612 19.4773 17.1342 18.1949L22.6697 23.7303C22.9626 24.0232 23.4374 24.0232 23.7303 23.7303C24.0232 23.4374 24.0232 22.9626 23.7303 22.6697L18.1949 17.1342C19.4773 15.612 20.25 13.6462 20.25 11.5C20.25 6.66751 16.3325 2.75 11.5 2.75ZM16.6923 16.5599C17.9656 15.2535 18.75 13.4684 18.75 11.5C18.75 7.49594 15.5041 4.25 11.5 4.25C7.49594 4.25 4.25 7.49594 4.25 11.5C4.25 15.5041 7.49594 18.75 11.5 18.75C13.4684 18.75 15.2535 17.9656 16.5599 16.6923C16.5789 16.6679 16.5996 16.6444 16.622 16.622C16.6444 16.5996 16.6679 16.5789 16.6923 16.5599Z"></path></svg></div><div class="search__text" data-v-59595218>Search</div></div></div><div class="sheet__sidebar" data-v-205decaf data-v-59595218><!----> <!----></div></div></div></div><div class="global__layout__content content-padding" data-v-3aade422><div data-v-2e1fc9fe data-v-3aade422><div class="layout" data-v-2e1fc9fe><div class="layout__sidebar" data-v-2e1fc9fe><div style="position:relative;" data-v-8bd213ec data-v-2e1fc9fe><div class="tags-filter" data-v-8bd213ec><div class="tags-filter__header" data-v-8bd213ec><div class="tags-filter__select" data-v-8bd213ec><span class="icon tags-filter__select__arrow tags-filter__select__arrow__collapsed" style="--fill-color:var(--semi-transparent-color-3);" data-v-7aca3159 data-v-8bd213ec><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--fill-color)" data-v-7aca3159></path></svg></span><div class="tags-filter__select__label tags-filter__select__label__collapsed" data-v-8bd213ec> Filters</div></div><!----></div><!----></div><div class="container" data-v-8bd213ec><div class="items footer__compact__false" data-v-8bd213ec><div class="sidebar" data-v-8bd213ec><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted title mb-4" data-v-8bd213ec></div><!----></div><div class="sidebar" data-v-8bd213ec><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted title mb-4" data-v-8bd213ec>Introduction to Cosmos</div><!----></div><div class="sidebar" data-v-8bd213ec><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted title mb-4" data-v-8bd213ec>Tutorials</div><!----></div><div class="sidebar" data-v-8bd213ec><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted title mb-4" data-v-8bd213ec>Hands-on Exercise</div><!----></div><div class="sidebar" data-v-8bd213ec><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted title mb-4" data-v-8bd213ec>What's Next</div><!----></div><div class="sidebar version" data-v-8bd213ec><div data-v-4b2f605b data-v-8bd213ec><div class="container" data-v-4b2f605b><span class="sr-only" data-v-4b2f605b>Docs Version Switcher</span><!----></div></div></div></div><!----></div></div><div class="layout__sidebar__aside" data-v-2e1fc9fe><!----></div></div><div class="layout__main" data-v-2e1fc9fe><div class="layout__main__content aside__true" data-v-2e1fc9fe><div id="content-scroll" class="layout__main__content__body" data-v-2e1fc9fe><div class="layout__main__content__body__wrapper" data-v-2e1fc9fe><div style="width: 100%" data-v-2e1fc9fe><div class="container content__default" data-v-2e1fc9fe><div class="content__default" data-v-3aade422><h1 id="introduce-a-leaderboard-after-production"><a href="#introduce-a-leaderboard-after-production" class="header-anchor">#</a> Introduce a Leaderboard After Production</h1> <div class="wrapper prerequisite" data-v-8a444a42><div class="content prerequisite" data-v-8a444a42><div class="icon prerequisite" data-v-8a444a42><img src="/hi-prerequesite-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>Make sure you have all you need before proceeding:</p> <ul data-v-8a444a42><li data-v-8a444a42>You understand the concepts of <a href="/academy/2-cosmos-concepts/6-protobuf.html">Protobuf</a> and <a href="/academy/2-cosmos-concepts/12-migrations.html">migrations</a>.</li> <li data-v-8a444a42>Go is installed.</li> <li data-v-8a444a42>You have the checkers blockchain codebase up to the wager denomination. If not, follow the <a href="/hands-on-exercise/2-ignite-cli-adv/8-wager-denom.html">previous steps</a> or check out the <a href="https://github.com/cosmos/b9-checkers-academy-draft/tree/v1-wager-denomination" target="_blank" rel="noopener noreferrer" data-v-8a444a42>relevant version<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul></div></div> <div class="wrapper learning" data-v-8a444a42><div class="content learning" data-v-8a444a42><div class="icon learning" data-v-8a444a42><img src="/hi-target-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>In this section, you will:</p> <ul data-v-8a444a42><li data-v-8a444a42>Add a leaderboard.</li> <li data-v-8a444a42>Upgrade your blockchain in production.</li> <li data-v-8a444a42>Deal with data migrations and logic upgrades.</li></ul></div></div> <p>If you have been running <em>v1</em> of your checkers blockchain for a while, games have been created, played on, won, and lost. In this section, you will introduce <em>v2</em> of your blockchain with leaderboard support. A good leaderboard fulfills these conditions:</p> <ul><li>Any player who has <strong>ever</strong> played should have a tally of games won, lost, and forfeited.</li> <li>The leaderboard should list the players with the most wins up to a pre-determined number. For example, the leaderboard could only include the top 100 scores.</li> <li>To avoid squatting and increase engagement, when equal in value the most recent score takes precedence over an <em>older</em> one, so the player with the recent score is listed higher on the leaderboard.</li></ul> <p>When you introduce the leaderboard, you also have to decide what to do with your existing players and their scores from your v1 checkers blockchain.</p> <p>Start your v2's leaderboard as if all played past games had been counted for the leaderboard. You <em>only</em> need to go through all played games, update the players with their tallies, and add a leaderboard including the information. This is possible because all past games and their outcomes are kept in the chain's state. Migration is a good method to tackle the initial leaderboard.</p> <p>For the avoidance of doubt, <strong>v1 and v2 refer to the overall versions of the application</strong>, and not to the <em>consensus versions</em> of individual modules, which may change or not.</p> <h2 id="introducing-a-leaderboard"><a href="#introducing-a-leaderboard" class="header-anchor">#</a> Introducing a leaderboard</h2> <p>Several things need to be addressed before you can focus all your attention on the migration:</p> <ol><li>Save and mark as v1 the current data types about to be modified with the new version. Data types that will remain unmodified need not be identified as such.</li> <li>Prepare your v2 blockchain:
<ol><li>Define your new data types.</li> <li>Add helper functions to encapsulate clearly defined actions, like leaderboard sorting.</li> <li>Adjust the existing code to make use of and update the new data types.</li></ol></li> <li>Prepare for your v1-to-v2 migration:
<ol><li>Add helper functions to process large amounts of data from the latest chain state of type v1.</li> <li>Add a function to migrate your state from v1 to v2.</li> <li>Make sure you can handle large amounts of data.</li></ol></li></ol> <p><em>Why do you need to make sure you can handle large amounts of data?</em> The full state at the point of migration may well have millions of games. You do not want your process to grind to a halt because of a lack of memory or I/O capacity.</p> <h2 id="save-your-v1"><a href="#save-your-v1" class="header-anchor">#</a> Save your v1</h2> <p>Your migration steps will be handled in a new folder, <code>x/checkers/migrations/v1tov2</code>, which needs to be created:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>$ mkdir -p x/checkers/migrations/v1tov2
</span></span></span></span> <!----></span> <!----></span></span> <p>The only <strong>data structure</strong> you will eventually change is the checkers genesis structure. The other data structures are new, so you can treat them <em>as usual</em>. Although in this specific case it is not strictly necessary, it is good to make this practice habitual. Copy and paste your compiled Protobuf v1 genesis from the current commit and save it under the same name in <code>x/checkers/migrations/v1/types/</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>$ mkdir -p x/checkers/migrations/v1/types
$ cp x/checkers/types/genesis.pb.go x/checkers/migrations/v1/types
</span></span></span></span> <!----></span> <!----></span></span> <p>Your current genesis definition eventually becomes your v2 genesis. This should be the only data structure requiring a change. However, if for example you also changed the structure of <code>StoredGame</code>, then you would have to save its v1 version in the same <code>v1/types</code> folder.</p> <h2 id="new-v2-information"><a href="#new-v2-information" class="header-anchor">#</a> New v2 information</h2> <p>It is time to take a closer look at the new data structures being introduced with the version upgrade.</p> <div class="wrapper tip" data-v-8a444a42><div class="content tip" data-v-8a444a42><div class="icon tip" data-v-8a444a42><img src="/hi-tip-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>If you feel unsure about creating new data structures with Ignite CLI, look at the <a href="/hands-on-exercise/1-ignite-cli/4-create-message.html">previous sections</a> of the exercise again.</p></div></div> <p>To give the new v2 information a data structure, you need the following:</p> <ol><li><p>Add a set of <strong>stats per player</strong>: it makes sense to save one <code>struct</code> for each player and to map it by address. Remember that a game is stored at a <em>notional</em> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/stored_game.go#L24-L28" target="_blank" rel="noopener noreferrer"><code>StoredGame/value/123/</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, where <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/key_stored_game.go#L9" target="_blank" rel="noopener noreferrer"><code>StoredGame/value/</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a constant prefix. Similarly, Ignite CLI creates a new constant to use as the prefix for players:</p> <!----> <div class="wrapper info" data-v-8a444a42><div class="content info" data-v-8a444a42><div class="icon info" data-v-8a444a42><img src="/hi-info-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>The new <code data-v-8a444a42>PlayerInfo/value/</code> prefix for players helps differentiate between the value for players and the value for games prefixed with <code data-v-8a444a42>StoredGame/value/</code>.</p> <p data-v-8a444a42>Now you can safely have both <code data-v-8a444a42>StoredGame/value/123/</code> and <code data-v-8a444a42>PlayerInfo/value/123/</code> side by side in storage.</p></div></div> <p>This creates a Protobuf file:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">message</span> <span class="token class-name">PlayerInfo</span> <span class="token punctuation">{</span>
    <span class="token builtin">string</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token builtin">uint64</span> wonCount <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token builtin">uint64</span> lostCount <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token builtin">uint64</span> forfeitedCount <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> proto </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> player_info.proto </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/proto/checkers/player_info.proto#L6-L11" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>It also added the map of new objects to the genesis, effectively your v2 genesis:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">import</span> <span class="token string">"checkers/player_info.proto"</span><span class="token punctuation">;</span>

<span class="token keyword">message</span> <span class="token class-name">GenesisState</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">PlayerInfo</span> playerInfoList <span class="token operator">=</span> <span class="token number">4</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>gogoproto<span class="token punctuation">.</span>nullable<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> proto </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> genesis.proto </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/proto/checkers/genesis.proto#L19" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>You will use the player's address as a key to the map.</p></li> <li><p>Adjust in <code>types/genesis_test.go</code> for the expectation that you get an empty list to start with:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestDefaultGenesisState_ExpectedInitialNextId</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    PlayerInfoList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> genesis_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/genesis_test.go#L124" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>Add a <strong>leaderboard rung structure</strong> to be repeated inside the leaderboard: this stores the information of a player scoring high enough to be included in the leaderboard. It is not meant to be kept directly in storage as it is only a part of the leaderboard. Instead of involving Ignite CLI, create the structure by hand in a new file:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">message</span> <span class="token class-name">WinningPlayer</span> <span class="token punctuation">{</span>
    <span class="token builtin">string</span> playerAddress <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token builtin">uint64</span> wonCount <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token builtin">string</span> dateAdded <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> proto </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> winning_player.proto </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/proto/checkers/winning_player.proto#L6-L10" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><ul data-v-8a444a42><li data-v-8a444a42><code data-v-8a444a42>playerAddress</code> indicates the player, and gives information regarding <code data-v-8a444a42>PlayerInfo.index</code>.</li> <li data-v-8a444a42><code data-v-8a444a42>wonCount</code> determines the ranking on the leaderboard - the higher the count, the closer to the <code data-v-8a444a42>0</code> index in the array. This should exactly match the value found in the corresponding player stats. This duplication of data is a lesser evil because if <code data-v-8a444a42>wonCount</code> was missing you would have to access the player stats to sort the leaderboard.</li> <li data-v-8a444a42><code data-v-8a444a42>dateAdded</code> indicates when the player's <code data-v-8a444a42>wonCount</code> was last updated and determines the ranking when there is a tie in <code data-v-8a444a42>wonCount</code> - the more recent, the closer to the <code data-v-8a444a42>0</code> index in the array.</li></ul></div></div></li> <li><p>Add a structure for <strong>the leaderboard</strong>: there is a single stored leaderboard for the whole application. Let Ignite CLI help you implement a structure:</p> <!----></li> <li><p>This creates a Protobuf file with <code>string winners</code>. You update it with your preferred type and its <code>import</code>. Add that each element in the map is not nullable. This will compile each <code>WinningPlayer</code> to a Go object instead of a pointer:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">import</span> <span class="token string">"gogoproto/gogo.proto"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"checkers/winning_player.proto"</span><span class="token punctuation">;</span>

<span class="token keyword">message</span> <span class="token class-name">Leaderboard</span> <span class="token punctuation">{</span>
    <span class="token keyword">repeated</span> <span class="token positional-class-name class-name">WinningPlayer</span> winners <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>gogoproto<span class="token punctuation">.</span>nullable<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> proto </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.proto </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/proto/checkers/leaderboard.proto#L9-L11" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>The v2 genesis was also updated with the leaderboard. Tell it that the leaderboard should always be there (even if empty):</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">import</span> <span class="token string">"checkers/leaderboard.proto"</span><span class="token punctuation">;</span>

<span class="token keyword">message</span> <span class="token class-name">GenesisState</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token positional-class-name class-name">Leaderboard</span> leaderboard <span class="token operator">=</span> <span class="token number">5</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>gogoproto<span class="token punctuation">.</span>nullable<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> proto </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> genesis.proto </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/proto/checkers/genesis.proto#L20" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>At this point, you should run <code>ignite generate proto-go</code> so that the corresponding Go objects are re-created.</p></li> <li><p>Remember to make sure the initial value stored for the leaderboard is not <code>nil</code> but instead is empty. In <code>genesis.go</code> adjust:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">DefaultGenesis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>GenesisState <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>GenesisState<span class="token punctuation">{</span>
        <span class="token operator">...</span>
        Leaderboard<span class="token punctuation">:</span> Leaderboard<span class="token punctuation">{</span>
            Winners<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayer<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> genesis.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/genesis.go#L20-L22" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>This function returns a default genesis. This step is important if you start fresh. In your case, you do not begin with an &quot;empty&quot; genesis but with one resulting from the upcoming genesis migration in this exercise.</p> <p>In particular, update the initial genesis test:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestDefaultGenesisState_ExpectedInitialNextId</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
        Leaderboard<span class="token punctuation">:</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
            Winners<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> genesis_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/genesis_test.go#L125-L127" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>Also adjust the compilation errors:</p> <p>On <code>genesis.go</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>k<span class="token punctuation">.</span><span class="token function">SetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> genState<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">)</span> <span class="token comment">// Not testing for nil</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> genesis.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/genesis.go#L23" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>On <code>genesis_test.go</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token operator">...</span>
Leaderboard<span class="token punctuation">:</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
    Winners<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            PlayerAddress<span class="token punctuation">:</span> <span class="token string">"cosmos123"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            PlayerAddress<span class="token punctuation">:</span> <span class="token string">"cosmos456"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> genesis_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/genesis_test.go#L36-L45" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>At this point you can add a test case that catches a duplicated winner player:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token punctuation">{</span>
    desc<span class="token punctuation">:</span> <span class="token string">"duplicated winnerPlayer"</span><span class="token punctuation">,</span>
    genState<span class="token punctuation">:</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>GenesisState<span class="token punctuation">{</span>
        Leaderboard<span class="token punctuation">:</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
            Winners<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
                <span class="token punctuation">{</span>
                    PlayerAddress<span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">{</span>
                    PlayerAddress<span class="token punctuation">:</span> <span class="token string">"0"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    valid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> genesis_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/genesis_test.go#L86-L101" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>This latest test case will pass, unless you update the <code>Validate()</code> method of the genesis to not allow duplicate player addresses. This is inspired by <code>types/genesis.go</code> and best kept in a separate <code>types/leaderboard.go</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>leaderboard Leaderboard<span class="token punctuation">)</span> <span class="token function">Validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token comment">// Check for duplicated player address in winners</span>
    winnerInfoIndexMap <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> elem <span class="token operator">:=</span> <span class="token keyword">range</span> leaderboard<span class="token punctuation">.</span>Winners <span class="token punctuation">{</span>
        index <span class="token operator">:=</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token function">PlayerInfoKey</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>PlayerAddress<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token boolean">_</span><span class="token punctuation">,</span> ok <span class="token operator">:=</span> winnerInfoIndexMap<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"duplicated playerAddress for winner"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        winnerInfoIndexMap<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L12-L24" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>After this, you can adjust the <code>types/genesis.go</code> files:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token operator">...</span>
<span class="token comment">// Validate Leaderboard</span>
<span class="token keyword">if</span> err <span class="token operator">:=</span> gs<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> err
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> genesis.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/genesis.go#L51-L54" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li></ol> <p>With the structure set up, it is time to add the code using these new elements in normal operations.</p> <h2 id="v2-player-information-helpers"><a href="#v2-player-information-helpers" class="header-anchor">#</a> v2 player information helpers</h2> <p>When a game reaches its resolution, one of the <code>count</code>s needs to add <code>+1</code>.</p> <div class="expansion__container" data-v-fb49024e><div class="inner-container" data-v-fb49024e><button class="styled-button" data-v-fb49024e><span class="icon icon collapsed" data-v-7aca3159 data-v-fb49024e><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span><p data-v-fb49024e>A detailed look into the code</p></button><div class="expansion__content" data-v-fb49024e><p data-v-fb49024e>To start, add a private helper function that gets the stats from the storage, updates the numbers as instructed, and saves it back:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">mustAddDeltaGameResultToPlayer</span><span class="token punctuation">(</span>
    k <span class="token operator">*</span>Keeper<span class="token punctuation">,</span>
    ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span>
    player sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">,</span>
    wonDelta <span class="token builtin">uint64</span><span class="token punctuation">,</span>
    lostDelta <span class="token builtin">uint64</span><span class="token punctuation">,</span>
    forfeitedDelta <span class="token builtin">uint64</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token punctuation">(</span>playerInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    playerInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> player<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">{</span>
        playerInfo <span class="token operator">=</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
            Index<span class="token punctuation">:</span>          player<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            WonCount<span class="token punctuation">:</span>       <span class="token number">0</span><span class="token punctuation">,</span>
            LostCount<span class="token punctuation">:</span>      <span class="token number">0</span><span class="token punctuation">,</span>
            ForfeitedCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    playerInfo<span class="token punctuation">.</span>WonCount <span class="token operator">+=</span> wonDelta
    playerInfo<span class="token punctuation">.</span>LostCount <span class="token operator">+=</span> lostDelta
    playerInfo<span class="token punctuation">.</span>ForfeitedCount <span class="token operator">+=</span> forfeitedDelta
    k<span class="token punctuation">.</span><span class="token function">SetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> playerInfo<span class="token punctuation">)</span>
    <span class="token keyword">return</span> playerInfo
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> player_info_handler.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/player_info_handler.go#L11-L33" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>You can easily call this from these public one-liner functions added to the keeper:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustAddWonGameResultToPlayer</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> player sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">)</span> types<span class="token punctuation">.</span>PlayerInfo <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mustAddDeltaGameResultToPlayer</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> player<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustAddLostGameResultToPlayer</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> player sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">)</span> types<span class="token punctuation">.</span>PlayerInfo <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mustAddDeltaGameResultToPlayer</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> player<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustAddForfeitedGameResultToPlayer</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> player sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">)</span> types<span class="token punctuation">.</span>PlayerInfo <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">mustAddDeltaGameResultToPlayer</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> player<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> player_info_handler.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/player_info_handler.go#L35-L45" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>Which player should get <code data-v-fb49024e>+1</code>, and on what count? You need to identify the loser and the winner of a game to determine this. Create another private helper:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">getWinnerAndLoserAddresses</span><span class="token punctuation">(</span>storedGame <span class="token operator">*</span>types<span class="token punctuation">.</span>StoredGame<span class="token punctuation">)</span> <span class="token punctuation">(</span>winnerAddress sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">,</span> loserAddress sdk<span class="token punctuation">.</span>AccAddress<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>NO_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>ErrThereIsNoWinner<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    redAddress<span class="token punctuation">,</span> err <span class="token operator">:=</span> storedGame<span class="token punctuation">.</span><span class="token function">GetRedAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    blackAddress<span class="token punctuation">,</span> err <span class="token operator">:=</span> storedGame<span class="token punctuation">.</span><span class="token function">GetBlackAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>RED_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
        winnerAddress <span class="token operator">=</span> redAddress
        loserAddress <span class="token operator">=</span> blackAddress
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>BLACK_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
        winnerAddress <span class="token operator">=</span> blackAddress
        loserAddress <span class="token operator">=</span> redAddress
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>ErrWinnerNotParseable<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> storedGame<span class="token punctuation">.</span>Winner<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> winnerAddress<span class="token punctuation">,</span> loserAddress
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> player_info_handler.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/player_info_handler.go#L47-L69" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>You can call this from these public helper functions added to the keeper:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustRegisterPlayerWin</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> storedGame <span class="token operator">*</span>types<span class="token punctuation">.</span>StoredGame<span class="token punctuation">)</span> <span class="token punctuation">(</span>winnerInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span> loserInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    winnerAddress<span class="token punctuation">,</span> loserAddress <span class="token operator">:=</span> <span class="token function">getWinnerAndLoserAddresses</span><span class="token punctuation">(</span>storedGame<span class="token punctuation">)</span>
    <span class="token keyword">return</span> k<span class="token punctuation">.</span><span class="token function">MustAddWonGameResultToPlayer</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> winnerAddress<span class="token punctuation">)</span><span class="token punctuation">,</span>
        k<span class="token punctuation">.</span><span class="token function">MustAddLostGameResultToPlayer</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> loserAddress<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustRegisterPlayerForfeit</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> storedGame <span class="token operator">*</span>types<span class="token punctuation">.</span>StoredGame<span class="token punctuation">)</span> <span class="token punctuation">(</span>winnerInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span> forfeiterInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    winnerAddress<span class="token punctuation">,</span> loserAddress <span class="token operator">:=</span> <span class="token function">getWinnerAndLoserAddresses</span><span class="token punctuation">(</span>storedGame<span class="token punctuation">)</span>
    <span class="token keyword">return</span> k<span class="token punctuation">.</span><span class="token function">MustAddWonGameResultToPlayer</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> winnerAddress<span class="token punctuation">)</span><span class="token punctuation">,</span>
        k<span class="token punctuation">.</span><span class="token function">MustAddForfeitedGameResultToPlayer</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> loserAddress<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> player_info_handler.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/player_info_handler.go#L71-L81" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>Be aware of the two new error types: <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/errors.go#L30" target="_blank" rel="noopener noreferrer" data-v-8a444a42><code data-v-8a444a42>ErrThereIsNoWinner</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/errors.go#L29" target="_blank" rel="noopener noreferrer" data-v-8a444a42><code data-v-8a444a42>ErrWinnerNotParseable</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div></div></div></div></div> <h2 id="v2-player-information-handling"><a href="#v2-player-information-handling" class="header-anchor">#</a> v2 player information handling</h2> <p>Now call your helper functions:</p> <ol><li><p>On a win:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token operator">...</span>
<span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>NO_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    k<span class="token punctuation">.</span>Keeper<span class="token punctuation">.</span><span class="token function">MustPayWinnings</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
    k<span class="token punctuation">.</span>Keeper<span class="token punctuation">.</span><span class="token function">MustRegisterPlayerWin</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> msg_server_play_move.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move.go#L80" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>On a forfeit:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token operator">...</span>
<span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>MoveCount <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    k<span class="token punctuation">.</span><span class="token function">MustPayWinnings</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
    k<span class="token punctuation">.</span><span class="token function">MustRegisterPlayerForfeit</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> end_block_server_game.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/end_block_server_game.go#L57" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li></ol> <h2 id="v2-leaderboard-helpers"><a href="#v2-leaderboard-helpers" class="header-anchor">#</a> v2 leaderboard helpers</h2> <p>Continue completing your v2 before tackling the migration. Your leaderboard helpers should:</p> <ol><li>Add a new candidate to your array.</li> <li>Sort the array according to the rules.</li> <li>Clip the array to a length of 100 and save the result.</li></ol> <p>Sorting entails comparing dates in cases of a score tie. This is potentially expensive if you are deserializing the date in the comparator itself. Instead, the comparator should be presented with data already deserialized. Prepare a data structure that has already deserialized the <code>dateAdded</code>, which allows you to:</p> <ol><li>Deserialize all the elements of the whole leaderboard's array.</li> <li>Sort its elements.</li> <li>Only then re-serialize its elements.</li></ol> <p>Create a new file <code>leaderboard.go</code> to encapsulate all your leaderboard helpers:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">type</span> WinningPlayerParsed <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    PlayerAddress <span class="token builtin">string</span>
    WonCount      <span class="token builtin">uint64</span>
    DateAdded     time<span class="token punctuation">.</span>Time
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L26-L30" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="expansion__container" data-v-fb49024e><div class="inner-container" data-v-fb49024e><button class="styled-button" data-v-fb49024e><span class="icon icon collapsed" data-v-7aca3159 data-v-fb49024e><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span><p data-v-fb49024e>How is dateAdded (de)serialized?</p></button><div class="expansion__content" data-v-fb49024e><p data-v-fb49024e>You can reuse the <a href="/hands-on-exercise/2-ignite-cli-adv/2-game-deadline.html">date format used for the deadline</a>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">const</span> <span class="token punctuation">(</span>
    DateAddedLayout <span class="token operator">=</span> DeadlineLayout
<span class="token punctuation">)</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> keys.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/keys.go#L84" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>Add similar functions to it, as you did when adding a deadline:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">ParseDateAddedAsTime</span><span class="token punctuation">(</span>dateAdded <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>dateAddedParsed time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dateAddedParsed<span class="token punctuation">,</span> errDateAdded <span class="token operator">:=</span> time<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>DateAddedLayout<span class="token punctuation">,</span> dateAdded<span class="token punctuation">)</span>
    <span class="token keyword">return</span> dateAddedParsed<span class="token punctuation">,</span> sdkerrors<span class="token punctuation">.</span><span class="token function">Wrapf</span><span class="token punctuation">(</span>errDateAdded<span class="token punctuation">,</span> ErrInvalidDateAdded<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dateAdded<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>winningPlayer WinningPlayer<span class="token punctuation">)</span> <span class="token function">GetDateAddedAsTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>dateAdded time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">ParseDateAddedAsTime</span><span class="token punctuation">(</span>winningPlayer<span class="token punctuation">.</span>DateAdded<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">GetDateAdded</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> time<span class="token punctuation">.</span>Time <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ctx<span class="token punctuation">.</span><span class="token function">BlockTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">FormatDateAdded</span><span class="token punctuation">(</span>dateAdded time<span class="token punctuation">.</span>Time<span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> dateAdded<span class="token punctuation">.</span><span class="token function">UTC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>DateAddedLayout<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L32-L47" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>Do the same for the new error message:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>ErrInvalidDateAdded <span class="token operator">=</span> sdkerrors<span class="token punctuation">.</span><span class="token function">Register</span><span class="token punctuation">(</span>ModuleName<span class="token punctuation">,</span> <span class="token number">1120</span><span class="token punctuation">,</span> <span class="token string">"dateAdded cannot be parsed: %s"</span><span class="token punctuation">)</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> errors.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/errors.go#L31" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></div></div></div> <div class="expansion__container" data-v-fb49024e><div class="inner-container" data-v-fb49024e><button class="styled-button" data-v-fb49024e><span class="icon icon collapsed" data-v-7aca3159 data-v-fb49024e><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span><p data-v-fb49024e>Add functions to (de)serialize WinningPlayerParsed</p></button><div class="expansion__content" data-v-fb49024e><p data-v-fb49024e>Create the methods:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>winningPlayer WinningPlayer<span class="token punctuation">)</span> <span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>parsed WinningPlayerParsed<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dateAdded<span class="token punctuation">,</span> err <span class="token operator">:=</span> winningPlayer<span class="token punctuation">.</span><span class="token function">GetDateAddedAsTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> WinningPlayerParsed<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> WinningPlayerParsed<span class="token punctuation">{</span>
        PlayerAddress<span class="token punctuation">:</span> winningPlayer<span class="token punctuation">.</span>PlayerAddress<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>      winningPlayer<span class="token punctuation">.</span>WonCount<span class="token punctuation">,</span>
        DateAdded<span class="token punctuation">:</span>     dateAdded<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>parsed WinningPlayerParsed<span class="token punctuation">)</span> <span class="token function">Stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> WinningPlayer <span class="token punctuation">{</span>
    <span class="token keyword">return</span> WinningPlayer<span class="token punctuation">{</span>
        PlayerAddress<span class="token punctuation">:</span> parsed<span class="token punctuation">.</span>PlayerAddress<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>      parsed<span class="token punctuation">.</span>WonCount<span class="token punctuation">,</span>
        DateAdded<span class="token punctuation">:</span>     <span class="token function">FormatDateAdded</span><span class="token punctuation">(</span>parsed<span class="token punctuation">.</span>DateAdded<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L49-L67" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p data-v-fb49024e>The functions are called repeatedly when serializing or deserializing arrays:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">ParseWinners</span><span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayer<span class="token punctuation">)</span> <span class="token punctuation">(</span>parsedWinners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parsedWinners <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>winners<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> parsed WinningPlayerParsed
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> winningPlayer <span class="token operator">:=</span> <span class="token keyword">range</span> winners <span class="token punctuation">{</span>
        parsed<span class="token punctuation">,</span> err <span class="token operator">=</span> winningPlayer<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
        <span class="token punctuation">}</span>
        parsedWinners<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> parsed
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> parsedWinners<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>leaderboard Leaderboard<span class="token punctuation">)</span> <span class="token function">ParseWinners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">ParseWinners</span><span class="token punctuation">(</span>leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">StringifyWinners</span><span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayer <span class="token punctuation">{</span>
    stringified <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayer<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>winners<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> winner <span class="token operator">:=</span> <span class="token keyword">range</span> winners <span class="token punctuation">{</span>
        stringified<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> winner<span class="token punctuation">.</span><span class="token function">Stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> stringified
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">CreateLeaderboardFromParsedWinners</span><span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">)</span> Leaderboard <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Leaderboard<span class="token punctuation">{</span>
        Winners<span class="token punctuation">:</span> <span class="token function">StringifyWinners</span><span class="token punctuation">(</span>winners<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L69-L98" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></div></div></div> <p>As you have a function to get an array of deserialized winning players, you can now add a function to sort the slice in place:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">SortWinners</span><span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sort<span class="token punctuation">.</span><span class="token function">SliceStable</span><span class="token punctuation">(</span>winners<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> winners<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>WonCount <span class="token operator">></span> winners<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>WonCount <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> winners<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>WonCount <span class="token operator">&lt;</span> winners<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>WonCount <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> winners<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>DateAdded<span class="token punctuation">.</span><span class="token function">After</span><span class="token punctuation">(</span>winners<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>DateAdded<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L100-L110" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>It tests in descending order, first for scores and then for the added dates.</p> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>There is no de-serialization in this <code data-v-8a444a42>func(i, j int) bool</code> callback. It is possible to write a one-liner inside this function but at the expense of readability.</p></div></div> <p>Now you will make sure that your leaderboard never exceeds a certain length. Define the maximum length:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">const</span> <span class="token punctuation">(</span>
    LeaderboardWinnerLength <span class="token operator">=</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> keys.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/keys.go#L83" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>You now have the pieces in place to create the function that adds or updates a candidate to the leaderboard:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>winners <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">,</span> now time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> candidate PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">(</span>updated <span class="token punctuation">[</span><span class="token punctuation">]</span>WinningPlayerParsed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> candidate<span class="token punctuation">.</span>WonCount <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> winners
    <span class="token punctuation">}</span>
    found <span class="token operator">:=</span> <span class="token boolean">false</span>
    <span class="token keyword">for</span> index<span class="token punctuation">,</span> winner <span class="token operator">:=</span> <span class="token keyword">range</span> winners <span class="token punctuation">{</span>
        <span class="token keyword">if</span> winner<span class="token punctuation">.</span>PlayerAddress <span class="token operator">==</span> candidate<span class="token punctuation">.</span>Index <span class="token punctuation">{</span>
            <span class="token keyword">if</span> winner<span class="token punctuation">.</span>WonCount <span class="token operator">&lt;</span> candidate<span class="token punctuation">.</span>WonCount <span class="token punctuation">{</span>
                winners<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> WinningPlayerParsed<span class="token punctuation">{</span>
                    PlayerAddress<span class="token punctuation">:</span> candidate<span class="token punctuation">.</span>Index<span class="token punctuation">,</span>
                    WonCount<span class="token punctuation">:</span>      candidate<span class="token punctuation">.</span>WonCount<span class="token punctuation">,</span>
                    DateAdded<span class="token punctuation">:</span>     now<span class="token punctuation">,</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            found <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">break</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">{</span>
        updated <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>winners<span class="token punctuation">,</span> WinningPlayerParsed<span class="token punctuation">{</span>
            PlayerAddress<span class="token punctuation">:</span> candidate<span class="token punctuation">.</span>Index<span class="token punctuation">,</span>
            WonCount<span class="token punctuation">:</span>      candidate<span class="token punctuation">.</span>WonCount<span class="token punctuation">,</span>
            DateAdded<span class="token punctuation">:</span>     now<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        updated <span class="token operator">=</span> winners
    <span class="token punctuation">}</span>
    <span class="token function">SortWinners</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span>
    <span class="token keyword">if</span> LeaderboardWinnerLength <span class="token operator">&lt;</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        updated <span class="token operator">=</span> updated<span class="token punctuation">[</span><span class="token punctuation">:</span>LeaderboardWinnerLength<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> updated
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>leaderboard <span class="token operator">*</span>Leaderboard<span class="token punctuation">)</span> <span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>now time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> candidate PlayerInfo<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    winners<span class="token punctuation">,</span> err <span class="token operator">:=</span> leaderboard<span class="token punctuation">.</span><span class="token function">ParseWinners</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
    updated <span class="token operator">:=</span> <span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>winners<span class="token punctuation">,</span> now<span class="token punctuation">,</span> candidate<span class="token punctuation">)</span>
    leaderboard<span class="token punctuation">.</span>Winners <span class="token operator">=</span> <span class="token function">StringifyWinners</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span>
    candidate<span class="token punctuation">.</span>Index <span class="token operator">=</span> <span class="token string">"fake"</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard.go#L112-L155" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <h2 id="v2-leaderboard-handling"><a href="#v2-leaderboard-handling" class="header-anchor">#</a> v2 leaderboard handling</h2> <p>You have created the leaderboard helper functions. In a separate file, add one last function to the keeper to implement the leaderboard. This function makes it possible to add a candidate winner and save the updated leaderboard:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>k <span class="token operator">*</span>Keeper<span class="token punctuation">)</span> <span class="token function">MustAddToLeaderboard</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> winnerInfo types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> types<span class="token punctuation">.</span>Leaderboard <span class="token punctuation">{</span>
    leaderboard<span class="token punctuation">,</span> found <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">GetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">"Leaderboard not found"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    err <span class="token operator">:=</span> leaderboard<span class="token punctuation">.</span><span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token function">GetDateAdded</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">,</span> winnerInfo<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>ErrCannotAddToLeaderboard<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    k<span class="token punctuation">.</span><span class="token function">SetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> leaderboard<span class="token punctuation">)</span>
    <span class="token keyword">return</span> leaderboard
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard_handler.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/leaderboard_handler.go#L10-L21" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>Be aware of the new error <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/errors.go#L32" target="_blank" rel="noopener noreferrer" data-v-8a444a42><code data-v-8a444a42>ErrCannotAddToLeaderboard</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div></div> <p>This completes most of the leaderboard preparation. The only task left is to call your new functions at the right junctures:</p> <ol><li><p>On a win:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>NO_PLAYER<span class="token punctuation">.</span>Color <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    winnerInfo<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> k<span class="token punctuation">.</span>Keeper<span class="token punctuation">.</span><span class="token function">MustRegisterPlayerWin</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
    k<span class="token punctuation">.</span>Keeper<span class="token punctuation">.</span><span class="token function">MustAddToLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> winnerInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> msg_server_play_move.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move.go#L80-L81" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li> <li><p>On a forfeit:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">if</span> storedGame<span class="token punctuation">.</span>MoveCount <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    winnerInfo<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">MustRegisterPlayerForfeit</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token operator">&amp;</span>storedGame<span class="token punctuation">)</span>
    k<span class="token punctuation">.</span><span class="token function">MustAddToLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> winnerInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> end_block_server_game.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/end_block_server_game.go#L57-L58" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span></li></ol> <p>Your leaderboard will now be updated and saved on an on-going basis as part of your v2 blockchain.</p> <h2 id="unit-tests"><a href="#unit-tests" class="header-anchor">#</a> Unit tests</h2> <p>With all these changes, it is worthwhile adding tests.</p> <h3 id="player-info-handling-unit-tests"><a href="#player-info-handling-unit-tests" class="header-anchor">#</a> Player info handling unit tests</h3> <p>Confirm with new tests that the player's information is created or updated on a win, a loss, and a forfeit. For instance, after a winning move:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestCompleteGameAddPlayerInfo</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msgServer<span class="token punctuation">,</span> keeper<span class="token punctuation">,</span> context<span class="token punctuation">,</span> ctrl<span class="token punctuation">,</span> escrow <span class="token operator">:=</span> <span class="token function">setupMsgServerWithOneGameForPlayMove</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    ctx <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">UnwrapSDKContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    <span class="token keyword">defer</span> ctrl<span class="token punctuation">.</span><span class="token function">Finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    escrow<span class="token punctuation">.</span><span class="token function">ExpectAny</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

    <span class="token function">playAllMoves</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> msgServer<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> game1Moves<span class="token punctuation">)</span>

    bobInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> bob<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> found<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          bob<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">1</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">0</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> bobInfo<span class="token punctuation">)</span>
    carolInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> carol<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> found<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          carol<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">0</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">1</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> carolInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestCompleteGameUpdatePlayerInfo</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msgServer<span class="token punctuation">,</span> keeper<span class="token punctuation">,</span> context<span class="token punctuation">,</span> ctrl<span class="token punctuation">,</span> escrow <span class="token operator">:=</span> <span class="token function">setupMsgServerWithOneGameForPlayMove</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    ctx <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">UnwrapSDKContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    <span class="token keyword">defer</span> ctrl<span class="token punctuation">.</span><span class="token function">Finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    escrow<span class="token punctuation">.</span><span class="token function">ExpectAny</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>

    keeper<span class="token punctuation">.</span><span class="token function">SetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          bob<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">1</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    keeper<span class="token punctuation">.</span><span class="token function">SetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          carol<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">4</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">5</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">playAllMoves</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> msgServer<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> game1Moves<span class="token punctuation">)</span>

    bobInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> bob<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> found<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          bob<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">2</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> bobInfo<span class="token punctuation">)</span>
    carolInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> carol<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> found<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>          carol<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span>       <span class="token number">4</span><span class="token punctuation">,</span>
        LostCount<span class="token punctuation">:</span>      <span class="token number">6</span><span class="token punctuation">,</span>
        ForfeitedCount<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> carolInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> msg_server_play_move_winner_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move_winner_test.go#L143-L206" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>You can add similar tests that confirm that nothing happens after a <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_create_game_test.go#L419-L498" target="_blank" rel="noopener noreferrer">game creation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, a <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_reject_game_test.go#L307-L381" target="_blank" rel="noopener noreferrer">reject<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, or a <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move_test.go#L538-L596" target="_blank" rel="noopener noreferrer">non-winning move<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. You should also check that a <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/end_block_server_game_test.go#L577-L682" target="_blank" rel="noopener noreferrer">forfeit is registered<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="leaderboard-handling-unit-tests"><a href="#leaderboard-handling-unit-tests" class="header-anchor">#</a> Leaderboard handling unit tests</h3> <p>Start by adding tests that confirm that the sorting of the leaderboard's winners works as expected. Here an array of test cases is a good choice:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestSortStringifiedWinners</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
        name     <span class="token builtin">string</span>
        unsorted <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer
        sorted   <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer
        err      <span class="token builtin">error</span>
    <span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">"cannot parse date"</span><span class="token punctuation">,</span>
            unsorted<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
                <span class="token punctuation">{</span>
                    PlayerAddress<span class="token punctuation">:</span> <span class="token string">"alice"</span><span class="token punctuation">,</span>
                    WonCount<span class="token punctuation">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
                    DateAdded<span class="token punctuation">:</span>     <span class="token string">"200T-01-02 15:05:05.999999999 +0000 UTC"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            sorted<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            err<span class="token punctuation">:</span>    errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">"dateAdded cannot be parsed: 200T-01-02 15:05:05.999999999 +0000 UTC: parsing time \"200T-01-02 15:05:05.999999999 +0000 UTC\" as \"2006-01-02 15:04:05.999999999 +0000 UTC\": cannot parse \"-01-02 15:05:05.999999999 +0000 UTC\" as \"2006\""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span> <span class="token comment">// More test cases</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> tt <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            leaderboard <span class="token operator">:=</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
                Winners<span class="token punctuation">:</span> tt<span class="token punctuation">.</span>unsorted<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            parsed<span class="token punctuation">,</span> err <span class="token operator">:=</span> leaderboard<span class="token punctuation">.</span><span class="token function">ParseWinners</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tt<span class="token punctuation">.</span>err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
                require<span class="token punctuation">.</span><span class="token function">EqualError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">,</span> tt<span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            types<span class="token punctuation">.</span><span class="token function">SortWinners</span><span class="token punctuation">(</span>parsed<span class="token punctuation">)</span>
            sorted <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">StringifyWinners</span><span class="token punctuation">(</span>parsed<span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>sorted<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>sorted<span class="token punctuation">)</span><span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tt<span class="token punctuation">.</span>sorted<span class="token punctuation">,</span> sorted<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard_test.go#L12-L152" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>With that done, you can confirm that the updating or addition of new player info to the leaderboard works as expected, again with an array of test cases:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestUpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tests <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">struct</span> <span class="token punctuation">{</span>
        name      <span class="token builtin">string</span>
        sorted    <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer
        candidate types<span class="token punctuation">.</span>PlayerInfo
        now       <span class="token builtin">string</span>
        expected  <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer
    <span class="token punctuation">}</span><span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span>   <span class="token string">"add to empty"</span><span class="token punctuation">,</span>
            sorted<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
            candidate<span class="token punctuation">:</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
                Index<span class="token punctuation">:</span>    <span class="token string">"alice"</span><span class="token punctuation">,</span>
                WonCount<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            now<span class="token punctuation">:</span> <span class="token string">"2006-01-02 15:05:05.999999999 +0000 UTC"</span><span class="token punctuation">,</span>
            expected<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
                <span class="token punctuation">{</span>
                    PlayerAddress<span class="token punctuation">:</span> <span class="token string">"alice"</span><span class="token punctuation">,</span>
                    WonCount<span class="token punctuation">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
                    DateAdded<span class="token punctuation">:</span>     <span class="token string">"2006-01-02 15:05:05.999999999 +0000 UTC"</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token operator">...</span> <span class="token comment">// More test cases</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> tt <span class="token operator">:=</span> <span class="token keyword">range</span> tests <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            now<span class="token punctuation">,</span> err <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">ParseDateAddedAsTime</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>now<span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
            leaderboard <span class="token operator">:=</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
                Winners<span class="token punctuation">:</span> tt<span class="token punctuation">.</span>sorted<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
            err <span class="token operator">=</span> leaderboard<span class="token punctuation">.</span><span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>now<span class="token punctuation">,</span> tt<span class="token punctuation">.</span>candidate<span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>tt<span class="token punctuation">.</span>expected<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span><span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tt<span class="token punctuation">.</span>expected<span class="token punctuation">,</span> leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span>
            require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> leaderboard<span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard_test.go#L154-L387" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Do not forget to also test at the length limit. For instance:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">makeMaxLengthSortedWinningPlayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer <span class="token punctuation">{</span>
    sorted <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        sorted<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
            PlayerAddress<span class="token punctuation">:</span> strconv<span class="token punctuation">.</span><span class="token function">FormatUint</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            WonCount<span class="token punctuation">:</span>      <span class="token number">101</span> <span class="token operator">-</span> i<span class="token punctuation">,</span>
            DateAdded<span class="token punctuation">:</span>     <span class="token string">"2006-01-02 15:05:05.999999999 +0000 UTC"</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sorted
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestUpdatePlayerInfoAtNowTooLongNoAdd</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    beforeWinners <span class="token operator">:=</span> <span class="token function">makeMaxLengthSortedWinningPlayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    now<span class="token punctuation">,</span> err <span class="token operator">:=</span> types<span class="token punctuation">.</span><span class="token function">ParseDateAddedAsTime</span><span class="token punctuation">(</span><span class="token string">"2006-01-02 15:05:05.999999999 +0000 UTC"</span><span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    leaderboard <span class="token operator">:=</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
        Winners<span class="token punctuation">:</span> beforeWinners<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    err <span class="token operator">=</span> leaderboard<span class="token punctuation">.</span><span class="token function">UpdatePlayerInfoAtNow</span><span class="token punctuation">(</span>now<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>    <span class="token string">"100"</span><span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>beforeWinners<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span><span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> beforeWinners<span class="token punctuation">,</span> leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> leaderboard<span class="token punctuation">.</span><span class="token function">Validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> types </span><span class="footer__filename__item" data-v-2c78bfd2> leaderboard_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/types/leaderboard_test.go#L389-L416" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>With the tests at the leaderboard level done, you can move to unit tests at the keeper level. Confirm that there are no changes on <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_create_game_test.go#L500-L553" target="_blank" rel="noopener noreferrer">creating a game<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_reject_game_test.go#L383-L444" target="_blank" rel="noopener noreferrer">rejecting one<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, and on a <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move_test.go#L598-L651" target="_blank" rel="noopener noreferrer">regular move<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Confirm that a new winner is either <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move_winner_test.go#L208-L225" target="_blank" rel="noopener noreferrer">added<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or updated in the leaderboard:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">TestCompleteGameLeaderboardUpdatedWinner</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msgServer<span class="token punctuation">,</span> keeper<span class="token punctuation">,</span> context<span class="token punctuation">,</span> ctrl<span class="token punctuation">,</span> escrow <span class="token operator">:=</span> <span class="token function">setupMsgServerWithOneGameForPlayMove</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>
    ctx <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">UnwrapSDKContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    <span class="token keyword">defer</span> ctrl<span class="token punctuation">.</span><span class="token function">Finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    escrow<span class="token punctuation">.</span><span class="token function">ExpectAny</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    keeper<span class="token punctuation">.</span><span class="token function">SetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
        Index<span class="token punctuation">:</span>    bob<span class="token punctuation">,</span>
        WonCount<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    keeper<span class="token punctuation">.</span><span class="token function">SetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span>Leaderboard<span class="token punctuation">{</span>
        Winners<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
            <span class="token punctuation">{</span>
                PlayerAddress<span class="token punctuation">:</span> bob<span class="token punctuation">,</span>
                WonCount<span class="token punctuation">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
                DateAdded<span class="token punctuation">:</span>     <span class="token string">"2006-01-02 15:05:06.999999999 +0000 UTC"</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">playAllMoves</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> msgServer<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> game1Moves<span class="token punctuation">)</span>

    leaderboard<span class="token punctuation">,</span> found <span class="token operator">:=</span> keeper<span class="token punctuation">.</span><span class="token function">GetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">True</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> found<span class="token punctuation">)</span>
    require<span class="token punctuation">.</span><span class="token function">EqualValues</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayer<span class="token punctuation">{</span>
        <span class="token punctuation">{</span>
            PlayerAddress<span class="token punctuation">:</span> bob<span class="token punctuation">,</span>
            WonCount<span class="token punctuation">:</span>      <span class="token number">3</span><span class="token punctuation">,</span>
            DateAdded<span class="token punctuation">:</span>     types<span class="token punctuation">.</span><span class="token function">FormatDateAdded</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span><span class="token function">GetDateAdded</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> leaderboard<span class="token punctuation">.</span>Winners<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> keeper </span><span class="footer__filename__item" data-v-2c78bfd2> msg_server_play_move_winner_test.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/msg_server_play_move_winner_test.go#L227-L257" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Now do the same on <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/end_block_server_game_test.go#L684-L794" target="_blank" rel="noopener noreferrer">a forfeit<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>This completes your Checkers V2 chain. If you were to start it anew as is, it would work. However, you already have the V1 of Checkers running, so you need to migrate everything.</p> <h2 id="v1-to-v2-player-information-migration-helper"><a href="#v1-to-v2-player-information-migration-helper" class="header-anchor">#</a> v1 to v2 player information migration helper</h2> <p>With your v2 blockchain now fully operational on its own, it is time to work on the issue of stored data migration.</p> <p>First, tackle the creation of player information. You will build the player information by extracting it from all the existing stored games. In the <a href="https://en.wikipedia.org/wiki/MapReduce" target="_blank" rel="noopener noreferrer">map/reduce<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> parlance, you will <em>reduce</em> this information from the stored games.</p> <h3 id="problem-description"><a href="#problem-description" class="header-anchor">#</a> Problem description</h3> <p>If performance was not an issue, an easy way to do it would be the following:</p> <ol><li>Call <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/stored_game.go#L50" target="_blank" rel="noopener noreferrer"><code>keeper.GetAllStoredGame()</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get an array with all the games.</li> <li>Keep only the games that have a winner.</li> <li>Then for each game:
<ol><li>Call <code>keeper.GetPlayerInfo</code> or, if that is not found, create player info, both for the black player and the red player.</li> <li>Do <code>+1</code> on <code>.WonCount</code> or <code>.LostCount</code> according to the <code>game.Winner</code> field.</li> <li>Call <code>keeper.SetPlayerInfo</code> for both black and red players.</li></ol></li></ol> <p>Of course, given inevitable resource limitations, you would run into the following problems:</p> <ol><li>Getting all the games in a single array may not be possible, because your node's RAM may not be able to keep a million of them in memory. Or maybe it fails at 100,000 of them.</li> <li>Calling <code>.GetPlayerInfo</code> and <code>.SetPlayerInfo</code> twice per game just to do <code>+1</code> adds up quickly. Remember that both of these calls are database calls. You could be confronted with a 12-hour job, during which your chain is offline.</li> <li>Doing it all in a sequential manner would take even more time, as each blocking call blocks the whole process.</li></ol> <h3 id="proposed-solution"><a href="#proposed-solution" class="header-anchor">#</a> Proposed solution</h3> <p>Fortunately, there exist ways to mitigate these limitations:</p> <ol><li>You do not need to get all the games at once. The <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/keeper/grpc_query_stored_game.go#L14" target="_blank" rel="noopener noreferrer"><code>keeper.StoredGameAll</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> function offers pagination. With this, you can limit the impact on the RAM requirement, at the expense of multiple queries.</li> <li>Within each subset of games, you can compute in memory the player list and how many wins and losses each player has. With this <em>mapping</em> done, you can add the (in-memory) intermediary <code>WonCount</code> and <code>LostCount</code> sums to each player's stored sums. With this, a <code>+1</code> is potentially replaced by a <code>+k</code>, at once reducing the number of calls to <code>.GetPlayerInfo</code> and <code>.SetPlayerInfo</code>.</li> <li>You can separate the different calls and computations into <a href="https://gobyexample.com/goroutines" target="_blank" rel="noopener noreferrer">Go routines<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> so that a blocking call does not prevent other computations from taking place in the meantime.</li></ol> <p>The routines will use <strong>channels</strong> to communicate between themselves and the main function:</p> <ol><li>A <em>stored-game</em> channel, that will pass along chunks of games in the <code>[]types.StoredGame</code> format.</li> <li>A <em>player-info</em> channel, that will pass along intermediate computations of player information in the simple <code>types.PlayerInfo</code> format.</li> <li>A <em>done</em> channel, whose only purpose is to flag to the main function when all has been processed.</li></ol> <p>The processing <strong>routines</strong> will be divided as per the following:</p> <ol><li><p>The <strong>game processing</strong> routine will:</p> <ul><li>Receive separate arrays of games from the <em>stored-game</em> channel.</li> <li>Compute the aggregate player info records from them. I.e. <strong><em>map</em></strong>.</li> <li>Send the results on the <em>player-info</em> channel.</li></ul> <p>Also, if it detects that no more games are coming, it will close the <em>player-info</em> channel.</p></li> <li><p>The <strong>player info processing</strong> routine will:</p> <ul><li>Receive individual player info records from the <em>player-info</em> channel.</li> <li>Fetch the existing (or not) corresponding player info from the store.</li> <li>Update the won and lost counts, i.e. <strong><em>reduce</em></strong>. Remember, here it is doing <code>+= k</code>, not <code>+= 1</code>.</li> <li>Save it back to the store.</li></ul> <p>Also, if it detects that no more player info records are coming, it will flag it on the <em>done</em> channel.</p></li> <li><p>The <strong>main function</strong> will:</p> <ul><li>Launch the above 2 routines.</li> <li>Fetch all games in paginated arrays.</li> <li>Send the separate arrays on the <em>stored-game</em> channel.</li> <li>Close the <em>stored-game</em> channel after the last array.</li> <li>Wait for the flag on the <em>done</em> channel.</li> <li>Exit.</li></ul></li></ol> <h3 id="implementation"><a href="#implementation" class="header-anchor">#</a> Implementation</h3> <p>The player info processing will handle an in-memory map of player addresses to their information: <code>map[string]*types.PlayerInfo</code>. Create a new file to encapsulate this whole processing. Start by creating a helper that automatically populates it with empty values when information is missing:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">getOrNewPlayerInfoInMap</span><span class="token punctuation">(</span>infoSoFar <span class="token operator">*</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span> playerIndex <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>playerInfo <span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    playerInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> <span class="token punctuation">(</span><span class="token operator">*</span>infoSoFar<span class="token punctuation">)</span><span class="token punctuation">[</span>playerIndex<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>found <span class="token punctuation">{</span>
        playerInfo <span class="token operator">=</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">{</span>
            Index<span class="token punctuation">:</span>          playerIndex<span class="token punctuation">,</span>
            WonCount<span class="token punctuation">:</span>       <span class="token number">0</span><span class="token punctuation">,</span>
            LostCount<span class="token punctuation">:</span>      <span class="token number">0</span><span class="token punctuation">,</span>
            ForfeitedCount<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">(</span><span class="token operator">*</span>infoSoFar<span class="token punctuation">)</span><span class="token punctuation">[</span>playerIndex<span class="token punctuation">]</span> <span class="token operator">=</span> playerInfo
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> playerInfo
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_player_info.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_player_info.go#L11-L23" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Next, create the routine function to process the games:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">handleStoredGameChannel</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span>
    k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span>
    gamesChannel <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>StoredGame<span class="token punctuation">,</span>
    playerInfoChannel <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> games <span class="token operator">:=</span> <span class="token keyword">range</span> gamesChannel <span class="token punctuation">{</span>
        playerInfos <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>games<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> game <span class="token operator">:=</span> <span class="token keyword">range</span> games <span class="token punctuation">{</span>
            <span class="token keyword">var</span> winner <span class="token builtin">string</span>
            <span class="token keyword">var</span> loser <span class="token builtin">string</span>
            <span class="token keyword">if</span> game<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>BLACK_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
                winner <span class="token operator">=</span> game<span class="token punctuation">.</span>Black
                loser <span class="token operator">=</span> game<span class="token punctuation">.</span>Red
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> game<span class="token punctuation">.</span>Winner <span class="token operator">==</span> rules<span class="token punctuation">.</span>PieceStrings<span class="token punctuation">[</span>rules<span class="token punctuation">.</span>RED_PLAYER<span class="token punctuation">]</span> <span class="token punctuation">{</span>
                winner <span class="token operator">=</span> game<span class="token punctuation">.</span>Red
                loser <span class="token operator">=</span> game<span class="token punctuation">.</span>Black
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span>
            <span class="token punctuation">}</span>
            <span class="token function">getOrNewPlayerInfoInMap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>playerInfos<span class="token punctuation">,</span> winner<span class="token punctuation">)</span><span class="token punctuation">.</span>WonCount<span class="token operator">++</span>
            <span class="token function">getOrNewPlayerInfoInMap</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>playerInfos<span class="token punctuation">,</span> loser<span class="token punctuation">)</span><span class="token punctuation">.</span>LostCount<span class="token operator">++</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> playerInfo <span class="token operator">:=</span> <span class="token keyword">range</span> playerInfos <span class="token punctuation">{</span>
            playerInfoChannel <span class="token operator">&lt;-</span> playerInfo
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>playerInfoChannel<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_player_info.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_player_info.go#L25-L51" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>This function can handle the edge case where black and red both refer to the same player.</p></div></div> <p>Create the routine function to process the player info:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">handlePlayerInfoChannel</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span>
    playerInfoChannel <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span>
    done <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> receivedInfo <span class="token operator">:=</span> <span class="token keyword">range</span> playerInfoChannel <span class="token punctuation">{</span>
        <span class="token keyword">if</span> receivedInfo <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            existingInfo<span class="token punctuation">,</span> found <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">GetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> receivedInfo<span class="token punctuation">.</span>Index<span class="token punctuation">)</span>
            <span class="token keyword">if</span> found <span class="token punctuation">{</span>
                existingInfo<span class="token punctuation">.</span>WonCount <span class="token operator">+=</span> receivedInfo<span class="token punctuation">.</span>WonCount
                existingInfo<span class="token punctuation">.</span>LostCount <span class="token operator">+=</span> receivedInfo<span class="token punctuation">.</span>LostCount
                existingInfo<span class="token punctuation">.</span>ForfeitedCount <span class="token operator">+=</span> receivedInfo<span class="token punctuation">.</span>ForfeitedCount
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                existingInfo <span class="token operator">=</span> <span class="token operator">*</span>receivedInfo
            <span class="token punctuation">}</span>
            k<span class="token punctuation">.</span><span class="token function">SetPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> existingInfo<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    done <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_player_info.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_player_info.go#L53-L70" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Now you can create the main function:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">MapStoredGamesReduceToPlayerInfo</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span> chunk <span class="token builtin">uint64</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    context <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">WrapSDKContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    response<span class="token punctuation">,</span> err <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">StoredGameAll</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>QueryAllStoredGameRequest<span class="token punctuation">{</span>
        Pagination<span class="token punctuation">:</span> <span class="token operator">&amp;</span>query<span class="token punctuation">.</span>PageRequest<span class="token punctuation">{</span>
            Limit<span class="token punctuation">:</span> chunk<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
    gamesChannel <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>StoredGame<span class="token punctuation">)</span>
    playerInfoChannel <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token operator">*</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span>
    done <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>

    <span class="token keyword">go</span> <span class="token function">handleStoredGameChannel</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> k<span class="token punctuation">,</span> gamesChannel<span class="token punctuation">,</span> playerInfoChannel<span class="token punctuation">)</span>
    <span class="token keyword">go</span> <span class="token function">handlePlayerInfoChannel</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> k<span class="token punctuation">,</span> playerInfoChannel<span class="token punctuation">,</span> done<span class="token punctuation">)</span>
    gamesChannel <span class="token operator">&lt;-</span> response<span class="token punctuation">.</span>StoredGame

    <span class="token keyword">for</span> response<span class="token punctuation">.</span>Pagination<span class="token punctuation">.</span>NextKey <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">,</span> err <span class="token operator">=</span> k<span class="token punctuation">.</span><span class="token function">StoredGameAll</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>QueryAllStoredGameRequest<span class="token punctuation">{</span>
            Pagination<span class="token punctuation">:</span> <span class="token operator">&amp;</span>query<span class="token punctuation">.</span>PageRequest<span class="token punctuation">{</span>
                Key<span class="token punctuation">:</span>   response<span class="token punctuation">.</span>Pagination<span class="token punctuation">.</span>NextKey<span class="token punctuation">,</span>
                Limit<span class="token punctuation">:</span> chunk<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> err
        <span class="token punctuation">}</span>
        gamesChannel <span class="token operator">&lt;-</span> response<span class="token punctuation">.</span>StoredGame
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>gamesChannel<span class="token punctuation">)</span>

    <span class="token operator">&lt;-</span>done
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_player_info.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_player_info.go#L72-L106" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <h2 id="v1-to-v2-leaderboard-migration-helper"><a href="#v1-to-v2-leaderboard-migration-helper" class="header-anchor">#</a> v1 to v2 leaderboard migration helper</h2> <p>You could decide to build the leaderboard as the player stats list is being built, mimicking the regular operation of your v2 checkers blockchain. Unfortunately, that would entail a lot of array sorting for what are just intermediate player stats. Instead, it is better to build the v2 leaderboard only after all player stats have been gathered.</p> <p>In the process, there are two time-consuming parts:</p> <ol><li>Fetching the stored player info records in a paginated way, consuming mostly database resources.</li> <li>Sorting each intermediate leaderboard, consuming mostly computation resources.</li></ol> <p>It looks beneficial to use a Go routine in this case too, and a <em>player info</em> channel to pass along arrays of player info records.</p> <p>In practice, repeatedly building the intermediate leaderboard means adding <em>k</em> new <code>winningPlayerParsed</code> to the sorted array, sorting it, clipping it to <code>LeaderboardWinnerLength</code>, and repeating. What constitutes a good <em>k</em> value should be dictated by testing and performance measurements. However, you can start with your best guess in a new file created for this purpose:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">const</span> PlayerInfoChunkSize <span class="token operator">=</span> types<span class="token punctuation">.</span>LeaderboardWinnerLength <span class="token operator">*</span> <span class="token number">2</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> constants.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/constants.go#L7" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <h3 id="implementation-2"><a href="#implementation-2" class="header-anchor">#</a> Implementation</h3> <p>Start by adding small helpers into a new file, so that you can easily append and sort player info records:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">addParsedCandidatesAndSort</span><span class="token punctuation">(</span>parsedWinners <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">,</span> candidates <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed <span class="token punctuation">{</span>
    updated <span class="token operator">:=</span> <span class="token function">append</span><span class="token punctuation">(</span>parsedWinners<span class="token punctuation">,</span> candidates<span class="token operator">...</span><span class="token punctuation">)</span>
    types<span class="token punctuation">.</span><span class="token function">SortWinners</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span>
    <span class="token keyword">if</span> types<span class="token punctuation">.</span>LeaderboardWinnerLength <span class="token operator">&lt;</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>updated<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        updated <span class="token operator">=</span> updated<span class="token punctuation">[</span><span class="token punctuation">:</span>types<span class="token punctuation">.</span>LeaderboardWinnerLength<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> updated
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">AddCandidatesAndSortAtNow</span><span class="token punctuation">(</span>parsedWinners <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">,</span> now time<span class="token punctuation">.</span>Time<span class="token punctuation">,</span> playerInfos <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed <span class="token punctuation">{</span>
    parsedPlayers <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>playerInfos<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> playerInfo <span class="token operator">:=</span> <span class="token keyword">range</span> playerInfos <span class="token punctuation">{</span>
        <span class="token keyword">if</span> playerInfo<span class="token punctuation">.</span>WonCount <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">{</span>
            parsedPlayers <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>parsedPlayers<span class="token punctuation">,</span> types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">{</span>
                PlayerAddress<span class="token punctuation">:</span> playerInfo<span class="token punctuation">.</span>Index<span class="token punctuation">,</span>
                WonCount<span class="token punctuation">:</span>      playerInfo<span class="token punctuation">.</span>WonCount<span class="token punctuation">,</span>
                DateAdded<span class="token punctuation">:</span>     now<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">addParsedCandidatesAndSort</span><span class="token punctuation">(</span>parsedWinners<span class="token punctuation">,</span> parsedPlayers<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">AddCandidatesAndSort</span><span class="token punctuation">(</span>parsedWinners <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">,</span> ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> playerInfos <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">AddCandidatesAndSortAtNow</span><span class="token punctuation">(</span>parsedWinners<span class="token punctuation">,</span> types<span class="token punctuation">.</span><span class="token function">GetDateAdded</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">,</span> playerInfos<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_leaderboard.go#L12-L37" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42><code data-v-8a444a42>addParsedCandidatesAndSort</code> is not exported because it already assumes that the <code data-v-8a444a42>candidates</code> do not contain any with <code data-v-8a444a42>WinCount == 0</code>. This is an assumption that is not enforced.</p></div></div> <p>With this, you can create the routine function that builds the leaderboard in memory and saves it to storage once at the end:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">handlePlayerInfosChannel</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span>
    playerInfosChannel <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">,</span>
    done <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">bool</span><span class="token punctuation">,</span>
    chunk <span class="token builtin">uint64</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    winners <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>WinningPlayerParsed<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> types<span class="token punctuation">.</span>LeaderboardWinnerLength<span class="token operator">+</span>chunk<span class="token punctuation">)</span>
    <span class="token keyword">for</span> receivedInfo <span class="token operator">:=</span> <span class="token keyword">range</span> playerInfosChannel <span class="token punctuation">{</span>
        <span class="token keyword">if</span> receivedInfo <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            winners <span class="token operator">=</span> <span class="token function">AddCandidatesAndSort</span><span class="token punctuation">(</span>winners<span class="token punctuation">,</span> ctx<span class="token punctuation">,</span> receivedInfo<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    k<span class="token punctuation">.</span><span class="token function">SetLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> types<span class="token punctuation">.</span><span class="token function">CreateLeaderboardFromParsedWinners</span><span class="token punctuation">(</span>winners<span class="token punctuation">)</span><span class="token punctuation">)</span>
    done <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_leaderboard.go#L39-L51" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>The winners are initialized at a <code data-v-8a444a42>0</code> size but with a capacity of <code data-v-8a444a42>types.LeaderboardWinnerLength+chunk</code>, which is the expected maximum intermediate size it will reach. This initialization should ensure that the slice does not need to have its capacity increased mid-process.</p></div></div> <p>Declare the main function:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">MapPlayerInfosReduceToLeaderboard</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span> chunk <span class="token builtin">uint64</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    context <span class="token operator">:=</span> sdk<span class="token punctuation">.</span><span class="token function">WrapSDKContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    response<span class="token punctuation">,</span> err <span class="token operator">:=</span> k<span class="token punctuation">.</span><span class="token function">PlayerInfoAll</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>QueryAllPlayerInfoRequest<span class="token punctuation">{</span>
        Pagination<span class="token punctuation">:</span> <span class="token operator">&amp;</span>query<span class="token punctuation">.</span>PageRequest<span class="token punctuation">{</span>
            Limit<span class="token punctuation">:</span> PlayerInfoChunkSize<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
    playerInfosChannel <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>types<span class="token punctuation">.</span>PlayerInfo<span class="token punctuation">)</span>
    done <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>

    <span class="token keyword">go</span> <span class="token function">handlePlayerInfosChannel</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> k<span class="token punctuation">,</span> playerInfosChannel<span class="token punctuation">,</span> done<span class="token punctuation">,</span> chunk<span class="token punctuation">)</span>
    playerInfosChannel <span class="token operator">&lt;-</span> response<span class="token punctuation">.</span>PlayerInfo

    <span class="token keyword">for</span> response<span class="token punctuation">.</span>Pagination<span class="token punctuation">.</span>NextKey <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        response<span class="token punctuation">,</span> err <span class="token operator">=</span> k<span class="token punctuation">.</span><span class="token function">PlayerInfoAll</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">&amp;</span>types<span class="token punctuation">.</span>QueryAllPlayerInfoRequest<span class="token punctuation">{</span>
            Pagination<span class="token punctuation">:</span> <span class="token operator">&amp;</span>query<span class="token punctuation">.</span>PageRequest<span class="token punctuation">{</span>
                Key<span class="token punctuation">:</span>   response<span class="token punctuation">.</span>Pagination<span class="token punctuation">.</span>NextKey<span class="token punctuation">,</span>
                Limit<span class="token punctuation">:</span> PlayerInfoChunkSize<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> err
        <span class="token punctuation">}</span>
        playerInfosChannel <span class="token operator">&lt;-</span> response<span class="token punctuation">.</span>PlayerInfo
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>playerInfosChannel<span class="token punctuation">)</span>

    <span class="token operator">&lt;-</span>done
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration_leaderboard.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration_leaderboard.go#L53-L85" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <h2 id="v1-to-v2-migration-proper"><a href="#v1-to-v2-migration-proper" class="header-anchor">#</a> v1 to v2 migration proper</h2> <p>The migration proper needs to execute the previous functions in a specific order. You can encapsulate this knowledge in a function:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token function">PerformMigration</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> k keeper<span class="token punctuation">.</span>Keeper<span class="token punctuation">,</span> storedGameChunk <span class="token builtin">uint64</span><span class="token punctuation">,</span> playerInfoChunk <span class="token builtin">uint64</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Start to compute checkers games to player info calculation..."</span><span class="token punctuation">)</span>
    err <span class="token operator">:=</span> <span class="token function">MapStoredGamesReduceToPlayerInfo</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> k<span class="token punctuation">,</span> storedGameChunk<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
    ctx<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Checkers games to player info computation done"</span><span class="token punctuation">)</span>
    ctx<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Start to compute checkers player info to leaderboard calculation..."</span><span class="token punctuation">)</span>
    err <span class="token operator">=</span> <span class="token function">MapPlayerInfosReduceToLeaderboard</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> k<span class="token punctuation">,</span> playerInfoChunk<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> err
    <span class="token punctuation">}</span>
    ctx<span class="token punctuation">.</span><span class="token function">Logger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">"Checkers player info to leaderboard computation done"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> ... </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> migration.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/migrations/v1tov2/migration.go#L8-L22" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>This does not panic in case of an error. To avoid carrying on a faulty state, the caller of this function will have to handle the panic.</p></div></div> <p>You have in place the functions that will handle the store migration. Now you have to set up the chain of command for these functions to be called by the node at the right point in time.</p> <h3 id="consensus-version-and-name"><a href="#consensus-version-and-name" class="header-anchor">#</a> Consensus version and name</h3> <p>The <code>upgrade</code> module keeps in its store the <a href="https://docs.cosmos.network/master/core/upgrade.html#tracking-module-versions" target="_blank" rel="noopener noreferrer">different module versions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> that are currently running. To signal an upgrade, your module needs to return a different value when queried by the <code>upgrade</code> module. Change it from <code>2</code> to <code>3</code>, or whichever number works for you. First, keep both these values in their respective locations:</p> <!----> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>The consensus version number bears no resemblance to v1 or v2. The consensus version number is for the module, whereas v1 or v2 is for the whole application.</p></div></div> <p>Now that you are in v2, have the module return it when asked:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span> <span class="token function">ConsensusVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">uint64</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> v2<span class="token punctuation">.</span>TargetConsensusVersion <span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> module.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/module.go#L175" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>You also have to pick a name for the upgrade you have prepared. This name will identify your specific upgrade when it is mentioned in a <code>Plan</code>, i.e. an upgrade governance proposal. This is a name relevant at the application level:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">const</span> UpgradeName <span class="token operator">=</span> <span class="token string">"v1tov2"</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> app </span><span class="footer__filename__item" data-v-2c78bfd2> upgrades </span><span class="footer__filename__item" data-v-2c78bfd2> v1tov2 </span><span class="footer__filename__item" data-v-2c78bfd2> constants.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/app/upgrades/v1tov2/constants.go#L4" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>You have to inform your app about:</p> <ol><li>The mapping between the consensus version(s) and the migration process(es).</li> <li>The mapping between this name and the module(s) consensus versions.</li></ol> <p>Prepare these in turn.</p> <h3 id="callback-in-checkers-module"><a href="#callback-in-checkers-module" class="header-anchor">#</a> Callback in checkers module</h3> <p>Indicate that the checkers module needs to perform some upgrade steps when it is coming out of the old consensus version by calling <code>RegisterMigration</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>am AppModule<span class="token punctuation">)</span> <span class="token function">RegisterServices</span><span class="token punctuation">(</span>cfg module<span class="token punctuation">.</span>Configurator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token keyword">if</span> err <span class="token operator">:=</span> cfg<span class="token punctuation">.</span><span class="token function">RegisterMigration</span><span class="token punctuation">(</span>types<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span> v1<span class="token punctuation">.</span>TargetConsensusVersion<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> v1tov2<span class="token punctuation">.</span><span class="token function">PerformMigration</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> am<span class="token punctuation">.</span>keeper<span class="token punctuation">,</span> v1tov2<span class="token punctuation">.</span>StoredGameChunkSize<span class="token punctuation">,</span> v1tov2<span class="token punctuation">.</span>PlayerInfoChunkSize<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"failed to register migration of %s to v2: %w"</span><span class="token punctuation">,</span> types<span class="token punctuation">.</span>ModuleName<span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> x </span><span class="footer__filename__item" data-v-2c78bfd2> checkers </span><span class="footer__filename__item" data-v-2c78bfd2> module.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/x/checkers/module.go#L146-L150" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Note it decides on the chunk sizes to use.</p> <h3 id="callback-in-app"><a href="#callback-in-app" class="header-anchor">#</a> Callback in <code>app</code></h3> <p>The command that you are going to write needs a <code>Configurator</code>. This is already created as part of your <code>app</code> preparation but is not kept. Instead of recreating one, adjust your code to make it easily available. Add this field to your <code>app</code>:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">type</span> App <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    configurator module<span class="token punctuation">.</span>Configurator
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> app </span><span class="footer__filename__item" data-v-2c78bfd2> app.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/app/app.go#L246" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Now adjust the place where the configurator is created:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>app<span class="token punctuation">.</span>configurator <span class="token operator">=</span> module<span class="token punctuation">.</span><span class="token function">NewConfigurator</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>appCodec<span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">MsgServiceRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">GRPCQueryRouter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">RegisterServices</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>configurator<span class="token punctuation">)</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> app </span><span class="footer__filename__item" data-v-2c78bfd2> app.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/app/app.go#L560-L561" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Create a function that encapsulates knowledge about all possible upgrades, although there is a single one here. Since it includes <em>empty code</em> for future use, avoid cluttering the already long <code>NewApp</code> function:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token keyword">func</span> <span class="token punctuation">(</span>app <span class="token operator">*</span>App<span class="token punctuation">)</span> <span class="token function">setupUpgradeHandlers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// v1 to v2 upgrade handler</span>
    app<span class="token punctuation">.</span>UpgradeKeeper<span class="token punctuation">.</span><span class="token function">SetUpgradeHandler</span><span class="token punctuation">(</span>
        v1tov2<span class="token punctuation">.</span>UpgradeName<span class="token punctuation">,</span>
        <span class="token keyword">func</span><span class="token punctuation">(</span>ctx sdk<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> plan upgradetypes<span class="token punctuation">.</span>Plan<span class="token punctuation">,</span> vm module<span class="token punctuation">.</span>VersionMap<span class="token punctuation">)</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>VersionMap<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> app<span class="token punctuation">.</span>mm<span class="token punctuation">.</span><span class="token function">RunMigrations</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> app<span class="token punctuation">.</span>configurator<span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    <span class="token comment">// When a planned update height is reached, the old binary will panic</span>
    <span class="token comment">// writing on disk the height and name of the update that triggered it</span>
    <span class="token comment">// This will read that value, and execute the preparations for the upgrade.</span>
    upgradeInfo<span class="token punctuation">,</span> err <span class="token operator">:=</span> app<span class="token punctuation">.</span>UpgradeKeeper<span class="token punctuation">.</span><span class="token function">ReadUpgradeInfoFromDisk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">"failed to read upgrade info from disk: %w"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> app<span class="token punctuation">.</span>UpgradeKeeper<span class="token punctuation">.</span><span class="token function">IsSkipHeight</span><span class="token punctuation">(</span>upgradeInfo<span class="token punctuation">.</span>Height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> storeUpgrades <span class="token operator">*</span>storetypes<span class="token punctuation">.</span>StoreUpgrades

    <span class="token keyword">switch</span> upgradeInfo<span class="token punctuation">.</span>Name <span class="token punctuation">{</span>
    <span class="token keyword">case</span> v1tov2<span class="token punctuation">.</span>UpgradeName<span class="token punctuation">:</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> storeUpgrades <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// configure store loader that checks if version == upgradeHeight and applies store upgrades</span>
        app<span class="token punctuation">.</span><span class="token function">SetStoreLoader</span><span class="token punctuation">(</span>upgradetypes<span class="token punctuation">.</span><span class="token function">UpgradeStoreLoader</span><span class="token punctuation">(</span>upgradeInfo<span class="token punctuation">.</span>Height<span class="token punctuation">,</span> storeUpgrades<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> app </span><span class="footer__filename__item" data-v-2c78bfd2> app.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/app/app.go#L753-L785" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Now you are ready to inform the app proper. You do this towards the end, after the call to <code>app.SetEndBlocker</code> and before <code>if loadLatest</code>. At the correct location:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__true codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token operator">...</span>
app<span class="token punctuation">.</span><span class="token function">SetEndBlocker</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span>EndBlocker<span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">setupUpgradeHandlers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> loadLatest <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <span class="footer" data-v-2c78bfd2><span class="footer__filename" data-v-2c78bfd2><span class="footer__filename__item" data-v-2c78bfd2> app </span><span class="footer__filename__item" data-v-2c78bfd2> app.go </span></span> <a href="https://github.com/cosmos/b9-checkers-academy-draft/blob/migration/app/app.go#L610" target="_blank" rel="noreferrer noopener" class="footer__source" data-v-2c78bfd2><span class="tm-link tm-link-disclosure" data-v-2c78bfd2>View source</span></a></span></span></span> <p>Be aware that the <code>monitoring</code> module added by Ignite causes difficulty when experimenting below with the CLI. To make it simple, you should remove <a href="https://github.com/cosmos/b9-checkers-academy-draft/compare/leaderboard-handling..migration#diff-0f1d2976054440336a576d47a44a37b80cdf6701dd9113012bce0e3c425819b7L159" target="_blank" rel="noopener noreferrer">all references to <code>monitoring</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from <code>app.go</code>.</p> <p>When done right, adding the callbacks is a short and easy solution.</p> <h2 id="interact-via-the-cli"><a href="#interact-via-the-cli" class="header-anchor">#</a> Interact via the CLI</h2> <p>You can already execute a live upgrade from the command line. The following upgrade process takes inspiration from <a href="https://hub.cosmos.network/main/hub-tutorials/live-upgrade-tutorial.html" target="_blank" rel="noopener noreferrer">this one<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> based on Gaia. You will:</p> <ul><li>Check out the checkers v1 code.</li> <li>Build the v1 checkers executable.</li> <li>Initialize a local blockchain and network.</li> <li>Run v1 checkers.</li> <li>Add one or more incomplete games.</li> <li>Add one or more complete games with the help of a CosmJS integration test.</li> <li>Create a governance proposal to upgrade with the right plan name at an appropriate block height.</li> <li>Make the proposal pass.</li> <li>Wait for v1 checkers to halt on its own at the upgrade height.</li> <li>Check out the checkers v2 code.</li> <li>Build the v2 checkers executable.</li> <li>Run v2 checkers.</li> <li>Confirm that you now have a correct leaderboard.</li></ul> <p>Start your engines.</p> <h3 id="launch-v1"><a href="#launch-v1" class="header-anchor">#</a> Launch v1</h3> <p>In a shell, checkout v1 of checkers with the content of the CosmJS client work:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>$ git checkout cosmjs-elements
$ git submodule update --init
</span></span></span></span> <!----></span> <!----></span></span> <p>Build the v1 executable for your platform:</p> <!----> <p>With the <code>release/v1/checkersd</code> executable ready, you can initialize the network.</p> <div class="wrapper warn" data-v-8a444a42><div class="content warn" data-v-8a444a42><div class="icon warn" data-v-8a444a42><img src="/hi-warn-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>Because this is an exercise, to avoid messing with your keyring you must always specify <code data-v-8a444a42>--keyring-backend test</code>.</p></div></div> <p>Add two players:</p> <!----> <p>Create a new genesis:</p> <!----> <p>Give your players the same token amounts that were added by Ignite, as found in <code>config.yml</code>:</p> <!----> <p>To be able to run a quick test, you need to change the voting period of a proposal. This is found in the genesis:</p> <!----> <p>This returns something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token string">"172800s"</span>
</span></span></span></span> <!----></span> <!----></span></span> <p>That is two days, which is too long to wait for CLI tests. Choose another value, perhaps 10 minutes, i.e. <code>&quot;600s&quot;</code>. Update it in place in the genesis:</p> <!----> <p>You can confirm that the value is in using the earlier command.</p> <p>Make Alice the chain's validator too by creating a genesis transaction modeled on that done by Ignite, as found in <code>config.yml</code>:</p> <!----> <p>Now you can start the chain proper:</p> <!----> <p>From another shell, create a few un-played games with:</p> <!----> <div class="wrapper note" data-v-8a444a42><div class="content note" data-v-8a444a42><div class="icon note" data-v-8a444a42><img src="/hi-note-icon.svg" class="icon-image no-zoom" data-v-8a444a42></div><p data-v-8a444a42>The <code data-v-8a444a42>--broadcast-mode block</code> flag means that you can fire up many such games by just copying the command without facing any sequence errors.</p></div></div> <p>To get a few complete games, you are going to run the <a href="https://github.com/cosmos/academy-checkers-ui/blob/server-indexing/test/integration/stored-game-action.ts" target="_blank" rel="noopener noreferrer">integration tests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> against it. These tests were built to run against a running chain started by Ignite. What is different here is that:</p> <ol><li>Blocks come slower, likely every five seconds instead of every one.</li> <li>There are no longer any faucets.</li></ol> <p>Therefore, to be able to run these tests you need to attend to the above problems, respectively:</p> <ol><li>Adjust the timeout of each <code>before</code> and <code>it</code>. Make it <code>5*(the number of expected blocks + 1)</code>.
For instance, if you send 2 transactions that each go in a block, adjust <a href="https://github.com/cosmos/academy-checkers-ui/blob/server-indexing/test/integration/stored-game-action.ts#L84" target="_blank" rel="noopener noreferrer">the timeout<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to <code>15</code>: <code>this.timeout(15_000)</code>.</li> <li>Adjust the <code>&quot;credit test accounts&quot;</code> <code>before</code>. Just <code>return</code> before the <a href="https://github.com/cosmos/academy-checkers-ui/blob/server-indexing/test/integration/stored-game-action.ts#L65" target="_blank" rel="noopener noreferrer">first <code>await askFaucet</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ol> <p>Now that you cannot call the faucet, you have to credit your test accounts with standard <code>bank send</code> transactions. You can use the same values as found in the <code>before</code>:</p> <!----> <p>With the test accounts sufficiently credited, you can now run the integration tests. Run them three times in a row to create three complete games:</p> <!----> <p>You can confirm that you have a mix of complete and incomplete games:</p> <!----> <p>With enough games in the system, you can move to the software upgrade governance proposal.</p> <h3 id="governance-proposal"><a href="#governance-proposal" class="header-anchor">#</a> Governance proposal</h3> <p>For the software upgrade governance proposal, you want to make sure that it stops the chain not too far in the future but still after the voting period. With a voting period of 10 minutes, take 15 minutes. How many seconds does a block take?</p> <!----> <p>This returns something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>6311520
</span></span></span></span> <!----></span> <!----></span></span> <p>That many <code>blocks_per_year</code> computes down to 5 seconds per block. At this rate, 15 minutes mean 180 blocks.</p> <p>What is the current block height? Check:</p> <!----> <p>This returns something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token number">1000</span>
</span></span></span></span> <!----></span> <!----></span></span> <p>That means you will use:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>--upgrade-height 1180
</span></span></span></span> <!----></span> <!----></span></span> <p>What is the minimum deposit for a proposal? Check:</p> <!----> <p>This returns something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">"denom"</span><span class="token operator">:</span> <span class="token string">"stake"</span><span class="token punctuation">,</span>
        <span class="token property">"amount"</span><span class="token operator">:</span> <span class="token string">"10000000"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</span></span></span></span> <!----></span> <!----></span></span> <p>This is the minimum amount that Alice has to deposit when submitting the proposal. This will do:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>--deposit 10000000stake
</span></span></span></span> <!----></span> <!----></span></span> <p>Submit your governance proposal upgrade:</p> <!----> <p>This returns something with:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>  ...
  type: proposal_deposit
- attributes:
  - key: proposal_id
    value: "1"
  - key: proposal_type
    value: SoftwareUpgrade
  - key: voting_period_start
    value: "1"
  ...
</span></span></span></span> <!----></span> <!----></span></span> <p>Where <code>1</code> is the proposal ID you reuse. Have Alice and Bob vote yes on it:</p> <!----> <p>Confirm that it has collected the votes:</p> <!----> <p>It should print:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>votes:
- option: VOTE_OPTION_YES
  options:
  - option: VOTE_OPTION_YES
    weight: "1.000000000000000000"
  proposal_id: "1"
  voter: cosmos1hzftnstmlzqfaj0rz39hn5pe2vppz0phy4x9ct
- option: VOTE_OPTION_YES
  options:
  - option: VOTE_OPTION_YES
    weight: "1.000000000000000000"
  proposal_id: "1"
  voter: cosmos1hj2x82j49fv90tgtdxrdw5fz3w2vqeqqjhrxle
</span></span></span></span> <!----></span> <!----></span></span> <p>See how long you have to wait for the chain to reach the end of the voting period:</p> <!----> <p>In the end this prints:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>...
status: PROPOSAL_STATUS_VOTING_PERIOD
...
voting_end_time: "2022-08-25T10:38:22.240766103Z"
...
</span></span></span></span> <!----></span> <!----></span></span> <p>Wait for this period. Afterward, with the same command you should see:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>...
status: PROPOSAL_STATUS_PASSED
...
</span></span></span></span> <!----></span> <!----></span></span> <p>Now, wait for the chain to reach the desired block height, which should take five more minutes, as per your parameters. When it has reached that height, the shell with the running <code>checkersd</code> should show something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>...
6:29PM INF finalizing commit of block hash=E6CB6F1E8CF4699543950F756F3E15AE447701ABAC498CDBA86633AC93A73EE7 height=1180 module=consensus num_txs=0 root=21E51E52AA3F06BE59C78CE11D3171E6F7240D297E4BCEAB07FC5A87957B3BE2
6:29PM ERR UPGRADE &quot;v1tov2&quot; NEEDED at height: 1180: 
6:29PM ERR CONSENSUS FAILURE!!! err=&quot;UPGRADE \&quot;v1tov2\&quot; NEEDED at height: 1180: &quot; module=consensus stack=&quot;goroutine 62 [running]:\nruntime/debug.Stack
...
6:29PM INF Stopping baseWAL service impl={&quot;Logger&quot;:{}} module=consensus wal=/root/.checkers/data/cs.wal/wal
6:29PM INF Stopping Group service impl={&quot;Dir&quot;:&quot;/root/.checkers/data/cs.wal&quot;,&quot;Head&quot;:{&quot;ID&quot;:&quot;ZsAlN7DEZAbV:/root/.checkers/data/cs.wal/wal&quot;,&quot;Path&quot;:&quot;/root/.checkers/data/cs.wal/wal&quot;},&quot;ID&quot;:&quot;group:ZsAlN7DEZAbV:/root/.checkers/data/cs.wal/wal&quot;,&quot;Logger&quot;:{}} module=consensus wal=/root/.checkers/data/cs.wal/wal
...
</span></span></span></span> <!----></span> <!----></span></span> <p>At this point, run in another shell:</p> <!----> <p>You should always get the same value, no matter how many times you try. That is because the chain has stopped. For instance:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>1180
</span></span></span></span> <!----></span> <!----></span></span> <p>Stop <code>checkersd</code> with <kbd>CTRL-C</kbd>. It has saved a new file:</p> <!----> <p>This prints:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2><span class="token punctuation">{</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"v1tov2"</span><span class="token punctuation">,</span><span class="token property">"height"</span><span class="token operator">:</span><span class="token number">1180</span><span class="token punctuation">}</span>
</span></span></span></span> <!----></span> <!----></span></span> <p>With your node (and therefore your whole blockchain) down, you are ready to move to v2.</p> <h3 id="launch-v2"><a href="#launch-v2" class="header-anchor">#</a> Launch v2</h3> <p>With v1 stopped and its state saved, it is time to move to v2. Checkout v2 of checkers:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>$ git checkout migration
</span></span></span></span> <!----></span> <!----></span></span> <p>Back in the first shell, build the v2 executable:</p> <!----> <p>Launch it:</p> <!----> <p>It should start and display something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>...
7:06PM INF applying upgrade "v1tov2" at height: 342
7:06PM INF migrating module checkers from version 2 to version 3
7:06PM INF Start to compute checkers games to player info calculation...
7:06PM INF Checkers games to player info computation done
7:06PM INF Start to compute checkers player info to leaderboard calculation...
7:06PM INF Checkers player info to leaderboard computation done
...
</span></span></span></span> <!----></span> <!----></span></span> <p>After it has started, you can confirm in another shell that you have the expected leaderboard with:</p> <!----> <p>This should print something like:</p> <span class="codeblock" data-v-2c78bfd2><span class="container codeblock__hasfooter__false codeblock__is-expandable__false codeblock__expanded__false" data-v-2c78bfd2><span class="body__container" data-v-2c78bfd2><span class="body__block" data-v-2c78bfd2><span class="icons" data-v-2c78bfd2><!----> <span class="icons__item" data-v-2c78bfd2><svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="icons__item__icon" data-v-2c78bfd2><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0.25C10.0335 0.25 9.25 1.0335 9.25 2V4.5H10.75V2C10.75 1.86193 10.8619 1.75 11 1.75H21C21.1381 1.75 21.25 1.86193 21.25 2V16C21.25 16.1381 21.1381 16.25 21 16.25H16.5V17.75H21C21.9665 17.75 22.75 16.9665 22.75 16V2C22.75 1.0335 21.9665 0.25 21 0.25H11ZM3 6.25C2.0335 6.25 1.25 7.0335 1.25 8V22C1.25 22.9665 2.0335 23.75 3 23.75H13C13.9665 23.75 14.75 22.9665 14.75 22V8C14.75 7.0335 13.9665 6.25 13 6.25H3ZM2.75 8C2.75 7.86193 2.86193 7.75 3 7.75H13C13.1381 7.75 13.25 7.86193 13.25 8V22C13.25 22.1381 13.1381 22.25 13 22.25H3C2.86193 22.25 2.75 22.1381 2.75 22V8Z" data-v-2c78bfd2></path></svg> <span class="icons__item__tooltip" data-v-2c78bfd2>
              Copy
            </span></span></span> <span class="body" data-v-2c78bfd2><span class="body__wrapper" data-v-2c78bfd2><span class="body__code" data-v-2c78bfd2>Leaderboard:
  winners:
  - dateAdded: 2022-09-06 18:29:44.020323682 +0000 UTC
    playerAddress: cosmos1fx6qlxwteeqxgxwsw83wkf4s9fcnnwk8z86sql
    wonCount: "3"
</span></span></span></span> <!----></span> <!----></span></span> <p>Note how it took the time of the block when v1 stopped.</p> <p>You can similarly confirm that the player info records are correctly saved. Congratulations, you have upgraded your blockchain almost as if in production.</p> <p>Your checkers blockchain is done! It has a leaderboard, which was introduced later in production thanks to migrations.</p> <p>You no doubt have many ideas about how to improve it. In particular, you could implement the missing <em>draw</em> mechanism, which in effect has to be accepted by both players.</p> <div class="wrapper synopsis" data-v-8a444a42><div class="content synopsis" data-v-8a444a42><div class="label tm-overline tm-rf-1 tm-lh-title tm-medium" data-v-8a444a42>synopsis</div><p data-v-8a444a42>To summarize, this section has explored:</p> <ul data-v-8a444a42><li data-v-8a444a42>How to add a leaderboard to an existing blockchain, and the characteristics that a good leaderboard should boast.</li> <li data-v-8a444a42>How to upgrade a blockchain in production, by migrating from v1 of the blockchain to v2, and the new data structures that will be introduced by the upgrade.</li> <li data-v-8a444a42>How to handle the data migrations and logic upgrades implicit during migration, such as with the use of private helper functions.</li> <li data-v-8a444a42>Worthwhile unit tests with regard to player info and leaderboard handling.</li> <li data-v-8a444a42>A complete procedure for how to conduct the update via the CLI.</li></ul></div></div></div><!----></div></div></div></div></div><div class="layout__main__gutter" data-v-2e1fc9fe><div data-v-2f4befa0 data-v-2e1fc9fe><div class="links" data-v-2f4befa0><div class="links__wrapper links__wrapper__previous" data-v-2f4befa0><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted" data-v-2f4befa0>previous</div><div class="links__content" data-v-2f4befa0><a href="/hands-on-exercise/2-ignite-cli-adv/8-wager-denom.html" class="links__item" data-v-2f4befa0><div class="links__item__icon links__item__icon__previous" data-v-2f4befa0><span class="icon" data-v-7aca3159 data-v-2f4befa0><!----><svg width="100%" height="100%" viewBox="0 0 22 18" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M21.4141 9.00009L12.9999 0.58588L11.5857 2.00009L17.5857 8.00006L0 8.00006L0 10.0001H17.5857L11.5857 16.0001L12.9999 17.4143L21.4141 9.00009Z" fill="var(--color-text)" data-v-7aca3159></path></svg><!----></span></div><h5 data-v-2f4befa0>Play With Cross-Chain Tokens</h5></a></div></div><div class="links__wrapper" data-v-2f4befa0><div class="tm-overline tm-rf-1 tm-lh-title tm-medium tm-muted" data-v-2f4befa0>up next</div><div class="links__content" data-v-2f4befa0><a href="/hands-on-exercise/2-ignite-cli-adv/8-run-prod.html" class="links__item" data-v-2f4befa0><h5 data-v-2f4befa0>Move to Production</h5><div class="links__item__icon" data-v-2f4befa0><span class="icon" data-v-7aca3159 data-v-2f4befa0><!----><svg width="100%" height="100%" viewBox="0 0 22 18" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M21.4141 9.00009L12.9999 0.58588L11.5857 2.00009L17.5857 8.00006L0 8.00006L0 10.0001H17.5857L11.5857 16.0001L12.9999 17.4143L21.4141 9.00009Z" fill="var(--color-text)" data-v-7aca3159></path></svg><!----></span></div></a></div></div></div></div></div><div class="layout__main__feedback" data-v-40232d12 data-v-2e1fc9fe><div class="feedback__wrapper" data-v-40232d12><div class="feedback__title" data-v-40232d12>Rate this Page</div><div class="feedback__container" style="display:;" data-v-40232d12><button class="feedback__rating" data-v-40232d12><div class="feedback__rating__icon__box" data-v-40232d12><img src="/assets/img/feedback-icon-good.288f8b1c.svg" alt="icon smile" class="feedback__rating__icon" data-v-40232d12></div></button><button class="feedback__rating" data-v-40232d12><div class="feedback__rating__icon__box" data-v-40232d12><img src="/assets/img/feedback-icon-medium.30d3e67a.svg" alt="icon meh" class="feedback__rating__icon" data-v-40232d12></div></button><button class="feedback__rating" data-v-40232d12><div class="feedback__rating__icon__box" data-v-40232d12><img src="/assets/img/feedback-icon-bad.2f090da1.svg" alt="icon frown" class="feedback__rating__icon" data-v-40232d12></div></button></div><div id="feedback_form" class="feedback__form" style="display:none;" data-v-40232d12><form id="page_rating_form" method="POST" data-v-40232d12><div class="feedback__form__content" style="display:;" data-v-40232d12><div class="feedback__form__content__control" data-v-40232d12><div data-v-40232d12>Would you like to add a message?</div><textarea name="f_message" class="feedback__form__content__control__textarea" data-v-40232d12></textarea></div><div class="feedback__form__content__control" data-v-40232d12><div class="feedback__form__content__control__submit tm-button mt-4" data-v-40232d12>Submit</div></div><input type="hidden" name="f_page" value="" data-v-40232d12><input type="hidden" name="f_rating" value="" data-v-40232d12></div><div id="g-recaptcha" class="feedback__form__captcha" data-v-40232d12></div></form></div><div class="feedback__success" style="display:none;" data-v-40232d12>Thank you for your Feedback!</div></div><!----></div></div><div class="layout__main__content__aside__container" style="--height-banners:nullpx;" data-v-2e1fc9fe><div class="layout__main__content__aside aside__bottom__false" data-v-2e1fc9fe><!----></div></div></div><div class="sheet__sidebar" data-v-205decaf data-v-2e1fc9fe><!----> <!----></div><div class="sheet__sidebar" data-v-205decaf data-v-2e1fc9fe><!----> <!----></div><div class="sheet__sidebar sheet__sidebar__toc" data-v-205decaf data-v-2e1fc9fe><!----> <!----></div></div></div><div class="global__layout__footer mt-10 content-padding" data-v-3aade422><div data-v-185d3682 data-v-3aade422><div class="wrapper" data-v-185d3682><div class="container" data-v-185d3682><div class="footer__wrapper" data-v-185d3682><div class="wizard" data-v-e0e02ad4 data-v-185d3682><div class="wizard__inner" data-v-e0e02ad4><div class="tm-grid-base" data-v-e0e02ad4 data-v-e0e02ad4><div class="wizard-col" data-v-e0e02ad4><h4 data-v-e0e02ad4><label for="field-email" data-v-e0e02ad4>Get Cosmos updates</label></h4><p class="mt-3 tm-lh-title tm-rf-1 tm-medium tm-muted" data-v-e0e02ad4>Unsubscribe at any time. <a href="https://v1.cosmos.network/privacy" target="_blank" class="tm-link tm-link-external" data-v-e0e02ad4><span data-v-e0e02ad4>Privacy Policy</span></a></p></div><div class="wizard-col" data-v-e0e02ad4><div class="form tm-center" data-v-e0e02ad4><div class="form__input" data-v-e0e02ad4><input id="field-email" name="fields[email]" type="email" placeholder="Enter your email" required="required" class="form__input__input tm-rf0 tm-lh-copy tm-title" data-v-e0e02ad4><button type="submit" disabled="disabled" class="form__input__button" data-v-e0e02ad4><span class="sr-only" data-v-e0e02ad4>Next</span><span class="icon newsletter__input__input__button__icon" data-v-7aca3159 data-v-e0e02ad4><!----><svg width="100%" height="100%" viewBox="0 0 22 18" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M21.4141 9.00009L12.9999 0.58588L11.5857 2.00009L17.5857 8.00006L0 8.00006L0 10.0001H17.5857L11.5857 16.0001L12.9999 17.4143L21.4141 9.00009Z" fill="var(--color-text)" data-v-7aca3159></path></svg><!----></span></button></div></div></div></div></div></div><div class="links__container" data-v-185d3682><div class="links" data-v-185d3682><div class="links__item accordion" data-v-185d3682><div class="links__item__title accordion__title" data-v-185d3682>Documentation<span class="icon accordion__title__icon" data-v-7aca3159 data-v-185d3682><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span></div><div class="links__item__links accordion__content" data-v-185d3682><a href="https://docs.cosmos.network" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Cosmos SDK</a><a href="https://hub.cosmos.network" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Cosmos Hub</a><a href="https://docs.tendermint.com" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Tendermint Core</a><a href="https://ibc.cosmos.network/" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>IBC Protocol</a></div></div><div class="links__item accordion" data-v-185d3682><div class="links__item__title accordion__title" data-v-185d3682>Community<span class="icon accordion__title__icon" data-v-7aca3159 data-v-185d3682><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span></div><div class="links__item__links accordion__content" data-v-185d3682><a href="https://blog.cosmos.network" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Cosmos blog</a><a href="https://forum.cosmos.network" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Forum</a><a href="https://discord.gg/cosmosnetwork" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Discord</a></div></div><div class="links__item accordion" data-v-185d3682><div class="links__item__title accordion__title" data-v-185d3682>Contributing<span class="icon accordion__title__icon" data-v-7aca3159 data-v-185d3682><!----><!----><svg width="100%" height="100%" viewBox="0 0 11 7" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-7aca3159><path d="M5.82395 4.53224L6.56259 3.82102L9.966 0.40625L11.0001 1.42898L5.82395 6.59375L0.65918 1.42898L1.67054 0.40625L5.08532 3.82102L5.82395 4.53224Z" fill="var(--color-text)" data-v-7aca3159></path></svg></span></div><div class="links__item__links accordion__content" data-v-185d3682><a href="https://github.com/cosmos/sdk-tutorials" rel="noreferrer noopener" target="_blank" class="links__item__link" data-v-185d3682>Source code on GitHub</a></div></div></div></div><div class="logo" data-v-185d3682><a href="/" class="logo__container" data-v-185d3682><div class="logo__item__img" data-v-185d3682><svg width="100%" height="100%" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-185d3682><path fill-rule="evenodd" clip-rule="evenodd" d="M100 6.9282L19.3975 53.4641V146.536L100 193.072L180.603 146.536V53.4641L100 6.9282ZM186.603 50L100 0L13.3975 50V150L100 200L186.603 150V50Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M100 86.5949L88.6795 93.1308V106.203L100 112.739L111.321 106.203V93.1308L100 86.5949ZM117.321 89.6667L100 79.6667L82.6795 89.6667V109.667L100 119.667L117.321 109.667V89.6667Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M119.333 120.262L108.013 126.798V139.869L119.333 146.405L130.654 139.869V126.798L119.333 120.262ZM136.654 123.333L119.333 113.333L102.013 123.333V143.333L119.333 153.333L136.654 143.333V123.333Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M138.667 86.5949L127.346 93.1308V106.203L138.667 112.739L149.987 106.203V93.1308L138.667 86.5949ZM155.987 89.6667L138.667 79.6667L121.346 89.6667V109.667L138.667 119.667L155.987 109.667V89.6667Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M61.3333 86.5949L50.0128 93.1308V106.203L61.3333 112.739L72.6538 106.203V93.1308L61.3333 86.5949ZM78.6538 89.6667L61.3333 79.6667L44.0128 89.6667V109.667L61.3333 119.667L78.6538 109.667V89.6667Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M80.6667 120.262L69.3462 126.798V139.869L80.6667 146.405L91.9872 139.869V126.798L80.6667 120.262ZM97.9872 123.333L80.6667 113.333L63.3462 123.333V143.333L80.6667 153.333L97.9872 143.333V123.333Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M119.333 53.595L108.013 60.1308V73.2026L119.333 79.7385L130.654 73.2026V60.1308L119.333 53.595ZM136.654 56.6667L119.333 46.6667L102.013 56.6667V76.6667L119.333 86.6667L136.654 76.6667V56.6667Z" fill="#5064FB"></path> <path fill-rule="evenodd" clip-rule="evenodd" d="M80.6667 53.595L69.3462 60.1308V73.2026L80.6667 79.7385L91.9872 73.2026V60.1308L80.6667 53.595ZM97.9872 56.6667L80.6667 46.6667L63.3462 56.6667V76.6667L80.6667 86.6667L97.9872 76.6667V56.6667Z" fill="#5064FB"></path></svg></div><div class="logo__item__text" data-v-185d3682>Developer Portal</div></a><div class="logo__item logo__link" data-v-185d3682><a href="https://blog.cosmos.network/" target="_blank" title="medium" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M24 24h-24v-24h24v24zm-4.03-5.649v-.269l-1.247-1.224c-.11-.084-.165-.222-.142-.359v-8.998c-.023-.137.032-.275.142-.359l1.277-1.224v-.269h-4.422l-3.152 7.863-3.586-7.863h-4.638v.269l1.494 1.799c.146.133.221.327.201.523v7.072c.044.255-.037.516-.216.702l-1.681 2.038v.269h4.766v-.269l-1.681-2.038c-.181-.186-.266-.445-.232-.702v-6.116l4.183 9.125h.486l3.593-9.125v7.273c0 .194 0 .232-.127.359l-1.292 1.254v.269h6.274z" data-v-185d3682></path></svg></a><a href="https://twitter.com/cosmos" target="_blank" title="twitter" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-v-185d3682></path></svg></a><a href="https://discord.gg/cosmosnetwork" target="_blank" title="discord" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" data-v-185d3682></path></svg></a><a href="https://www.linkedin.com/company/interchain-foundation/about/" target="_blank" title="linkedin" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M0 0v24h24v-24h-24zm8 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.397-2.586 7-2.777 7 2.476v6.759z" data-v-185d3682></path></svg></a><a href="https://reddit.com/r/cosmosnetwork" target="_blank" title="reddit" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M14.238 15.348c.085.084.085.221 0 .306-.465.462-1.194.687-2.231.687l-.008-.002-.008.002c-1.036 0-1.766-.225-2.231-.688-.085-.084-.085-.221 0-.305.084-.084.222-.084.307 0 .379.377 1.008.561 1.924.561l.008.002.008-.002c.915 0 1.544-.184 1.924-.561.085-.084.223-.084.307 0zm-3.44-2.418c0-.507-.414-.919-.922-.919-.509 0-.923.412-.923.919 0 .506.414.918.923.918.508.001.922-.411.922-.918zm13.202-.93c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12zm-5-.129c0-.851-.695-1.543-1.55-1.543-.417 0-.795.167-1.074.435-1.056-.695-2.485-1.137-4.066-1.194l.865-2.724 2.343.549-.003.034c0 .696.569 1.262 1.268 1.262.699 0 1.267-.566 1.267-1.262s-.568-1.262-1.267-1.262c-.537 0-.994.335-1.179.804l-2.525-.592c-.11-.027-.223.037-.257.145l-.965 3.038c-1.656.02-3.155.466-4.258 1.181-.277-.255-.644-.415-1.05-.415-.854.001-1.549.693-1.549 1.544 0 .566.311 1.056.768 1.325-.03.164-.05.331-.05.5 0 2.281 2.805 4.137 6.253 4.137s6.253-1.856 6.253-4.137c0-.16-.017-.317-.044-.472.486-.261.82-.766.82-1.353zm-4.872.141c-.509 0-.922.412-.922.919 0 .506.414.918.922.918s.922-.412.922-.918c0-.507-.413-.919-.922-.919z" data-v-185d3682></path></svg></a><a href="https://t.me/cosmosproject" target="_blank" title="telegram" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M12,0c-6.626,0 -12,5.372 -12,12c0,6.627 5.374,12 12,12c6.627,0 12,-5.373 12,-12c0,-6.628 -5.373,-12 -12,-12Zm3.224,17.871c0.188,0.133 0.43,0.166 0.646,0.085c0.215,-0.082 0.374,-0.267 0.422,-0.491c0.507,-2.382 1.737,-8.412 2.198,-10.578c0.035,-0.164 -0.023,-0.334 -0.151,-0.443c-0.129,-0.109 -0.307,-0.14 -0.465,-0.082c-2.446,0.906 -9.979,3.732 -13.058,4.871c-0.195,0.073 -0.322,0.26 -0.316,0.467c0.007,0.206 0.146,0.385 0.346,0.445c1.381,0.413 3.193,0.988 3.193,0.988c0,0 0.847,2.558 1.288,3.858c0.056,0.164 0.184,0.292 0.352,0.336c0.169,0.044 0.348,-0.002 0.474,-0.121c0.709,-0.669 1.805,-1.704 1.805,-1.704c0,0 2.084,1.527 3.266,2.369Zm-6.423,-5.062l0.98,3.231l0.218,-2.046c0,0 3.783,-3.413 5.941,-5.358c0.063,-0.057 0.071,-0.153 0.019,-0.22c-0.052,-0.067 -0.148,-0.083 -0.219,-0.037c-2.5,1.596 -6.939,4.43 -6.939,4.43Z" data-v-185d3682></path></svg></a><a href="https://www.youtube.com/c/CosmosProject" target="_blank" title="youtube" rel="noreferrer noopener" class="smallprint__item__links__item" data-v-185d3682><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" fill="#aaa" data-v-185d3682><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" data-v-185d3682></path></svg></a></div><div class="logo__item logo__item__switch" data-v-185d3682><div class="switch__wrapper" data-v-909c83ce data-v-185d3682><!----><div class="switch__item switch__item__dark" data-v-909c83ce><div class="switch__item__icon" data-v-909c83ce><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-909c83ce><path d="M18.9999 10.79C18.8426 12.4922 18.2038 14.1144 17.1581 15.4668C16.1125 16.8192 14.7034 17.8458 13.0956 18.4265C11.4878 19.0073 9.74789 19.1181 8.0794 18.7461C6.41092 18.3741 4.8829 17.5345 3.67413 16.3258C2.46536 15.117 1.62584 13.589 1.25381 11.9205C0.881777 10.252 0.992617 8.51208 1.57336 6.9043C2.15411 5.29651 3.18073 3.88737 4.53311 2.84175C5.8855 1.79614 7.5077 1.15731 9.2099 1C8.21331 2.34827 7.73375 4.00945 7.85843 5.68141C7.98312 7.35338 8.70376 8.92506 9.8893 10.1106C11.0748 11.2961 12.6465 12.0168 14.3185 12.1415C15.9905 12.2662 17.6516 11.7866 18.9999 10.79Z" stroke="white" stroke-opacity="0.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-909c83ce></path></svg></div><div class="switch__item__label tm-muted tm-rf-1 tm-medium" data-v-909c83ce>Dark mode</div></div></div></div></div><div class="smallprint" data-v-185d3682><div class="smallprint__item__desc info-label smallprint__item mt-8 tm-title tm-lh-title tm-rf-1 tm-muted" data-v-185d3682><div> This website is maintained by the Interchain Foundation (ICF). The contents and opinions of this website are those of the ICF. The ICF provides links to cryptocurrency exchanges as a service to the public. The ICF does not warrant that the information provided by these websites is correct, complete, and up-to-date. The ICF is not responsible for their content and expressly rejects any liability for damages of any kind resulting from the use, reference to, or reliance on any information contained within these websites.</div></div><div class="smallprint__item__desc info-label smallprint__item mt-8 tm-title tm-lh-title tm-rf-1 tm-muted" data-v-185d3682>Cosmos is a registeredtrademarkof the <a href="https://interchain.io/" target="_blank" class="tm-link" data-v-185d3682>Interchain Foundation.</a><a href="https://v1.cosmos.network/privacy" target="_blank" class="smallprint__item__privacy tm-link" data-v-185d3682>Privacy         </a></div></div></div></div></div></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e7d2f874.js" defer></script><script src="/assets/js/11.39391087.js" defer></script><script src="/assets/js/60.d571514a.js" defer></script><script src="/assets/js/31.7ca06c11.js" defer></script><script src="/assets/js/12.7b770c4a.js" defer></script><script src="/assets/js/51.f36e3bc4.js" defer></script><script src="/assets/js/43.1d7161fa.js" defer></script><script src="/assets/js/29.e215b871.js" defer></script><script src="/assets/js/7.f3d82fac.js" defer></script><script src="/assets/js/14.a9d9e9b7.js" defer></script><script src="/assets/js/28.d92f36b6.js" defer></script><script src="/assets/js/42.502234a2.js" defer></script><script src="/assets/js/128.f972a0c8.js" defer></script><script src="/assets/js/21.9d9ccc09.js" defer></script><script src="/assets/js/5.c35904c3.js" defer></script><script src="/assets/js/17.66ac4eeb.js" defer></script><script src="/assets/js/19.966db46a.js" defer></script><script src="/assets/js/6.40a03b2d.js" defer></script><script src="/assets/js/8.fb2ee7ea.js" defer></script><script src="/assets/js/36.97682ccd.js" defer></script><script src="/assets/js/13.33cabc32.js" defer></script><script src="/assets/js/59.c9a6ce8d.js" defer></script><script src="/assets/js/39.3421a09a.js" defer></script>
  </body>
</html>
