(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{686:function(e,l,c){"use strict";c.r(l);var t=c(0),a=Object(t.a)({},(function(){var e=this,l=e.$createElement,c=e._self._c||l;return c("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[c("h1",{attrs:{id:"create-order-pairs"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#create-order-pairs"}},[e._v("#")]),e._v(" Create Order Pairs")]),e._v(" "),c("p",[e._v("In the last chapter you have created the logic for the order book with buy and sell orders.\nIn this chapter you will build the software to make the order book IBC compatible.\nThis will require you to create the index for an order book, with their according messages on receive and on acknowledgement of the IBC packet.")]),e._v(" "),c("h2",{attrs:{id:"define-the-order-book-indexes"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#define-the-order-book-indexes"}},[e._v("#")]),e._v(" Define the Order Book Indexes")]),e._v(" "),c("p",[e._v("You defined the order books as indexed types in the store but you have to specify how this index is defined with the following code:")]),e._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9pYmNkZXgvdHlwZXMva2V5cy5nbwppbXBvcnQgJnF1b3Q7Zm10JnF1b3Q7CgovLy4uLgoKZnVuYyBPcmRlckJvb2tJbmRleCgKCXBvcnRJRCBzdHJpbmcsCgljaGFubmVsSUQgc3RyaW5nLAoJc291cmNlRGVub20gc3RyaW5nLAoJdGFyZ2V0RGVub20gc3RyaW5nLAopIHN0cmluZyB7CglyZXR1cm4gZm10LlNwcmludGYoJnF1b3Q7JXMtJXMtJXMtJXMmcXVvdDssCgkJcG9ydElELAoJCWNoYW5uZWxJRCwKCQlzb3VyY2VEZW5vbSwKCQl0YXJnZXREZW5vbSwKCSkKfQoK"}}),e._v(" "),c("h2",{attrs:{id:"check-for-existing-pairs"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#check-for-existing-pairs"}},[e._v("#")]),e._v(" Check for Existing Pairs")]),e._v(" "),c("p",[e._v("A pair of token always has one order book that everyone can access in the app.\nWhen an order book pair already exists, it should throw an error.")]),e._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9pYmNkZXgva2VlcGVyL21zZ19zZXJ2ZXJfY3JlYXRlX3BhaXIuZ28KaW1wb3J0ICZxdW90O2Vycm9ycyZxdW90OwoKLy8uLi4KCmZ1bmMgKGsgbXNnU2VydmVyKSBTZW5kQ3JlYXRlUGFpcihnb0N0eCBjb250ZXh0LkNvbnRleHQsIG1zZyAqdHlwZXMuTXNnU2VuZENyZWF0ZVBhaXIpICgqdHlwZXMuTXNnU2VuZENyZWF0ZVBhaXJSZXNwb25zZSwgZXJyb3IpIHsKCWN0eCA6PSBzZGsuVW53cmFwU0RLQ29udGV4dChnb0N0eCkKCgkvLyBDYW5ub3QgY3JlYXRlIHRoZSBwYWlyIGlmIGl0IGFscmVhZHkgZXhpc3RzCglwYWlySW5kZXggOj0gdHlwZXMuT3JkZXJCb29rSW5kZXgobXNnLlBvcnQsIG1zZy5DaGFubmVsSUQsIG1zZy5Tb3VyY2VEZW5vbSwgbXNnLlRhcmdldERlbm9tKQoJXywgZm91bmQgOj0gay5HZXRTZWxsT3JkZXJCb29rKGN0eCwgcGFpckluZGV4KQoJaWYgZm91bmQgewoJCXJldHVybiAmYW1wO3R5cGVzLk1zZ1NlbmRDcmVhdGVQYWlyUmVzcG9uc2V7fSwgZXJyb3JzLk5ldygmcXVvdDt0aGUgcGFpciBhbHJlYWR5IGV4aXN0JnF1b3Q7KQoJfQoKCS8vIC4uLgp9Cg=="}}),e._v(" "),c("h2",{attrs:{id:"create-the-onrecv-function"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#create-the-onrecv-function"}},[e._v("#")]),e._v(" Create the OnRecv Function")]),e._v(" "),c("p",[e._v("When a packet with an order book creation is received, the validity of the transaction should be check with the "),c("code",[e._v("ValidateBasic()")]),e._v(" function.\nIf the pair does not exist, you can add it to the keeper.")]),e._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9pYmNkZXgva2VlcGVyL2NyZWF0ZV9wYWlyLmdvCmZ1bmMgKGsgS2VlcGVyKSBPblJlY3ZDcmVhdGVQYWlyUGFja2V0KGN0eCBzZGsuQ29udGV4dCwgcGFja2V0IGNoYW5uZWx0eXBlcy5QYWNrZXQsIGRhdGEgdHlwZXMuQ3JlYXRlUGFpclBhY2tldERhdGEpIChwYWNrZXRBY2sgdHlwZXMuQ3JlYXRlUGFpclBhY2tldEFjaywgZXJyIGVycm9yKSB7CgkvLyB2YWxpZGF0ZSBwYWNrZXQgZGF0YSB1cG9uIHJlY2VpdmluZwoJaWYgZXJyIDo9IGRhdGEuVmFsaWRhdGVCYXNpYygpOyBlcnIgIT0gbmlsIHsKCQlyZXR1cm4gcGFja2V0QWNrLCBlcnIKCX0KCgkvLyBDaGVjayBpZiB0aGUgYnV5IG9yZGVyIGJvb2sgZXhpc3RzCglwYWlySW5kZXggOj0gdHlwZXMuT3JkZXJCb29rSW5kZXgocGFja2V0LlNvdXJjZVBvcnQsIHBhY2tldC5Tb3VyY2VDaGFubmVsLCBkYXRhLlNvdXJjZURlbm9tLCBkYXRhLlRhcmdldERlbm9tKQoJXywgZm91bmQgOj0gay5HZXRCdXlPcmRlckJvb2soY3R4LCBwYWlySW5kZXgpCglpZiBmb3VuZCB7CgkJcmV0dXJuIHBhY2tldEFjaywgZXJyb3JzLk5ldygmcXVvdDt0aGUgcGFpciBhbHJlYWR5IGV4aXN0JnF1b3Q7KQoJfQoKCS8vIFNldCB0aGUgYnV5IG9yZGVyIGJvb2sKCWJvb2sgOj0gdHlwZXMuTmV3QnV5T3JkZXJCb29rKGRhdGEuU291cmNlRGVub20sIGRhdGEuVGFyZ2V0RGVub20pCglib29rLkluZGV4ID0gcGFpckluZGV4CglrLlNldEJ1eU9yZGVyQm9vayhjdHgsIGJvb2spCgoJcmV0dXJuIHBhY2tldEFjaywgbmlsCn0K"}}),e._v(" "),c("h2",{attrs:{id:"create-the-onacknowledgement-function"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#create-the-onacknowledgement-function"}},[e._v("#")]),e._v(" Create the OnAcknowledgement Function")]),e._v(" "),c("p",[e._v("When a packet sent with IBC is valid and received, it must be acknowledged.\nAfter the acknowledgement is successful, add the sell order book to the database.")]),e._v(" "),c("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8geC9pYmNkZXgva2VlcGVyL2NyZWF0ZV9wYWlyLmdvCmZ1bmMgKGsgS2VlcGVyKSBPbkFja25vd2xlZGdlbWVudENyZWF0ZVBhaXJQYWNrZXQoY3R4IHNkay5Db250ZXh0LCBwYWNrZXQgY2hhbm5lbHR5cGVzLlBhY2tldCwgZGF0YSB0eXBlcy5DcmVhdGVQYWlyUGFja2V0RGF0YSwgYWNrIGNoYW5uZWx0eXBlcy5BY2tub3dsZWRnZW1lbnQpIGVycm9yIHsKCXN3aXRjaCBkaXNwYXRjaGVkQWNrIDo9IGFjay5SZXNwb25zZS4odHlwZSkgewoJY2FzZSAqY2hhbm5lbHR5cGVzLkFja25vd2xlZGdlbWVudF9FcnJvcjoKCQlyZXR1cm4gbmlsCgljYXNlICpjaGFubmVsdHlwZXMuQWNrbm93bGVkZ2VtZW50X1Jlc3VsdDoKCQkvLyBEZWNvZGUgdGhlIHBhY2tldCBhY2tub3dsZWRnbWVudAoJCXZhciBwYWNrZXRBY2sgdHlwZXMuQ3JlYXRlUGFpclBhY2tldEFjawoKCQlpZiBlcnIgOj0gdHlwZXMuTW9kdWxlQ2RjLlVubWFyc2hhbEpTT04oZGlzcGF0Y2hlZEFjay5SZXN1bHQsICZhbXA7cGFja2V0QWNrKTsgZXJyICE9IG5pbCB7CgkJCS8vIFRoZSBjb3VudGVyLXBhcnR5IG1vZHVsZSBkb2Vzbid0IGltcGxlbWVudCB0aGUgY29ycmVjdCBhY2tub3dsZWRnbWVudCBmb3JtYXQKCQkJcmV0dXJuIGVycm9ycy5OZXcoJnF1b3Q7Y2Fubm90IHVubWFyc2hhbCBhY2tub3dsZWRnbWVudCZxdW90OykKCQl9CgoJCS8vIFNldCB0aGUgc2VsbCBvcmRlciBib29rCgkJcGFpckluZGV4IDo9IHR5cGVzLk9yZGVyQm9va0luZGV4KHBhY2tldC5Tb3VyY2VQb3J0LCBwYWNrZXQuU291cmNlQ2hhbm5lbCwgZGF0YS5Tb3VyY2VEZW5vbSwgZGF0YS5UYXJnZXREZW5vbSkKCQlib29rIDo9IHR5cGVzLk5ld1NlbGxPcmRlckJvb2soZGF0YS5Tb3VyY2VEZW5vbSwgZGF0YS5UYXJnZXREZW5vbSkKCQlib29rLkluZGV4ID0gcGFpckluZGV4CgkJay5TZXRTZWxsT3JkZXJCb29rKGN0eCwgYm9vaykKCgkJcmV0dXJuIG5pbAoJZGVmYXVsdDoKCQkvLyBUaGUgY291bnRlci1wYXJ0eSBtb2R1bGUgZG9lc24ndCBpbXBsZW1lbnQgdGhlIGNvcnJlY3QgYWNrbm93bGVkZ21lbnQgZm9ybWF0CgkJcmV0dXJuIGVycm9ycy5OZXcoJnF1b3Q7aW52YWxpZCBhY2tub3dsZWRnbWVudCBmb3JtYXQmcXVvdDspCgl9Cn0K"}}),e._v(" "),c("h2",{attrs:{id:"no-consequences-ontimeout"}},[c("a",{staticClass:"header-anchor",attrs:{href:"#no-consequences-ontimeout"}},[e._v("#")]),e._v(" No Consequences OnTimeout")]),e._v(" "),c("p",[e._v("A timeout will have no consequences in our scenario. The order book will not be acknowledged.")])],1)}),[],!1,null,null,null);l.default=a.exports}}]);