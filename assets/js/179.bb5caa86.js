(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{794:function(e,t,a){"use strict";a.r(t);var o=a(1),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"understand-the-feegrant-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#understand-the-feegrant-module"}},[e._v("#")]),e._v(" Understand the Feegrant Module")]),e._v(" "),a("p",[e._v("The "),a("a",{attrs:{href:"https://docs.cosmos.network/v0.45/modules/feegrant/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("feegrant")]),a("OutboundLink")],1),e._v(" module enables the granter (a user, contract, or module) to pay the fees for someone else (the grantee) when the grantee wants to broadcast a transaction on the blockchain. The granter retains full access to their tokens and is able to revoke the allowance at any time.")]),e._v(" "),a("h2",{attrs:{id:"using-feegrant-to-grant-an-allowance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-feegrant-to-grant-an-allowance"}},[e._v("#")]),e._v(" Using feegrant to grant an allowance")]),e._v(" "),a("p",[e._v("An often-discussed use case for the "),a("code",[e._v("feegrant")]),e._v(" module is "),a("em",[e._v("improved onboarding experience")]),e._v(", because new users do not have to acquire tokens before they can start interacting with the blockchain or smart contract.")]),e._v(" "),a("p",[e._v("Two "),a("a",{attrs:{href:"https://docs.cosmos.network/v0.45/modules/feegrant/01_concepts.html#fee-allowance-types",target:"_blank",rel:"noopener noreferrer"}},[e._v("fee allowance types"),a("OutboundLink")],1),e._v(" are implemented with the "),a("code",[e._v("feegrant")]),e._v(" module:")]),e._v(" "),a("ul",[a("li",[a("p",[a("code",[e._v("BasicAllowance")])]),e._v(" "),a("p",[e._v("Grantee uses fees from a granter's account. The allowance can have a one-time limit, an expiration, or no limit.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("PeriodicAllowance")])]),e._v(" "),a("p",[e._v("Grantee uses fees from a granter's account. The allowance has a limit that is periodically reset.")])])]),e._v(" "),a("p",[e._v("In this tutorial, you will set up two tokens in your blockchain: a default token called "),a("code",[e._v("stake")]),e._v(" to use for fees, and another token called "),a("code",[e._v("kudos")]),e._v(" to send to your friends.")]),e._v(" "),a("ul",[a("li",[e._v("You will learn how to spin up a single-node network using the simulation application in the Cosmos SDK ("),a("code",[e._v("simapp")]),e._v(").")]),e._v(" "),a("li",[e._v("You will set Alice up to be a validator.")]),e._v(" "),a("li",[e._v("Bob will be the grantee, who receives a "),a("code",[e._v("BasicAllowance")]),e._v(" that allows Bob to send "),a("code",[e._v("kudos")]),e._v(" tokens to Alice, even though Bob has zero "),a("code",[e._v("stake")]),e._v(" to pay for fees.")]),e._v(" "),a("li",[e._v("Alice will be the granter, who grants a "),a("code",[e._v("BasicAllowance")]),e._v(" to Bob.")])]),e._v(" "),a("h2",{attrs:{id:"requirements"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),a("p",[e._v("Before you start the tutorial, you need to install the "),a("code",[e._v("simd")]),e._v(" binary.")]),e._v(" "),a("p",[e._v("Clone the "),a("code",[e._v("cosmos-sdk")]),e._v(" repository:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBnaXQgY2xvbmUgaHR0cHM6Ly9naXRodWIuY29tL2Nvc21vcy9jb3Ntb3Mtc2RrCg=="}}),e._v(" "),a("p",[e._v("Change directories and check out "),a("code",[e._v("v0.44.0")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBjZCBjb3Ntb3Mtc2RrICZhbXA7JmFtcDsgZ2l0IGNoZWNrb3V0IHYwLjQ0LjAK"}}),e._v(" "),a("p",[e._v("Install the "),a("code",[e._v("simd")]),e._v(" binary:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBtYWtlIGluc3RhbGwK"}}),e._v(" "),a("p",[e._v("Check to make sure the installation was successful:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHZlcnNpb24K"}}),e._v(" "),a("p",[e._v("The version number "),a("code",[e._v("0.44.0")]),e._v(" is output to the console.")]),e._v(" "),a("h2",{attrs:{id:"configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration"}},[e._v("#")]),e._v(" Configuration")]),e._v(" "),a("HighlightBox",{attrs:{type:"tip"}},[a("p",[e._v("If you have used "),a("code",[e._v("simd")]),e._v(" before, you might already have a "),a("code",[e._v(".simapp")]),e._v(" directory in your home directory. To keep the previous data, either save the directory to another location or use the "),a("code",[e._v("--home")]),e._v(" flag and specify a different directory for each command in the following instructions. If you do not want to keep the previous data, remove the previous directory ("),a("code",[e._v("rm -rf ~/.simapp")]),e._v(").")])]),e._v(" "),a("p",[e._v("Run the following commands to configure the "),a("code",[e._v("simd")]),e._v(" binary.")]),e._v(" "),a("p",[e._v("Set the chain ID:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGNvbmZpZyBjaGFpbi1pZCBkZW1vCg=="}}),e._v(" "),a("p",[e._v("Set the "),a("a",{attrs:{href:"https://docs.cosmos.network/main/run-node/keyring.html#setting-up-the-keyring",target:"_blank",rel:"noopener noreferrer"}},[e._v("keyring backend"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGNvbmZpZyBrZXlyaW5nLWJhY2tlbmQgdGVzdAo="}}),e._v(" "),a("h2",{attrs:{id:"key-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#key-setup"}},[e._v("#")]),e._v(" Key setup")]),e._v(" "),a("p",[e._v("You will have to create a few test keys for your users.")]),e._v(" "),a("p",[e._v("Add a key for Alice, the validator:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGtleXMgYWRkIGFsaWNlCg=="}}),e._v(" "),a("p",[e._v("Add a key for Bob, the grantee:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGtleXMgYWRkIGJvYgo="}}),e._v(" "),a("p",[e._v("If you would like to see an overview of your keys, use:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGtleXMgbGlzdAo="}}),e._v(" "),a("HighlightBox",{attrs:{type:"tip"}},[a("p",[e._v("To avoid having to copy and paste the user addresses, now is a good time to export the user keys to variables that you can access and use for this tutorial.")])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBleHBvcnQgQUxJQ0U9JChzaW1kIGtleXMgc2hvdyBhbGljZSAtLWFkZHJlc3MpCiQgZXhwb3J0IEJPQj0kKHNpbWQga2V5cyBzaG93IGJvYiAtLWFkZHJlc3MpCg=="}}),e._v(" "),a("h2",{attrs:{id:"chain-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#chain-setup"}},[e._v("#")]),e._v(" Chain setup")]),e._v(" "),a("p",[e._v("The following commands set up a chain using the simulation application ("),a("code",[e._v("simapp")]),e._v(").")]),e._v(" "),a("p",[e._v("Initialize the node:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGluaXQgdGVzdCAtLWNoYWluLWlkIGRlbW8K"}}),e._v(" "),a("p",[e._v("Alice is your validator. Add Alice and an initial balance to the genesis file:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGFkZC1nZW5lc2lzLWFjY291bnQgYWxpY2UgNTAwMDAwMDAwMHN0YWtlIC0ta2V5cmluZy1iYWNrZW5kIHRlc3QK"}}),e._v(" "),a("p",[e._v("Add Bob and an initial balance to the genesis file:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGFkZC1nZW5lc2lzLWFjY291bnQgYm9iIDIwMDBrdWRvcyAtLWtleXJpbmctYmFja2VuZCB0ZXN0Cg=="}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Note that Bob has only "),a("code",[e._v("kudos")]),e._v(" tokens and is not able to pay for any fees that might be needed.")])]),e._v(" "),a("p",[e._v("Generate a transaction to add Alice to the initial validator set:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGdlbnR4IGFsaWNlIDEwMDAwMDBzdGFrZSAtLWNoYWluLWlkIGRlbW8K"}}),e._v(" "),a("p",[e._v("Add the validator transaction to the genesis file:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIGNvbGxlY3QtZ2VudHhzCg=="}}),e._v(" "),a("h2",{attrs:{id:"start-chain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#start-chain"}},[e._v("#")]),e._v(" Start chain")]),e._v(" "),a("p",[e._v("You are now ready to start a single node network on your local machine.")]),e._v(" "),a("p",[e._v("Start the chain:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHN0YXJ0Cg=="}}),e._v(" "),a("h2",{attrs:{id:"grant-allowance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#grant-allowance"}},[e._v("#")]),e._v(" Grant allowance")]),e._v(" "),a("p",[e._v("Before Bob can send "),a("code",[e._v("kudos")]),e._v(" to Alice, you must set up an allowance for Bob so that Alice pays for any gas fees the transaction might incur.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("BasicAllowance")]),e._v(" is a permission for a grantee to use up fees until the "),a("code",[e._v("spend_limit")]),e._v(" or "),a("code",[e._v("expiration")]),e._v(" is reached. Open up a new terminal window and create an allowance with a spend limit of "),a("code",[e._v("100000stake")]),e._v(" and no expiration date:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHR4IGZlZWdyYW50IGdyYW50ICRBTElDRSAkQk9CIC0tZnJvbSBhbGljZSAtLXNwZW5kLWxpbWl0IDEwMDAwMHN0YWtlCg=="}}),e._v(" "),a("p",[e._v("View the allowance:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHF1ZXJ5IGZlZWdyYW50IGdyYW50cyAkQk9CCg=="}}),e._v(" "),a("h2",{attrs:{id:"send-tokens"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#send-tokens"}},[e._v("#")]),e._v(" Send tokens")]),e._v(" "),a("p",[e._v("First, check the balances of Alice and Bob. Verifying the initial balance provides a baseline so that you can later confirm if your transaction was successful:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHF1ZXJ5IGJhbmsgYmFsYW5jZXMgJEFMSUNFCiQgc2ltZCBxdWVyeSBiYW5rIGJhbGFuY2VzICRCT0IK"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Note that Alice has "),a("code",[e._v("4999000000stake")]),e._v(" because she bonded "),a("code",[e._v("1000000stake")]),e._v(" to become a validator during the chain setup.")])]),e._v(" "),a("p",[e._v("Any transaction that is sent using the "),a("code",[e._v("tx")]),e._v(" command can use the "),a("code",[e._v("--fee-account")]),e._v(" flag to specify an account as input to pay for the fees.")]),e._v(" "),a("p",[e._v("Send "),a("code",[e._v("kudos")]),e._v(" tokens from Bob to Alice, while Alice pays the fees:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHR4IGJhbmsgc2VuZCAkQk9CICRBTElDRSAxMDBrdWRvcyAtLWZyb20gYm9iIC0tZmVlLWFjY291bnQgJEFMSUNFIC0tZmVlcyA1MDBzdGFrZQo="}}),e._v(" "),a("p",[e._v("Look at the balances again:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHF1ZXJ5IGJhbmsgYmFsYW5jZXMgJEFMSUNFCiQgc2ltZCBxdWVyeSBiYW5rIGJhbGFuY2VzICRCT0IK"}}),e._v(" "),a("p",[e._v("Notice how Alice has "),a("code",[e._v("500stake")]),e._v(" less than before. The "),a("code",[e._v("500stake")]),e._v(" was added to the transaction that Bob signed.")]),e._v(" "),a("p",[e._v("View the allowance again:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHF1ZXJ5IGZlZWdyYW50IGdyYW50cyAkQk9CCg=="}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Note how "),a("code",[e._v("spend_limit")]),e._v(" has been reduced and Bob now has "),a("code",[e._v("99500stake")]),e._v(" left to spend on fees.")])]),e._v(" "),a("h2",{attrs:{id:"revoke-allowance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#revoke-allowance"}},[e._v("#")]),e._v(" Revoke allowance")]),e._v(" "),a("p",[e._v("The granter can revoke the allowance from the grantee using the "),a("code",[e._v("revoke")]),e._v(" command.")]),e._v(" "),a("p",[e._v("Revoke allowance:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHR4IGZlZWdyYW50IHJldm9rZSAkQUxJQ0UgJEJPQiAtLWZyb20gYWxpY2UK"}}),e._v(" "),a("p",[e._v("View the allowance:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzaW1kIHF1ZXJ5IGZlZWdyYW50IGdyYW50cyAkQk9CCg=="}}),e._v(" "),a("h2",{attrs:{id:"🎉-congratulations-🎉"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#🎉-congratulations-🎉"}},[e._v("#")]),e._v(" 🎉 Congratulations 🎉")]),e._v(" "),a("p",[e._v("By completing this tutorial, you have learned how to use the "),a("code",[e._v("feegrant")]),e._v(" module!")]),e._v(" "),a("HighlightBox",{attrs:{type:"info"}},[a("p",[e._v("Want a demonstration of x/feegrant and x/authz? In the following video Amaury Martiny, Core Developer at Parity Technologies, and Likhita Polavarapu, Software Developer at Vitwit, present a workshop on the significant UX benefits of both modules and how to integrate them into blockchain applications.")]),e._v(" "),a("YoutubePlayer",{attrs:{videoId:"g6t5ZJSQDus"}})],1),e._v(" "),a("HighlightBox",{attrs:{type:"synopsis"}},[a("p",[e._v("To summarize, this section has explored:")]),e._v(" "),a("ul",[a("li",[e._v("How to configure and use the simulation application (simapp).")]),e._v(" "),a("li",[e._v("How to create an allowance.")]),e._v(" "),a("li",[e._v("How to make a transaction with fees paid by a granter.")]),e._v(" "),a("li",[e._v("How to revoke an allowance.")])])]),e._v(" "),a("p",[e._v("There is a lot more that you can do with the "),a("code",[e._v("feegrant")]),e._v(" module. You can add a list of allowed messages, set an expiration date, and set a time duration after which the spend limit is refilled. To learn more about the "),a("code",[e._v("feegrant")]),e._v(" module and different types of allowances, check out the Cosmos SDK "),a("a",{attrs:{href:"https://docs.cosmos.network/v0.45/modules/feegrant/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Feegrant Module"),a("OutboundLink")],1),e._v(" documentation.")])],1)}),[],!1,null,null,null);t.default=s.exports}}]);