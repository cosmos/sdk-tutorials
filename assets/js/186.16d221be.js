(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{803:function(e,t,o){"use strict";o.r(t);var a=o(1),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"prepare-where-the-node-starts"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#prepare-where-the-node-starts"}},[e._v("#")]),e._v(" Prepare Where the Node Starts")]),e._v(" "),o("p",[e._v("When you run your chain with "),o("code",[e._v("myprojectd start")]),e._v(", the software will build from a "),o("strong",[e._v("genesis")]),e._v(". This genesis needs to contain:")]),e._v(" "),o("ol",[o("li",[e._v("The original validators and their stakes.")]),e._v(" "),o("li",[e._v("The original state values as you see fit. For instance, this can be the original parameters of your world if you are building a metaverse, or the original USD price of your token if you are building a stablecoin.")])]),e._v(" "),o("h2",{attrs:{id:"generate"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#generate"}},[e._v("#")]),e._v(" Generate")]),e._v(" "),o("p",[e._v("You are going to build this genesis file progressively. The genesis contains a lot of information, such as "),o("a",{attrs:{href:"https://hub.cosmos.network/main/resources/genesis.html#mint",target:"_blank",rel:"noopener noreferrer"}},[e._v("minting"),o("OutboundLink")],1),e._v(", "),o("a",{attrs:{href:"https://hub.cosmos.network/main/resources/genesis.html#staking",target:"_blank",rel:"noopener noreferrer"}},[e._v("staking"),o("OutboundLink")],1),e._v(", or "),o("a",{attrs:{href:"https://hub.cosmos.network/main/resources/genesis.html#slashing",target:"_blank",rel:"noopener noreferrer"}},[e._v("slashing"),o("OutboundLink")],1),e._v(" parameters. You can adjust "),o("a",{attrs:{href:"https://hub.cosmos.network/main/resources/genesis.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("these parameters"),o("OutboundLink")],1),e._v(" if you know what you are doing.")]),e._v(" "),o("p",[e._v("The genesis only needs to be generated once, then it is distributed and copied onto all the network's machines.")]),e._v(" "),o("h3",{attrs:{id:"token-name-s"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#token-name-s"}},[e._v("#")]),e._v(" Token name(s)")]),e._v(" "),o("p",[e._v("One of the simpler parameters that you can decide on is the name of the staking token. The name you choose is for the indivisible denomination. For the Cosmos Hub that is "),o("code",[e._v("uatom")]),e._v(", which is understood as a millionth of an ATOM.")]),e._v(" "),o("p",[e._v("For instance, if you decide that your token is the STONE and that each STONE contains a billion indivisible units, by convention you would name the unit "),o("code",[e._v("nstone")]),e._v(", as in a "),o("em",[e._v("nano STONE")]),e._v(". The chain only cares about this "),o("code",[e._v("nstone")]),e._v(" unit. The "),o("code",[e._v("STONE")]),e._v(" will be an artifact reserved for human interaction.")]),e._v(" "),o("p",[e._v("Be sure to have enough decimals as there is a hard-coded 10,000,000 number, which is the minimum stake required where creating a validator.")]),e._v(" "),o("p",[e._v("Keeping on-brand, your new chain is named "),o("em",[e._v("stone-age")]),e._v(".")]),e._v(" "),o("HighlightBox",{attrs:{type:"best-practice"}},[o("p",[e._v("It is customary to append a number to your chain name. Whenever a hard fork happens, you can increment this number for easier identification.")])]),e._v(" "),o("p",[e._v("To create a brand new genesis file for your chain, run:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgaW5pdCBzdG9uZS1hZ2UtMQo="}}),e._v(" "),o("p",[e._v("This creates a large genesis file with the default values of the Cosmos SDK. You can start replacing all occurrences of "),o("code",[e._v("stake")]),e._v(" (the default token name) with "),o("code",[e._v("nstone")]),e._v(" in the genesis file.")]),e._v(" "),o("HighlightBox",{attrs:{type:"remember"}},[o("p",[e._v("Correctly identify where this genesis file is located. Most likely it is in "),o("code",[e._v("~/.myprojectd/config/genesis.json")]),e._v(". If this is not where you want to prepare your genesis file, you can add "),o("code",[e._v("--home another/folder")]),e._v(" to all your commands.")])]),e._v(" "),o("p",[e._v("If you are planning on having more denominations than your staking token, this is defined in the next step.")]),e._v(" "),o("h3",{attrs:{id:"genesis-accounts"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#genesis-accounts"}},[e._v("#")]),e._v(" Genesis accounts")]),e._v(" "),o("p",[e._v("Genesis accounts are accounts that exist in the genesis. They can be there because of a pre-sale of tokens, or of simple allotments, or for any other reason.")]),e._v(" "),o("p",[e._v("Genesis accounts need to be included in the genesis using the command "),o("code",[e._v("add-genesis-account")]),e._v(". Like any account, genesis accounts have addresses that must be collected.")]),e._v(" "),o("HighlightBox",{attrs:{type:"note"}},[o("p",[e._v("If these genesis accounts are third parties, make sure in more ways than one that you get the right values, whether by email or other means.")])]),e._v(" "),o("p",[e._v("Your addresses have a prefix, which you can define instead of the Cosmos Hub default of "),o("code",[e._v("cosmos")]),e._v(". Your blockchain may use the prefix "),o("code",[e._v("cavedweller")]),e._v(" for example. This is typically defined in "),o("code",[e._v("app/app.go")]),e._v(".")]),e._v(" "),o("p",[e._v("You can also decide to allocate new tokens to your genesis accounts. There is no limit to the number of genesis accounts or the number of extra tokens in the genesis.")]),e._v(" "),o("p",[e._v("If you introduce another token named "),o("code",[e._v("nflint")]),e._v(", and Alice has the address "),o("code",[e._v("cavedweller1nw793j9xvdzl2uc9ly8fas5tcfwfetercpdfqq")]),e._v(", you could make her a genesis account with:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgYWRkLWdlbmVzaXMtYWNjb3VudCBcCiAgY2F2ZWR3ZWxsZXIxbnc3OTNqOXh2ZHpsMnVjOWx5OGZhczV0Y2Z3ZmV0ZXJjcGRmcXEgXAogIDUwMDAwMDAwMDBuc3RvbmUsMjAwMDAwMDAwMG5mbGludAo="}}),e._v(" "),o("p",[e._v("This credits her with 5 STONE and 2 FLINT. It has also given her an "),o("code",[e._v("account_number")]),e._v(" in the genesis.")]),e._v(" "),o("p",[e._v("You can do the same for all your genesis accounts, which includes your validators.")]),e._v(" "),o("p",[e._v("Advanced topics include "),o("a",{attrs:{href:"https://docs.cosmos.network/v0.46/modules/auth/05_vesting.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("vesting"),o("OutboundLink")],1),e._v(" on these genesis accounts. For information on how to configure them, do:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgYWRkLWdlbmVzaXMtYWNjb3VudCAtLWhlbHAK"}}),e._v(" "),o("p",[e._v("When you have defined the genesis accounts, it is time to define the genesis validators.")]),e._v(" "),o("h3",{attrs:{id:"validator-stakes"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#validator-stakes"}},[e._v("#")]),e._v(" Validator stakes")]),e._v(" "),o("p",[e._v("The genesis needs to define the starting validators because, at least, a validator needs to propose the first block that comes after the genesis. However, if no validators have been agreed on by consensus, then the first block cannot be produced.")]),e._v(" "),o("p",[e._v("Assume that you have a team of validators that are your starting validators. They are also genesis accounts that you defined previously, so they "),o("em",[e._v("have")]),e._v(" tokens. Now you need to:")]),e._v(" "),o("ol",[o("li",[e._v("Credit each genesis validator the agreed staked token amounts.")]),e._v(" "),o("li",[e._v("Collect signed transactions from them that identify them as validators.")])]),e._v(" "),o("p",[e._v("Each validator needs to generate a transaction locally and send it to you, the party that collects them into the genesis.")]),e._v(" "),o("p",[e._v("To each validator you send:")]),e._v(" "),o("ul",[o("li",[e._v("The "),o("code",[e._v("account_number")]),e._v(" that was given to them when calling "),o("code",[e._v("add-genesis-account")]),e._v(".")]),e._v(" "),o("li",[e._v("A confirmation of the number of tokens that you have credited them.")])]),e._v(" "),o("p",[e._v("Each validator operator then has to run a "),o("code",[e._v("gentx")]),e._v(" command. "),o("strong",[e._v("This command is not to be run on the server")]),e._v(". Instead, it is run on the computer that hosts the "),o("em",[e._v("cold")]),e._v(" validator operator app key, using the keyring of your choice. Collect the consensus public key from CometBFT KMS, for instance "),o("code",[e._v('{"@type":"/cosmos.crypto.ed25519.PubKey","key":"byefX/uKpgTsyrcAZKrmYYoFiXG0tmTOOaJFziO3D+E="}')]),e._v(".")]),e._v(" "),o("p",[e._v("If this is Alice, she may run:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgZ2VudHggY2F2ZWR3ZWxsZXIxbnc3OTNqOXh2ZHpsMnVjOWx5OGZhczV0Y2Z3ZmV0ZXJjcGRmcXEgXAogICAgMzAwMDAwMDAwMHN0b25lIFwKICAgIC0tYWNjb3VudC1udW1iZXIgMCAtLXNlcXVlbmNlIDAgXAogICAgLS1jaGFpbi1pZCBzdG9uZS1hZ2UgXAogICAgLS1wdWJrZXkgJ3smcXVvdDtAdHlwZSZxdW90OzomcXVvdDsvY29zbW9zLmNyeXB0by5lZDI1NTE5LlB1YktleSZxdW90OywmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7YnllZlgvdUtwZ1RzeXJjQVpLcm1ZWW9GaVhHMHRtVE9PYUpGemlPM0QrRT0mcXVvdDt9JyBcCiAgICAtLWdhcyAxMDAwMDAwIFwKICAgIC0tZ2FzLXByaWNlcyAwLjFuc3RvbmUgXAogICAgLS1rZXlyaW5nLWJhY2tlbmQgb3MK"}}),e._v(" "),o("p",[e._v("This creates a JSON file on the validator's computer, typically in "),o("code",[e._v("~/.myprojectd/config/gentx/")]),e._v(" with the following form:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICZxdW90O2JvZHkmcXVvdDs6IHsKICAgICZxdW90O21lc3NhZ2VzJnF1b3Q7OiBbCiAgICAgIHsKICAgICAgICAmcXVvdDtAdHlwZSZxdW90OzogJnF1b3Q7L2Nvc21vcy5zdGFraW5nLnYxYmV0YTEuTXNnQ3JlYXRlVmFsaWRhdG9yJnF1b3Q7LAogICAgICAgICZxdW90O2Rlc2NyaXB0aW9uJnF1b3Q7OiB7CiAgICAgICAgICAmcXVvdDttb25pa2VyJnF1b3Q7OiAmcXVvdDt0ZXN0JnF1b3Q7LAogICAgICAgICAgJnF1b3Q7aWRlbnRpdHkmcXVvdDs6ICZxdW90OyZxdW90OywKICAgICAgICAgICZxdW90O3dlYnNpdGUmcXVvdDs6ICZxdW90OyZxdW90OywKICAgICAgICAgICZxdW90O3NlY3VyaXR5X2NvbnRhY3QmcXVvdDs6ICZxdW90OyZxdW90OywKICAgICAgICAgICZxdW90O2RldGFpbHMmcXVvdDs6ICZxdW90OyZxdW90OwogICAgICAgIH0sCiAgICAgICAgJnF1b3Q7Y29tbWlzc2lvbiZxdW90OzogewogICAgICAgICAgJnF1b3Q7cmF0ZSZxdW90OzogJnF1b3Q7MC4xMDAwMDAwMDAwMDAwMDAwMDAmcXVvdDssCiAgICAgICAgICAmcXVvdDttYXhfcmF0ZSZxdW90OzogJnF1b3Q7MC4yMDAwMDAwMDAwMDAwMDAwMDAmcXVvdDssCiAgICAgICAgICAmcXVvdDttYXhfY2hhbmdlX3JhdGUmcXVvdDs6ICZxdW90OzAuMDEwMDAwMDAwMDAwMDAwMDAwJnF1b3Q7CiAgICAgICAgfSwKICAgICAgICAmcXVvdDttaW5fc2VsZl9kZWxlZ2F0aW9uJnF1b3Q7OiAmcXVvdDsxJnF1b3Q7LAogICAgICAgICZxdW90O2RlbGVnYXRvcl9hZGRyZXNzJnF1b3Q7OiAmcXVvdDtjYXZlZHdlbGxlcjE1ZnNkYzk0ZHlrcnp0ZzNyYzcwenU1M2Vjc3RhMjNtMG4waGhtciZxdW90OywKICAgICAgICAmcXVvdDt2YWxpZGF0b3JfYWRkcmVzcyZxdW90OzogJnF1b3Q7Y2F2ZWR3ZWxsZXJ2YWxvcGVyMTVmc2RjOTRkeWtyenRnM3JjNzB6dTUzZWNzdGEyM20wa21yemhzJnF1b3Q7LAogICAgICAgICZxdW90O3B1YmtleSZxdW90OzogewogICAgICAgICAgJnF1b3Q7QHR5cGUmcXVvdDs6ICZxdW90Oy9jb3Ntb3MuY3J5cHRvLmVkMjU1MTkuUHViS2V5JnF1b3Q7LAogICAgICAgICAgJnF1b3Q7a2V5JnF1b3Q7OiAmcXVvdDtieWVmWC91S3BnVHN5cmNBWktybVlZb0ZpWEcwdG1UT09hSkZ6aU8zRCtFPSZxdW90OwogICAgICAgIH0sCiAgICAgICAgJnF1b3Q7dmFsdWUmcXVvdDs6IHsKICAgICAgICAgICZxdW90O2Rlbm9tJnF1b3Q7OiAmcXVvdDtzdGFrZSZxdW90OywKICAgICAgICAgICZxdW90O2Ftb3VudCZxdW90OzogJnF1b3Q7MTAwMDAwMCZxdW90OwogICAgICAgIH0KICAgICAgfQogICAgXSwKICAgICZxdW90O21lbW8mcXVvdDs6ICZxdW90O2NlMWM1NGVhN2EyYzUwYjRiOWYyZjg2OWZhZjhmYTRkMWExY2Y0M2FAMTkyLjE2OC4xMDAuNToyNjY1NiZxdW90OywKICAgICZxdW90O3RpbWVvdXRfaGVpZ2h0JnF1b3Q7OiAmcXVvdDswJnF1b3Q7LAogICAgJnF1b3Q7ZXh0ZW5zaW9uX29wdGlvbnMmcXVvdDs6IFtdLAogICAgJnF1b3Q7bm9uX2NyaXRpY2FsX2V4dGVuc2lvbl9vcHRpb25zJnF1b3Q7OiBbXQogIH0sCiAgJnF1b3Q7YXV0aF9pbmZvJnF1b3Q7OiB7CiAgICAmcXVvdDtzaWduZXJfaW5mb3MmcXVvdDs6IFsKICAgICAgewogICAgICAgICZxdW90O3B1YmxpY19rZXkmcXVvdDs6IHsKICAgICAgICAgICZxdW90O0B0eXBlJnF1b3Q7OiAmcXVvdDsvY29zbW9zLmNyeXB0by5zZWNwMjU2azEuUHViS2V5JnF1b3Q7LAogICAgICAgICAgJnF1b3Q7a2V5JnF1b3Q7OiAmcXVvdDtBbFFidzNZT3FkS0hRL2J1ZCsyN3FpOGRWT0dWb1Q5WEZVekZHc1R6LzBxbiZxdW90OwogICAgICAgIH0sCiAgICAgICAgJnF1b3Q7bW9kZV9pbmZvJnF1b3Q7OiB7CiAgICAgICAgICAmcXVvdDtzaW5nbGUmcXVvdDs6IHsKICAgICAgICAgICAgJnF1b3Q7bW9kZSZxdW90OzogJnF1b3Q7U0lHTl9NT0RFX0RJUkVDVCZxdW90OwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgJnF1b3Q7c2VxdWVuY2UmcXVvdDs6ICZxdW90OzAmcXVvdDsKICAgICAgfQogICAgXSwKICAgICZxdW90O2ZlZSZxdW90OzogewogICAgICAmcXVvdDthbW91bnQmcXVvdDs6IFtdLAogICAgICAmcXVvdDtnYXNfbGltaXQmcXVvdDs6ICZxdW90OzIwMDAwMCZxdW90OywKICAgICAgJnF1b3Q7cGF5ZXImcXVvdDs6ICZxdW90OyZxdW90OywKICAgICAgJnF1b3Q7Z3JhbnRlciZxdW90OzogJnF1b3Q7JnF1b3Q7CiAgICB9LAogICAgJnF1b3Q7dGlwJnF1b3Q7OiBudWxsCiAgfSwKICAmcXVvdDtzaWduYXR1cmVzJnF1b3Q7OiBbCiAgICAmcXVvdDtNS3JQei81ZUJvdUQxMTZ2ajIweXZkYUZyUkpDNzRkM3BEb2ZBZVBZU05GYnZZUFo1YlFJTy9RYXRxVVF2YlNGSXVvZWo2YWhlUGJ5MVlvYjdBaVZ5Zz09JnF1b3Q7CiAgXQp9Cg=="}}),e._v(" "),o("p",[e._v("Because a validator can be configured with multiple flags, look at:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgZ2VudHggLS1oZWxwCg=="}}),e._v(" "),o("p",[e._v("Each validator then returns to you their transaction file(s).")]),e._v(" "),o("h3",{attrs:{id:"validators-aggregation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#validators-aggregation"}},[e._v("#")]),e._v(" Validators aggregation")]),e._v(" "),o("p",[e._v("When a validator returns a signed transaction to you, make sure that it is the one you expect and add the JSON file in the "),o("code",[e._v("~/.myprojectd/config/gentx")]),e._v(" folder along with all the others in your server.")]),e._v(" "),o("p",[e._v("When you have all of the validator responses, you add them all in the genesis like so:")]),e._v(" "),o("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL215cHJvamVjdGQgY29sbGVjdC1nZW50eHMK"}}),e._v(" "),o("p",[e._v("If some validators are not cooperating fast enough, you can do the operation when you have received a reply from enough of them to start a valid network. Late potential validators can always send transactions to the live network to become validators at a later date.")]),e._v(" "),o("p",[e._v("This completes your creation of the genesis. What do you do with it?")]),e._v(" "),o("h2",{attrs:{id:"publish"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#publish"}},[e._v("#")]),e._v(" Publish")]),e._v(" "),o("p",[e._v("All your genesis validators and all other potential node operators need access to this genesis file for them to be technically able to start the network. So put it on a public server. Picking a dedicated GitHub repository for all things "),o("em",[e._v("production")]),e._v(" is a good example.")]),e._v(" "),o("p",[e._v("The relevant parties should also come to a consensus that this genesis represents the agreed initial state. Indeed:")]),e._v(" "),o("ul",[o("li",[e._v("Parties are being granted genesis tokens and one may not accept being omitted.")]),e._v(" "),o("li",[e._v("Parties are enroling to be validators, so there needs to be agreement on this file.")])]),e._v(" "),o("p",[e._v("This is the only "),o("em",[e._v("block")]),e._v(" that needs a social consensus on its content. All other blocks will be agreed on technically by the PoS consensus.")]),e._v(" "),o("h2",{attrs:{id:"import"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#import"}},[e._v("#")]),e._v(" Import")]),e._v(" "),o("p",[e._v("In turn, each validator and node operator copies this file on their own machine, in the designated folder, typically "),o("code",[e._v("~/.myprojectd/config/genesis.json")]),e._v(".")]),e._v(" "),o("HighlightBox",{attrs:{type:"tip"}},[o("p",[e._v("If you would like to see how to apply what you've learned, you can go straight to the exercise in "),o("RouterLink",{attrs:{to:"/hands-on-exercise/4-run-in-prod/1-run-prod-docker.html"}},[e._v("Simulate production in Docker")]),e._v(" to start from scratch.")],1),e._v(" "),o("p",[e._v("More specifically, you can jump to:")]),e._v(" "),o("ul",[o("li",[o("RouterLink",{attrs:{to:"/hands-on-exercise/4-run-in-prod/1-run-prod-docker.html#blockchain-elements"}},[e._v("Blockchain elements")]),e._v(", to see how to prepare early blockchain elements like the consensus denom.")],1),e._v(" "),o("li",[o("RouterLink",{attrs:{to:"/hands-on-exercise/4-run-in-prod/1-run-prod-docker.html#genesis"}},[e._v("Genesis")]),e._v(", to see how to prepare the blockchain's genesis, including the genesis validator transactions.")],1)])]),e._v(" "),o("HighlightBox",{attrs:{type:"synopsis"}},[o("p",[e._v("To summarize, this section has explored:")]),e._v(" "),o("ul",[o("li",[e._v("The contents of the blockchain genesis: the original validators and their stakes, and the original state values defined, such as the minting, staking, and slashing parameters.")]),e._v(" "),o("li",[e._v("How to name and create a new genesis file.")]),e._v(" "),o("li",[e._v("The nature and purpose of genesis accounts, and how to add them to the genesis file.")]),e._v(" "),o("li",[e._v("How to name, define, and allocate tokens to your genesis accounts.")]),e._v(" "),o("li",[e._v("How to define the genesis validators, credit them with the agreed staked tokens, collect their first signed transactions, and aggregate them.")]),e._v(" "),o("li",[e._v("How to publish the genesis file so that it can be accessed by all those needing their own copy to be able to start the network.")])])])],1)}),[],!1,null,null,null);t.default=s.exports}}]);