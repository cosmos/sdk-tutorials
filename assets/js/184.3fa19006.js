(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{800:function(e,t,a){"use strict";a.r(t);var o=a(1),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"prepare-the-software-to-run"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prepare-the-software-to-run"}},[e._v("#")]),e._v(" Prepare the Software to Run")]),e._v(" "),a("p",[e._v("To get to production, the first order of business is to build the binary that the nodes will run. If you used Ignite CLI, then you already did this under the hood with the "),a("code",[e._v("ignite chain serve")]),e._v(" command.")]),e._v(" "),a("h2",{attrs:{id:"target-platforms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#target-platforms"}},[e._v("#")]),e._v(" Target platforms")]),e._v(" "),a("p",[e._v("Because you are going to run the nodes on different machines, they may use different operating systems and CPU types. You need to account for that when building the binary. In particular, the computer on which you build may be entirely different from the one on which you eventually run the binary. In the jargon, you need to specify the target platform(s).")]),e._v(" "),a("p",[e._v("What target platforms are available? Because you built your entire blockchain with Go, you can rely on "),a("a",{attrs:{href:"https://go.dev/doc/install/source#environment",target:"_blank",rel:"noopener noreferrer"}},[e._v("Go target platforms"),a("OutboundLink")],1),e._v(" for that. Or a nicely presented one "),a("a",{attrs:{href:"https://gist.github.com/asukakenji/f15ba7e588ac42795f421b48b8aede63",target:"_blank",rel:"noopener noreferrer"}},[e._v("such as this"),a("OutboundLink")],1),e._v(". To get the targets specific to your version of Go, just run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBnbyB0b29sIGRpc3QgbGlzdAo="}}),e._v(" "),a("p",[e._v("For instance, for "),a("code",[e._v("go version go1.18.3 linux/amd64")]),e._v(", it returns:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"YWl4L3BwYzY0CmFuZHJvaWQvMzg2CmFuZHJvaWQvYW1kNjQKYW5kcm9pZC9hcm0KYW5kcm9pZC9hcm02NApkYXJ3aW4vYW1kNjQKZGFyd2luL2FybTY0CmRyYWdvbmZseS9hbWQ2NApmcmVlYnNkLzM4NgpmcmVlYnNkL2FtZDY0CmZyZWVic2QvYXJtCmZyZWVic2QvYXJtNjQKaWxsdW1vcy9hbWQ2NAppb3MvYW1kNjQKaW9zL2FybTY0CmpzL3dhc20KbGludXgvMzg2CmxpbnV4L2FtZDY0CmxpbnV4L2FybQpsaW51eC9hcm02NApsaW51eC9taXBzCmxpbnV4L21pcHM2NApsaW51eC9taXBzNjRsZQpsaW51eC9taXBzbGUKbGludXgvcHBjNjQKbGludXgvcHBjNjRsZQpsaW51eC9yaXNjdjY0CmxpbnV4L3MzOTB4Cm5ldGJzZC8zODYKbmV0YnNkL2FtZDY0Cm5ldGJzZC9hcm0KbmV0YnNkL2FybTY0Cm9wZW5ic2QvMzg2Cm9wZW5ic2QvYW1kNjQKb3BlbmJzZC9hcm0Kb3BlbmJzZC9hcm02NApvcGVuYnNkL21pcHM2NApwbGFuOS8zODYKcGxhbjkvYW1kNjQKcGxhbjkvYXJtCnNvbGFyaXMvYW1kNjQKd2luZG93cy8zODYKd2luZG93cy9hbWQ2NAp3aW5kb3dzL2FybQp3aW5kb3dzL2FybTY0Cg=="}}),e._v(" "),a("p",[e._v("As a side note, some of these platforms are first-class ports of Go while the others are not. If you want to only see the first class ports and have installed the "),a("code",[e._v("jq")]),e._v(" tool, you can run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBnbyB0b29sIGRpc3QgbGlzdCAtanNvbiBcCiAgfCBqcSAtciAnLltdIHwgc2VsZWN0KC5GaXJzdENsYXNzKSB8IFsuR09PUyAsIC5HT0FSQ0hdIHwgam9pbigmcXVvdDsvJnF1b3Q7KScK"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Notice the "),a("code",[e._v("GOOS")]),e._v(" and "),a("code",[e._v("GOARCH")]),e._v(" keywords in the command above. You will see them again later.")])]),e._v(" "),a("p",[e._v("The list is now much shorter:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"ZGFyd2luL2FtZDY0CmRhcndpbi9hcm02NApsaW51eC8zODYKbGludXgvYW1kNjQKbGludXgvYXJtCmxpbnV4L2FybTY0CndpbmRvd3MvMzg2CndpbmRvd3MvYW1kNjQK"}}),e._v(" "),a("p",[e._v("Imagine you are going to run the node:")]),e._v(" "),a("ul",[a("li",[e._v("On regular office Linux boxes, so target "),a("code",[e._v("linux/amd64")]),e._v(".")]),e._v(" "),a("li",[e._v("Also on AWS EC2 instances with a Graviton processor, so target "),a("code",[e._v("linux/arm64")]),e._v(".")]),e._v(" "),a("li",[e._v("Validator operators are going to generate their genesis transactions on Mac computers with Intel CPUs, so target "),a("code",[e._v("darwin/amd64")]),e._v(".")])]),e._v(" "),a("h2",{attrs:{id:"build-and-package"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build-and-package"}},[e._v("#")]),e._v(" Build and package")]),e._v(" "),a("p",[e._v("There are several ways to build an executable. Pick the one that works best for your situation.")]),e._v(" "),a("h3",{attrs:{id:"with-go-build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#with-go-build"}},[e._v("#")]),e._v(" With "),a("code",[e._v("go build")])]),e._v(" "),a("p",[e._v("Your Cosmos blockchain project is at heart a Go project, so you can build it with a "),a("code",[e._v("go build")]),e._v(" command.")]),e._v(" "),a("p",[e._v("First, you need to locate your "),a("code",[e._v("func main()")]),e._v(". In fact, you may have more than one. For instance, choose the one in "),a("code",[e._v("cmd/myprojectd/main.go")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBlbnYgR09PUz1saW51eCBHT0FSQ0g9YW1kNjQgZ28gYnVpbGQgLW8gLi9idWlsZC9teXByb2plY3QtbGludXgtYW1kNjQgLi9jbWQvbXlwcm9qZWN0ZC9tYWluLmdvCiQgZW52IEdPT1M9bGludXggR09BUkNIPWFybTY0IGdvIGJ1aWxkIC1vIC4vYnVpbGQvbXlwcm9qZWN0LWxpbnV4LWFybTY0IC4vY21kL215cHJvamVjdGQvbWFpbi5nbwokIGVudiBHT09TPWRhcndpbiBHT0FSQ0g9YW1kNjQgZ28gYnVpbGQgLW8gLi9idWlsZC9teXByb2plY3QtZGFyd2luLWFtZDY0IC4vY21kL215cHJvamVjdGQvbWFpbi5nbwo="}}),e._v(" "),a("p",[e._v("This is all you need to do. If your computer is of the "),a("code",[e._v("linux/amd64")]),e._v(" platform type, you can run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL2J1aWxkL215cHJvamVjdC1saW51eC1hbWQ2NAo="}}),e._v(" "),a("p",[e._v("This should return something you will recognize:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"U3RhcmdhdGUgQ29zbW9zSHViIEFwcAoKVXNhZ2U6CiAgbXlwcm9qZWN0ZCBbY29tbWFuZF0KCkF2YWlsYWJsZSBDb21tYW5kczoKICBhZGQtZ2VuZXNpcy1hY2NvdW50IEFkZCBhIGdlbmVzaXMgYWNjb3VudCB0byBnZW5lc2lzLmpzb24KICBjb2xsZWN0LWdlbnR4cyAgICAgIENvbGxlY3QgZ2VuZXNpcyB0eHMgYW5kIG91dHB1dCBhIGdlbmVzaXMuanNvbiBmaWxlCiAgY29uZmlnICAgICAgICAgICAgICBDcmVhdGUgb3IgcXVlcnkgYW4gYXBwbGljYXRpb24gQ0xJIGNvbmZpZ3VyYXRpb24gZmlsZQouLi4K"}}),e._v(" "),a("h3",{attrs:{id:"with-ignite"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#with-ignite"}},[e._v("#")]),e._v(" With Ignite")]),e._v(" "),a("p",[e._v("Whether you prepared your project with or without Ignite, you can still "),a("a",{attrs:{href:"https://docs.ignite.com/references/cli#ignite-chain-build",target:"_blank",rel:"noopener noreferrer"}},[e._v("build it with Ignite"),a("OutboundLink")],1),e._v(". To see how to write a build command you can do:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBpZ25pdGUgY2hhaW4gYnVpbGQgLS1oZWxwCg=="}}),e._v(" "),a("p",[e._v("You need to adjust the syntax of targets from "),a("code",[e._v("linux/amd64")]),e._v(" to "),a("code",[e._v("linux:amd64")]),e._v(". Also, to give a path for the built files. In a project made by Ignite, "),a("code",[e._v("release")]),e._v(" is already added to the "),a("code",[e._v(".gitignore")]),e._v(" so it is as good a choice of build folder as any other.")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBpZ25pdGUgY2hhaW4gYnVpbGQgXAogICAgLS1yZWxlYXNlLnRhcmdldHMgbGludXg6YW1kNjQgXAogICAgLS1yZWxlYXNlLnRhcmdldHMgbGludXg6YXJtNjQgXAogICAgLS1yZWxlYXNlLnRhcmdldHMgZGFyd2luOmFtZDY0IFwKICAgIC0tb3V0cHV0IC4vcmVsZWFzZSBcCiAgICAtLXJlbGVhc2UK"}}),e._v(" "),a("p",[e._v("This creates zipped files and checksums:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"bXlwcm9qZWN0X2xpbnV4X2FtZDY0LnRhci5negpteXByb2plY3RfbGludXhfYXJtNjQudGFyLmd6Cm15cHJvamVjdF9kYXJ3aW5fYW1kNjQudGFyLmd6CnJlbGVhc2VfY2hlY2tzdW0K"}}),e._v(" "),a("p",[e._v("The checksum file contains:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"NjA2NjlkMDViYTU2MTA0ZDRkOTk5ZTE0N2M2ODhiMjI4ZWZlZTkzYWFkOTgyOWMxZDg0MThlNGJhMzE4ZWE1NiBteXByb2plY3RfbGludXhfYW1kNjQudGFyLmd6CjJmZDVmMTc0OThkY2MyNjk3YTI3NjgyMWEwZmE0ZDI0ZDVkODBhOTI0ZjdhMDkyZjJkMDdiN2JkZDZiNjYxZjggbXlwcm9qZWN0X2xpbnV4X2FybTY0LnRhci5nego2N2Y3NjBhYzg5NjRhNGFiZTY4NGVjMjcyYjM0YWJiOTY1OGIxMDM0NjhhOTYwZmNlZDEyZTRmMTQ4MDMwYTFlIG15cHJvamVjdF9kYXJ3aW5fYXJtNjQudGFyLmd6Cg=="}}),e._v(" "),a("p",[e._v("If you want to confirm a match between the written checksum values and their calculated values, run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBjZCByZWxlYXNlICZhbXA7JmFtcDsgc2hhMjU2c3VtIC1jIHJlbGVhc2VfY2hlY2tzdW0K"}}),e._v(" "),a("p",[e._v("This should output:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"txt",base64:"bXlwcm9qZWN0X2xpbnV4X2FtZDY0LnRhci5nejogT0sKbXlwcm9qZWN0X2xpbnV4X2FybTY0LnRhci5nejogT0sKbXlwcm9qZWN0X2Rhcndpbl9hbWQ2NC50YXIuZ3o6IE9LCg=="}}),e._v(" "),a("p",[e._v("The checksum is performed on the zipped file, not the executable itself. This is just as well as you can expect to send the zipped file around. When on the computer where it needs to run, you can unzip it with:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCB0YXIgeHpmIG15cHJvamVjdF9saW51eF9hbWQ2NC50YXIuZ3oK"}}),e._v(" "),a("p",[e._v("This creates a "),a("code",[e._v("myprojectd")]),e._v(" executable file.")]),e._v(" "),a("h3",{attrs:{id:"with-a-makefile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#with-a-makefile"}},[e._v("#")]),e._v(" With a "),a("code",[e._v("Makefile")])]),e._v(" "),a("p",[e._v("A "),a("a",{attrs:{href:"https://tutorialedge.net/golang/makefiles-for-go-developers/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("Makefile")]),a("OutboundLink")],1),e._v(" is just a way to keep track of potentially complex commands and summon them with simpler commands. Create your own "),a("code",[e._v("Makefile")]),e._v(" in the root folder of your project with:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"lang-makefile",base64:"YnVpbGQtYWxsOgogICAgR09PUz1saW51eCBHT0FSQ0g9YW1kNjQgZ28gYnVpbGQgLW8gLi9idWlsZC9teXByb2plY3QtbGludXgtYW1kNjQgLi9jbWQvbXlwcm9qZWN0ZC9tYWluLmdvCiAgICBHT09TPWxpbnV4IEdPQVJDSD1hcm02NCBnbyBidWlsZCAtbyAuL2J1aWxkL215cHJvamVjdC1saW51eC1hcm02NCAuL2NtZC9teXByb2plY3RkL21haW4uZ28KICAgIEdPT1M9ZGFyd2luIEdPQVJDSD1hbWQ2NCBnbyBidWlsZCAtbyAuL2J1aWxkL215cHJvamVjdC1kYXJ3aW4tYW1kNjQgLi9jbWQvbXlwcm9qZWN0ZC9tYWluLmdvCgpkby1jaGVja3N1bToKICAgIGNkIGJ1aWxkICZhbXA7JmFtcDsgc2hhMjU2c3VtIG15cHJvamVjdC1saW51eC1hbWQ2NCBteXByb2plY3QtbGludXgtYXJtNjQgbXlwcm9qZWN0LWRhcndpbi1hbWQ2NCAmZ3Q7IG15cHJvamVjdF9jaGVja3N1bQoKYnVpbGQtd2l0aC1jaGVja3N1bTogYnVpbGQtYWxsIGRvLWNoZWNrc3VtCg=="}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Note the lines that add a checksum file as does Ignite. Also, make sure that if you copy paste you have a "),a("kbd",[e._v("Tab")]),e._v(" before each command and not spaces.")])]),e._v(" "),a("p",[e._v("If you do not have it yet, install the "),a("code",[e._v("make")]),e._v(" tool. For instance, on Ubuntu:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBzdWRvIGFwdC1nZXQgaW5zdGFsbCAtLXllcyBtYWtlCg=="}}),e._v(" "),a("p",[e._v("With "),a("code",[e._v("make")]),e._v(" you can then call a build with checksums with:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBtYWtlIGJ1aWxkLXdpdGgtY2hlY2tzdW0K"}}),e._v(" "),a("p",[e._v("If you want to see what a vastly more complex "),a("code",[e._v("Makefile")]),e._v(" looks like, head to the "),a("a",{attrs:{href:"https://github.com/cosmos/gaia/blob/main/Makefile",target:"_blank",rel:"noopener noreferrer"}},[e._v("Cosmos Hub's own "),a("code",[e._v("Makefile")]),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"with-a-makefile-within-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#with-a-makefile-within-docker"}},[e._v("#")]),e._v(" With a "),a("code",[e._v("Makefile")]),e._v(" within Docker")]),e._v(" "),a("p",[e._v("If you do not want to install Go or "),a("code",[e._v("make")]),e._v(" on your build computer, and "),a("a",{attrs:{href:"https://docs.docker.com/engine/install/",target:"_blank",rel:"noopener noreferrer"}},[e._v("have Docker"),a("OutboundLink")],1),e._v(", you can:")]),e._v(" "),a("ul",[a("li",[e._v("Reuse the "),a("code",[e._v("Makefile")]),e._v(" from above.")]),e._v(" "),a("li",[e._v("Pick a Docker image that already has Go 1.18.3 and "),a("code",[e._v("make")]),e._v(". "),a("a",{attrs:{href:"https://hub.docker.com/layers/golang/library/golang/1.18.3/images/sha256-ea66badd7cf7b734e2484a1905b6545bd944ef3bdeea18be833db3e2219f1153?context=explore",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("golang:1.18.3")]),a("OutboundLink")],1),e._v(" is a good choice.")])]),e._v(" "),a("p",[e._v("Run the command:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBkb2NrZXIgcnVuIC0tcm0gLWl0IFwKICAtdiAkKHB3ZCk6L215cHJvamVjdCBcCiAgLXcgL215cHJvamVjdCBcCiAgZ29sYW5nOjEuMTguMyBcCiAgbWFrZSBidWlsZC13aXRoLWNoZWNrc3VtCg=="}}),e._v(" "),a("h2",{attrs:{id:"deploy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy"}},[e._v("#")]),e._v(" Deploy")]),e._v(" "),a("p",[a("strong",[e._v("To keep? To modify?")])]),e._v(" "),a("p",[e._v("Eventually, you will run these executables on computers. The command will be a perhaps-complex version of:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBteXByb2plY3RkIHN0YXJ0Cg=="}}),e._v(" "),a("p",[e._v("By default, CometBFT and the Cosmos app are launched together, run together, and communicate via sockets. This is the recommended way of launching. It is not the only way of launching, though.")]),e._v(" "),a("p",[e._v("You can launch CometBFT and the Cosmos app separately, and even on different computers. If you do so, ensure that only your CometBFT app can contact the Cosmos app on the ABCI.")]),e._v(" "),a("p",[e._v("For instance:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("To start only the CometBFT node, run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBteXByb2plY3RkIHN0YXJ0IC0tcHJveHlfYXBwIHRjcDovLzE5Mi4xNjguMC41OjI2NjU4Cg=="}}),e._v(" "),a("p",[e._v("Where "),a("code",[e._v("192.168.0.5")]),e._v(" is the address where you launch the Cosmos app.")])],1),e._v(" "),a("li",[a("p",[e._v("To start only the Cosmos app, you run:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBteXByb2plY3RkIHN0YXJ0IC0td2l0aC10ZW5kZXJtaW50PWZhbHNlIC0tYWJjaSBncnBjIC0tYWRkcmVzcyB0Y3A6Ly8xOTIuMTY4LjAuNToyNjY1OAo="}})],1)]),e._v(" "),a("p",[e._v("Again, this is not recommended for performance reasons - for example, due to network latency.")]),e._v(" "),a("HighlightBox",{attrs:{type:"tip"}},[a("p",[e._v("If you would like to see how to apply what you've learned, you can go straight to the exercise in "),a("RouterLink",{attrs:{to:"/hands-on-exercise/4-run-in-prod/1-run-prod-docker.html"}},[e._v("Simulate production in Docker")]),e._v(" to start from scratch.")],1),e._v(" "),a("p",[e._v("More specifically, you can jump to:")]),e._v(" "),a("ul",[a("li",[a("RouterLink",{attrs:{to:"/hands-on-exercise/4-run-in-prod/1-run-prod-docker.html#docker-elements"}},[e._v("Docker elements")]),e._v(", to see how to compile the necessary software.")],1)])]),e._v(" "),a("HighlightBox",{attrs:{type:"synopsis"}},[a("p",[e._v("To summarize, this section has explored:")]),e._v(" "),a("ul",[a("li",[e._v("How to build the binary that the nodes will run, using "),a("code",[e._v("go build")]),e._v(", Ignite CLI, a "),a("code",[e._v("Makefile")]),e._v(", or a "),a("code",[e._v("Makefile")]),e._v(" within Docker.")]),e._v(" "),a("li",[e._v("Different methods of deploying, such as by launching CometBFT and the Cosmos app simultaneously, or by starting either one independently of the other.")]),e._v(" "),a("li",[e._v("The importance of ensuring the binary will run equally well on computers using different OS and CPU types.")])])])],1)}),[],!1,null,null,null);t.default=s.exports}}]);