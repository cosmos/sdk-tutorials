(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{764:function(e,t,a){"use strict";a.r(t);var o=a(1),s=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"integrate-cosmjs-and-keplr-into-the-gui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#integrate-cosmjs-and-keplr-into-the-gui"}},[e._v("#")]),e._v(" Integrate CosmJS and Keplr Into the GUI")]),e._v(" "),a("HighlightBox",{attrs:{type:"prerequisite"}},[a("p",[e._v("Make sure you have all you need before proceeding:")]),e._v(" "),a("ul",[a("li",[e._v("You understand the concepts of "),a("RouterLink",{attrs:{to:"/academy/xl-cosmjs/intro.html"}},[e._v("CosmJS")]),e._v(".")],1),e._v(" "),a("li",[e._v("You have the checkers blockchain codebase up to the external GUI. If not, follow the "),a("RouterLink",{attrs:{to:"/academy/cosmjs-checkers-sections/external-gui.html"}},[e._v("previous steps")]),e._v(" or you can go ahead and clone and checkout "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/tree/unwired-gui",target:"_blank",rel:"noopener noreferrer"}},[e._v("this branch"),a("OutboundLink")],1),e._v(" to get the version needed for this tutorial.")],1)])]),e._v(" "),a("p",[e._v("In the previous sections:")]),e._v(" "),a("ol",[a("li",[e._v("You created the objects, messages, and clients that allow you to "),a("strong",[e._v("interface")]),e._v(" any GUI with your Checkers blockchain.")]),e._v(" "),a("li",[e._v("You imported an external Checkers "),a("strong",[e._v("GUI")]),e._v(" to use.")])]),e._v(" "),a("p",[e._v("Now, you must "),a("strong",[e._v("integrate the two")]),e._v(" together:")]),e._v(" "),a("ul",[a("li",[e._v("Adjust the React app to be able to package CosmJS.")]),e._v(" "),a("li",[e._v("Work on the CosmJS integration.")])]),e._v(" "),a("p",[e._v("For the CosmJS integration, you will:")]),e._v(" "),a("ul",[a("li",[e._v("Work with the GUI's data structures.")]),e._v(" "),a("li",[e._v("Fetch all games from the blockchain and display them (without pagination).")]),e._v(" "),a("li",[e._v("Integrate with Keplr for browser-based players.")]),e._v(" "),a("li",[e._v("Create a new game.")]),e._v(" "),a("li",[e._v("Fetch a single game to be played.")])]),e._v(" "),a("p",[e._v("Rejecting a game will be left to you as an exercise.")]),e._v(" "),a("h2",{attrs:{id:"prepare-the-integration-with-the-checkers-blockchain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prepare-the-integration-with-the-checkers-blockchain"}},[e._v("#")]),e._v(" Prepare the integration with the checkers blockchain")]),e._v(" "),a("h3",{attrs:{id:"prepare-webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prepare-webpack"}},[e._v("#")]),e._v(" Prepare Webpack")]),e._v(" "),a("p",[e._v("Your GUI uses React v18, which uses Webpack v5. Therefore you need to "),a("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/5fc0960/README.md#webpack-configs",target:"_blank",rel:"noopener noreferrer"}},[e._v("adjust Webpack's configuration"),a("OutboundLink")],1),e._v(" to handle some elements (see also the CosmJS documentation). To modify the Webpack configuration in a non-ejected React app, use "),a("a",{attrs:{href:"https://www.npmjs.com/package/react-app-rewired",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("react-app-rewired")]),a("OutboundLink")],1),e._v(" as "),a("a",{attrs:{href:"https://stackoverflow.com/questions/63280109/how-to-update-webpack-config-for-a-react-project-created-using-create-react-app",target:"_blank",rel:"noopener noreferrer"}},[e._v("explained here"),a("OutboundLink")],1),e._v(":")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Install the new package:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucG0gaW5zdGFsbCByZWFjdC1hcHAtcmV3aXJlZEAyLjIuMSAtLXNhdmUtZGV2IC0tc2F2ZS1leGFjdAo="}})],1),e._v(" "),a("li",[a("p",[e._v("Add a new "),a("code",[e._v("config-overrides.js")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cmVxdWlyZSgmcXVvdDtkb3RlbnYmcXVvdDspLmNvbmZpZygpCmNvbnN0IHdlYnBhY2sgPSByZXF1aXJlKCZxdW90O3dlYnBhY2smcXVvdDspCgptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIG92ZXJyaWRlKGNvbmZpZywgZW52KSB7CiAgICBjb25maWcucGx1Z2lucy5wdXNoKAogICAgICAgIG5ldyB3ZWJwYWNrLlByb3ZpZGVQbHVnaW4oewogICAgICAgICAgICBCdWZmZXI6IFsmcXVvdDtidWZmZXImcXVvdDssICZxdW90O0J1ZmZlciZxdW90O10sCiAgICAgICAgfSksCiAgICAgICAgbmV3IHdlYnBhY2suRW52aXJvbm1lbnRQbHVnaW4oWyZxdW90O1JQQ19VUkwmcXVvdDtdKSwKICAgICkKICAgIGNvbmZpZy5yZXNvbHZlLmZhbGxiYWNrID0gewogICAgICAgIGJ1ZmZlcjogZmFsc2UsCiAgICAgICAgY3J5cHRvOiBmYWxzZSwKICAgICAgICBldmVudHM6IGZhbHNlLAogICAgICAgIHBhdGg6IGZhbHNlLAogICAgICAgIHN0cmVhbTogZmFsc2UsCiAgICAgICAgc3RyaW5nX2RlY29kZXI6IGZhbHNlLAogICAgfQogICAgcmV0dXJuIGNvbmZpZwp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/config-overrides.js#L1-L20"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("You can also pass along the "),a("code",[e._v("RPC_URL")]),e._v(" as an environment variable.")])])],1),e._v(" "),a("li",[a("p",[e._v("Change the run targets to use "),a("code",[e._v("react-app-rewired")]),e._v(" in "),a("code",[e._v("package.json")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICAgLi4uCiAgICAmcXVvdDtzY3JpcHRzJnF1b3Q7OiB7CiAgICAgICAgJnF1b3Q7c3RhcnQmcXVvdDs6ICZxdW90O3JlYWN0LWFwcC1yZXdpcmVkIHN0YXJ0JnF1b3Q7LAogICAgICAgICZxdW90O2J1aWxkJnF1b3Q7OiAmcXVvdDtyZWFjdC1hcHAtcmV3aXJlZCBidWlsZCZxdW90OywKICAgICAgICAmcXVvdDt0ZXN0JnF1b3Q7OiAmcXVvdDtyZWFjdC1hcHAtcmV3aXJlZCB0ZXN0JnF1b3Q7LAogICAgICAgICZxdW90O2VqZWN0JnF1b3Q7OiAmcXVvdDtyZWFjdC1zY3JpcHRzIGVqZWN0JnF1b3Q7CiAgICB9LAogICAgLi4uCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/package.json#L8-L11"}}),e._v(" "),a("p",[e._v("Be careful to leave the "),a("code",[e._v('"eject"')]),e._v(" unchanged.")])],1)]),e._v(" "),a("p",[e._v("See a "),a("RouterLink",{attrs:{to:"/academy/cosmjs-checkers-sections/cosmjs-objects.html"}},[e._v("previous section")]),e._v(" for how set "),a("code",[e._v("RPC_URL")]),e._v(" in "),a("code",[e._v("process.env.RPC_URL")]),e._v(". It also assumes that you have an RPC end point that runs the Checkers blockchain, as explained in the previous section.")],1),e._v(" "),a("h3",{attrs:{id:"gui-data-structures"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gui-data-structures"}},[e._v("#")]),e._v(" GUI data structures")]),e._v(" "),a("p",[e._v("The Checkers GUI uses different data structures, which you must understand to convert them correctly.")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("The "),a("code",[e._v("IPlayerInfo")]),e._v(" has a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/sharedTypes.ts#L27",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("name: string")]),a("OutboundLink")],1),e._v(" field which can be used as the player's address.")])]),e._v(" "),a("li",[a("p",[e._v("The "),a("code",[e._v("IGameInfo")]),e._v(" has a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/sharedTypes.ts#L11",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("board: number[][] | null")]),a("OutboundLink")],1),e._v(" field. You must do a conversion from "),a("code",[e._v("b*b*...")]),e._v(" to this type. Ensure that the alignments are correct.")])]),e._v(" "),a("li",[a("p",[e._v("The "),a("code",[e._v("IGameInfo")]),e._v(" has a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/sharedTypes.ts#L17",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("turn: number")]),a("OutboundLink")],1),e._v(", which maps to "),a("code",[e._v('"b"')]),e._v(" or "),a("code",[e._v('"r"')]),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("The "),a("code",[e._v("IGameInfo")]),e._v(" lacks an "),a("code",[e._v("index")]),e._v(" or "),a("code",[e._v("id")]),e._v(" field. Instead the GUI developer identified games by their index in an array, which is not adequate for this case. You must add an "),a("code",[e._v("index")]),e._v(" field to "),a("code",[e._v("IGameInfo")]),e._v(". This is saved as a "),a("code",[e._v("string")]),e._v(" in the blockchain but in practice is a "),a("strong",[e._v("number")]),e._v(", which the GUI code expects as game index. Add:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGludGVyZmFjZSBJR2FtZUluZm8gewogICAgLi4uCiAgICBpbmRleDogbnVtYmVyCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/sharedTypes.ts#L18"}}),e._v(" "),a("p",[e._v("To avoid compilation errors on "),a("code",[e._v("index:")]),e._v(" elsewhere, temporarily add "),a("code",[e._v("index?: number")]),e._v(". Remember to come back and remove the "),a("code",[e._v("?")]),e._v(".")])],1)]),e._v(" "),a("h3",{attrs:{id:"board-converter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#board-converter"}},[e._v("#")]),e._v(" Board converter")]),e._v(" "),a("p",[e._v("In order to correctly convert a "),a("em",[e._v("blockchain")]),e._v(" board into a "),a("em",[e._v("GUI")]),e._v(" board, you want to see how a GUI board is coded. In "),a("code",[e._v("components/Game/Board/Board.tsx")]),e._v(", add a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/Board/Board.tsx#L18",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("console.log(props.squares)")]),a("OutboundLink")],1),e._v(". Let React recompile, open the browser console, and create a game. You should see printed:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"WwogICAgWzAsIDEsIDAsIDEsIDAsIDEsIDAsIDFdLAogICAgWzEsIDAsIDEsIC4uLiAgICAgICAgICBdLAogICAgLi4uLAogICAgWy4uLiAgICAgICAgICAsIDIsIDAsIDJdLAogICAgWzIsIDAsIDIsIDAsIDIsIDAsIDIsIDBdCl0K"}}),e._v(" "),a("p",[e._v("Where "),a("code",[e._v("1")]),e._v(" represents player 1, i.e. black pieces. Compare that to how a game is saved in the blockchain:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"JnF1b3Q7KmIqYipiKmJ8YipiKmIqYip8KmIqYipiKmJ8KioqKioqKip8KioqKioqKip8cipyKnIqcip8KnIqcipyKnJ8cipyKnIqciomcXVvdDsK"}}),e._v(" "),a("p",[e._v("To convert the board, create a new file "),a("code",[e._v("src/types/checkers/board.ts")]),e._v(" and code as follows:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3Qgcm93U2VwYXJhdG9yID0gJnF1b3Q7fCZxdW90OwpleHBvcnQgY29uc3QgcGllY2VUcmFuc2xhdG9yID0gewogICAgJnF1b3Q7KiZxdW90OzogMCwKICAgIGI6IDEsCiAgICByOiAyLAp9CmV4cG9ydCBjb25zdCBwbGF5ZXJSZXZlcnNlVHJhbnNsYXRvcjogUGxheWVyW10gPSBbJnF1b3Q7YiZxdW90OywgJnF1b3Q7ciZxdW90O107CmV4cG9ydCBjb25zdCBwaWVjZVJldmVyc2VUcmFuc2xhdG9yID0gWyZxdW90OyomcXVvdDssIC4uLnBsYXllclJldmVyc2VUcmFuc2xhdG9yXTsKCmV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVkVG9Cb2FyZChzZXJpYWxpemVkOiBzdHJpbmcpOiBudW1iZXJbXVtdIHsKICAgIHJldHVybiBzZXJpYWxpemVkCiAgICAgICAgLnNwbGl0KHJvd1NlcGFyYXRvcikKICAgICAgICAubWFwKChyb3c6IHN0cmluZykgPSZndDsgcm93LnNwbGl0KCZxdW90OyZxdW90OykubWFwKChjaGFyOiBzdHJpbmcpID0mZ3Q7IChwaWVjZVRyYW5zbGF0b3IgYXMgYW55KVtjaGFyXSkpCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/board.ts#L5-L18"}}),e._v(" "),a("h3",{attrs:{id:"game-converter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#game-converter"}},[e._v("#")]),e._v(" Game converter")]),e._v(" "),a("p",[e._v("Next you convert a "),a("code",[e._v("StoredGame")]),e._v(" into the "),a("code",[e._v("IGameInfo")]),e._v(" of the GUI:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGZ1bmN0aW9uIHN0b3JlZFRvR2FtZUluZm8oZ2FtZTogU3RvcmVkR2FtZSk6IElHYW1lSW5mbyB7CiAgICByZXR1cm4gewogICAgICAgIGJvYXJkOiBzZXJpYWxpemVkVG9Cb2FyZChnYW1lLmdhbWUpLAogICAgICAgIGNyZWF0ZWQ6IG5ldyBEYXRlKERhdGUubm93KCkpLAogICAgICAgIGlzTmV3R2FtZTogZ2FtZS5tb3ZlQ291bnQuZXF1YWxzKDApLAogICAgICAgIGxhc3Q6IG5ldyBEYXRlKERhdGUucGFyc2UoZ2FtZS5kZWFkbGluZSkgLSA4NjQwMCAqIDEwMDApLAogICAgICAgIHAxOiB7CiAgICAgICAgICAgIG5hbWU6IGdhbWUuYmxhY2ssIC8vIEFkZHJlc3NlcyBhcmUgdXNlZCBpbnN0ZWFkIG9mIG5hbWVzLgogICAgICAgICAgICBpc19haTogZmFsc2UsIC8vIFRvIG1ha2UgaXQgc2ltcGxlLgogICAgICAgICAgICBzY29yZTogMCwKICAgICAgICB9LAogICAgICAgIHAyOiB7CiAgICAgICAgICAgIG5hbWU6IGdhbWUucmVkLAogICAgICAgICAgICBpc19haTogZmFsc2UsCiAgICAgICAgICAgIHNjb3JlOiAwLAogICAgICAgIH0sCiAgICAgICAgdHVybjogKHBpZWNlVHJhbnNsYXRvciBhcyBhbnkpW2dhbWUudHVybl0sCiAgICAgICAgaW5kZXg6IHBhcnNlSW50KGdhbWUuaW5kZXgpLAogICAgfTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHN0b3JlZHNUb0dhbWVJbmZvcyhnYW1lczogU3RvcmVkR2FtZVtdKTogSUdhbWVJbmZvW10gewogICAgcmV0dXJuIGdhbWVzLm1hcChzdG9yZWRUb0dhbWVJbmZvKTsKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/board.ts#L20-L43"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Here:")]),e._v(" "),a("ul",[a("li",[e._v("You use Cosmos addresses instead of names.")]),e._v(" "),a("li",[e._v("You put today in the creation date because it is not stored in "),a("code",[e._v("StoredGame")]),e._v(".")]),e._v(" "),a("li",[e._v("You set the "),a("code",[e._v("last")]),e._v(" played date to deadline minus expiry duration (an adequate solution).")]),e._v(" "),a("li",[e._v('The possibility of "AI" is not important.')])])]),e._v(" "),a("HighlightBox",{attrs:{type:"info"}},[a("p",[e._v("Could an AI player and the blockchain mix together? If "),a("em",[e._v("the AI")]),e._v(" has access to a private key that lets it send transactions, it would be a bona fide player. This could be implemented with backend scripts running on a server. See "),a("RouterLink",{attrs:{to:"/academy/cosmjs-checkers-sections/server-side.html"}},[e._v("Checkers backend scripts")]),e._v(" for an example of backend scripts for a different use-case.")],1)]),e._v(" "),a("h2",{attrs:{id:"obtain-a-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#obtain-a-client"}},[e._v("#")]),e._v(" Obtain a client")]),e._v(" "),a("p",[e._v("For your React components to communicate with the blockchain they need to have access to a "),a("code",[e._v("StargateClient")]),e._v(", and at some point to a "),a("code",[e._v("SigningStargateClient")]),e._v(" too. Among the information they need is the RPC URL.")]),e._v(" "),a("h3",{attrs:{id:"pass-rpc-parameters"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pass-rpc-parameters"}},[e._v("#")]),e._v(" Pass RPC parameters")]),e._v(" "),a("p",[e._v("The RPC URL is already saved into "),a("code",[e._v("process.env.RPC_URL")]),e._v(" thanks to "),a("code",[e._v("react-app-rewired")]),e._v(". However, it is better to reduce your components' reliance on "),a("code",[e._v("process.env")]),e._v(". A simple way to give the RPC URL to the components is for them to:")]),e._v(" "),a("ul",[a("li",[e._v("Receive an "),a("code",[e._v("rpcUrl: string")]),e._v(" in the properties.")]),e._v(" "),a("li",[e._v("Keep a "),a("code",[e._v("StargateClient")]),e._v(" in the component's state that would be instantiated lazily.")])]),e._v(" "),a("p",[e._v("With this setup, only "),a("code",[e._v("index.tsx")]),e._v(" would use "),a("code",[e._v("process.env.RPC_URL")]),e._v(".")]),e._v(" "),a("p",[e._v("For instance, prepare access to "),a("code",[e._v("rpcUrl")]),e._v(" for "),a("code",[e._v("MenuContainer.tsx")]),e._v(" by adding it to the following:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("The properties of "),a("code",[e._v("src/components/Menu/MenuContainer.tsx")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGludGVyZmFjZSBJTWVudUNvbnRhaW5lclByb3BzIHsKICAgIC4uLgogICAgcnBjVXJsOiBzdHJpbmcKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L14"}})],1),e._v(" "),a("li",[a("p",[e._v("The properties of the component call stack, first in "),a("code",[e._v("src/components/App.tsx")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGludGVyZmFjZSBBcHBQcm9wcyB7CiAgICBycGNVcmw6IHN0cmluZzsKfQoKY29uc3QgQXBwID0gKHsgcnBjVXJsIH06IEFwcFByb3BzKSA9Jmd0OyB7CiAgICAuLi4KICAgIHJldHVybiAoCiAgICAgICAgJmx0O0NvbnRhaW5lciBzdHlsZT17c3R5bGVzfSZndDsKICAgICAgICAgICAgLi4uCiAgICAgICAgICAgICZsdDtSb3V0ZSBwYXRoPSZxdW90O21lbnUmcXVvdDsgZWxlbWVudD17Jmx0O01lbnVDb250YWluZXIgbG9jYXRpb249eyZxdW90OyZxdW90O30gcnBjVXJsPXtycGNVcmx9IC8mZ3Q7fSAvJmd0OwogICAgICAgICAgICAuLi4KICAgICAgICAmbHQ7L0NvbnRhaW5lciZndDsKICAgICkKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/App.tsx#L38-L49"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("You have to create the "),a("em",[e._v("missing")]),e._v(" "),a("code",[e._v("AppProps")]),e._v(" entirely.")])])],1),e._v(" "),a("li",[a("p",[e._v("Finally, to "),a("code",[e._v("src/index.tsx")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cm9vdC5yZW5kZXIoCiAgICAmbHQ7UmVhY3QuU3RyaWN0TW9kZSZndDsKICAgICAgICAmbHQ7QnJvd3NlclJvdXRlciZndDsKICAgICAgICAgICAgJmx0O0FwcCBycGNVcmw9e3Byb2Nlc3MuZW52LlJQQ19VUkwhfSAvJmd0OwogICAgICAgICZsdDsvQnJvd3NlclJvdXRlciZndDsKICAgICZsdDsvUmVhY3QuU3RyaWN0TW9kZSZndDssCikK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/index.tsx#L21"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("The "),a("code",[e._v("!")]),e._v(" forces the type of "),a("code",[e._v(".RPC_URL")]),e._v(" from "),a("code",[e._v("string | undefined")]),e._v(" to "),a("code",[e._v("string")]),e._v(".")])])],1)]),e._v(" "),a("p",[e._v("Whenever another component needs the "),a("code",[e._v("rpcUrl")]),e._v(", adapt and reproduce these steps as necessary.")]),e._v(" "),a("h3",{attrs:{id:"create-the-stargateclient"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-the-stargateclient"}},[e._v("#")]),e._v(" Create the "),a("code",[e._v("StargateClient")])]),e._v(" "),a("p",[e._v("Whenever you need a "),a("code",[e._v("StargateClient")]),e._v(" in a component, you can repeat the following chain of actions for the component in question. For instance, to prepare the client in the state of "),a("code",[e._v("src/components/Menu/MenuContainer.tsx")]),e._v(":")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Add the field in the state:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW50ZXJmYWNlIElNZW51Q29udGFpbmVyU3RhdGUgewogICAgLi4uCiAgICBjbGllbnQ6IENoZWNrZXJzU3RhcmdhdGVDbGllbnQgfCB1bmRlZmluZWQKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L20"}})],1),e._v(" "),a("li",[a("p",[e._v("Initialize it to "),a("code",[e._v("undefined")]),e._v(" in the constructor:")])])]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3RydWN0b3IocHJvcHM6IElNZW51Q29udGFpbmVyUHJvcHMpIHsKICAgIC4uLgogICAgdGhpcy5zdGF0ZSA9IHsKICAgICAgICAuLi4KICAgICAgICBjbGllbnQ6IHVuZGVmaW5lZCwKICAgIH07CiAgICAuLi4KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L30"}}),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[a("p",[e._v("Add a method that implements the conditional instantiation:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHJvdGVjdGVkIGFzeW5jIGdldFN0YXJnYXRlQ2xpZW50KCk6IFByb21pc2UmbHQ7Q2hlY2tlcnNTdGFyZ2F0ZUNsaWVudCZndDsgewogICBjb25zdCBjbGllbnQ6IENoZWNrZXJzU3RhcmdhdGVDbGllbnQgPQogICAgICAgdGhpcy5zdGF0ZS5jbGllbnQgPz8gKGF3YWl0IENoZWNrZXJzU3RhcmdhdGVDbGllbnQuY29ubmVjdCh0aGlzLnByb3BzLnJwY1VybCkpCiAgIGlmICghdGhpcy5zdGF0ZS5jbGllbnQpIHRoaXMuc2V0U3RhdGUoeyBjbGllbnQ6IGNsaWVudCB9KQogICByZXR1cm4gY2xpZW50Cn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L46-L51"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("This creates it only once by saving the client in the state.")])])],1)]),e._v(" "),a("p",[e._v("Instantiating a "),a("code",[e._v("CheckersSigningStargateClient")]),e._v(" is more involved, as you will see later on.")]),e._v(" "),a("p",[e._v("First, make use of what you already prepared. Why choose to start with "),a("code",[e._v("MenuContainer")]),e._v("? Because that is where all the games are listed.")]),e._v(" "),a("h2",{attrs:{id:"show-all-games"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#show-all-games"}},[e._v("#")]),e._v(" Show all games")]),e._v(" "),a("p",[e._v("To show all games, you only need the read-only "),a("code",[e._v("StargateClient")]),e._v(". There is no need to worry about private keys for now. Where do you query for the games?")]),e._v(" "),a("h3",{attrs:{id:"all-games-container"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#all-games-container"}},[e._v("#")]),e._v(" All games container")]),e._v(" "),a("p",[e._v("Look into "),a("code",[e._v("src/components/Menu/MenuContainer.tsx")]),e._v(" for the "),a("code",[e._v("componentDidMount")]),e._v(" method, which accesses the browser storage for saved games. You can replace the storage logic with the following steps:")]),e._v(" "),a("ul",[a("li",[e._v("Obtain a "),a("code",[e._v("StargateClient")]),e._v(" with the "),a("code",[e._v("getStargateClient")]),e._v(" method.")]),e._v(" "),a("li",[e._v("Obtain the blockchain games (without pagination).")]),e._v(" "),a("li",[e._v("Convert the blockchain games to the format the component expects.")]),e._v(" "),a("li",[e._v("Save them in "),a("code",[e._v("saved: IGameInfo[]")]),e._v(" of the component's state.")])]),e._v(" "),a("p",[e._v("A good next step is to add a new function to "),a("code",[e._v("CheckersStargateClient")]),e._v(" to handle the call and the conversion, or to add a helper function that takes a client as a parameter.")]),e._v(" "),a("h3",{attrs:{id:"a-specific-gui-method"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#a-specific-gui-method"}},[e._v("#")]),e._v(" A specific GUI method")]),e._v(" "),a("p",[e._v("In the future you may want to reuse the "),a("code",[e._v("CheckersStargateClient")]),e._v(" code in another GUI or for backend scripts. To avoid polluting the code, and to avoid a less-elegant helper where you need to pass a Stargate client as a parameter, add "),a("a",{attrs:{href:"https://www.c-sharpcorner.com/article/learn-about-extension-methods-in-typescript/#:~:text=Extension%2Dmethod%20gives%20you%20the,any%20data%2Dtype%20you%20want",target:"_blank",rel:"noopener noreferrer"}},[e._v("an extension method"),a("OutboundLink")],1),e._v(" to "),a("code",[e._v("CheckersStargateClient")]),e._v(".")]),e._v(" "),a("p",[e._v("In a new "),a("code",[e._v("src/types/checkers/extensions-gui.ts")]),e._v(":")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Declare the new extension method that extends your "),a("code",[e._v("CheckersStargateClient")]),e._v(" "),a("em",[e._v("module")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZGVjbGFyZSBtb2R1bGUgJnF1b3Q7Li4vLi4vY2hlY2tlcnNfc3RhcmdhdGVjbGllbnQmcXVvdDsgewogICAgaW50ZXJmYWNlIENoZWNrZXJzU3RhcmdhdGVDbGllbnQgewogICAgICAgIGdldEd1aUdhbWVzKCk6IFByb21pc2UmbHQ7SUdhbWVJbmZvW10mZ3Q7CiAgICB9Cn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L10-L12"}})],1),e._v(" "),a("li",[a("p",[e._v("Add its implementation:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typecript",base64:"Q2hlY2tlcnNTdGFyZ2F0ZUNsaWVudC5wcm90b3R5cGUuZ2V0R3VpR2FtZXMgPSBhc3luYyBmdW5jdGlvbiAoKTogUHJvbWlzZSZsdDtJR2FtZUluZm9bXSZndDsgewogICAgcmV0dXJuICgKICAgICAgICBhd2FpdCB0aGlzLmNoZWNrZXJzUXVlcnlDbGllbnQhLmNoZWNrZXJzLmdldEFsbFN0b3JlZEdhbWVzKAogICAgICAgICAgICBVaW50OEFycmF5LmZyb20oW10pLAogICAgICAgICAgICBMb25nLlpFUk8sCiAgICAgICAgICAgIExvbmcuZnJvbU51bWJlcigyMCksCiAgICAgICAgICAgIHRydWUsCiAgICAgICAgKQogICAgKS5zdG9yZWRHYW1lcy5tYXAoc3RvcmVkVG9HYW1lSW5mbykKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L29-L38"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Note this does not care about pagination or games beyond the first 20. This purely-GUI detail is left as an exercise.")])])],1)]),e._v(" "),a("h3",{attrs:{id:"all-games-call"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#all-games-call"}},[e._v("#")]),e._v(" All games call")]),e._v(" "),a("p",[e._v("Next, in "),a("code",[e._v("MenuContainer.tsx")]),e._v(":")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Add an empty "),a("code",[e._v("import")]),e._v(" for the extension method file, otherwise the method is not compiled:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHt9IGZyb20gJnF1b3Q7Li4vLi4vdHlwZXMvY2hlY2tlcnMvZ3VpLWV4dGVuc2lvbnMmcXVvdDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L4"}})],1),e._v(" "),a("li",[a("p",[e._v("Change "),a("code",[e._v("componentDidMount")]),e._v(" to "),a("code",[e._v("async")]),e._v(" and replace the storage code with a call to the new method:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCk6IFByb21pc2UmbHQ7dm9pZCZndDsgewogICAgY29uc3QgcXVlcmllcyA9IFF1ZXJ5U3RyaW5nLnBhcnNlKHRoaXMucHJvcHMubG9jYXRpb24uc2VhcmNoKQogICAgaWYgKHF1ZXJpZXMubmV3R2FtZSkgewogICAgICAgIHRoaXMuc2V0U3RhdGUoeyBzaG93TW9kYWw6IHRydWUgfSkKICAgIH0KICAgIHRoaXMuc2V0U3RhdGUoewogICAgICAgIHNhdmVkOiBhd2FpdCAoYXdhaXQgdGhpcy5nZXRTdGFyZ2F0ZUNsaWVudCgpKS5nZXRHdWlHYW1lcygpLAogICAgfSkKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L37-L45"}})],1)]),e._v(" "),a("p",[e._v("Restart "),a("code",[e._v("npm start")]),e._v(" and you should see an empty games list (unless you have previously created any). If you have access to any way of creating a game, for instance with the "),a("code",[e._v("checkersd")]),e._v(" command line, test this new functionality by creating one:")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/list-games-1.png"}})],1),e._v(" "),a("p",[e._v("If you do not have a way to create a game, wait for the procedures about creating a game.")]),e._v(" "),a("h3",{attrs:{id:"individual-game-menu-container"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#individual-game-menu-container"}},[e._v("#")]),e._v(" Individual game menu container")]),e._v(" "),a("p",[e._v("Each game is now listed as a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuItem.tsx",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("src/components/Menu/MenuItem.tsx")]),a("OutboundLink")],1),e._v(". However, in "),a("code",[e._v("src/components/Menu/Menu.tsx")]),e._v(" the "),a("code",[e._v("index")]),e._v(" of the game is taken from its "),a("em",[e._v("index")]),e._v(" in the games array, which is not what you want here. The list needs to use the proper "),a("code",[e._v("index")]),e._v(" of each game. In "),a("code",[e._v("Menu.tsx")]),e._v(" make this change:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgTWVudSA9IChwcm9wczogSU1lbnVQcm9wcykgPSZndDsgewogICAgY29uc3QgbWVudUl0ZW1zID0gcHJvcHMuZ2FtZXMubWFwKChnYW1lLCBpbmRleCkgPSZndDsgKAogICAgICAmbHQ7TWVudUl0ZW0gLi4uIGluZGV4PXtnYW1lLmluZGV4fSBrZXk9eyZxdW90O2dhbWUmcXVvdDsgKyBnYW1lLmluZGV4fSAvJmd0OwogICAgKSkKICAgIC4uLgp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/Menu.tsx#L21-L23"}}),e._v(" "),a("p",[e._v("Alternatively, temporarily add "),a("code",[e._v("!")]),e._v(" (as in "),a("code",[e._v("game.index!")]),e._v(") if you previously added the "),a("code",[e._v("IGameInfo.index")]),e._v(" as "),a("code",[e._v("index?: number")]),e._v(".")]),e._v(" "),a("h2",{attrs:{id:"show-one-game"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#show-one-game"}},[e._v("#")]),e._v(" Show one game")]),e._v(" "),a("p",[e._v("What happens when you click on a game's "),a("kbd",[e._v("Resume Game")]),e._v("? It opens a page of the form "),a("code",[e._v("http://localhost:3000/play/1")]),e._v(". The component is "),a("code",[e._v("src/components/Game/GameContainer.tsx")]),e._v(", from which you have to pick the game information from the blockchain. This process begins as with "),a("code",[e._v("MenuContainer")]),e._v(":")]),e._v(" "),a("ul",[a("li",[e._v("Pass a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L24",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("rpcUrl")]),a("OutboundLink")],1),e._v(" along the chain to "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/App.tsx#L50",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("GameContainerWrapper")]),a("OutboundLink")],1),e._v(" then the "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/App.tsx#L21-L27",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("GameContainer")]),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[e._v("Add a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L38",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("client: CheckersStargateClient | undefined")]),a("OutboundLink")],1),e._v(" state field, "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L61",target:"_blank",rel:"noopener noreferrer"}},[e._v("initialize it"),a("OutboundLink")],1),e._v(", and add a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L115-L120",target:"_blank",rel:"noopener noreferrer"}},[e._v("lazy instantiation method"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("p",[e._v("Looking into "),a("code",[e._v("GameContainer")]),e._v(", you see that "),a("code",[e._v("componentDidMount")]),e._v(" gets all the games from storage then sets the state with the information. Instead, as you did for all games, you have to take the game from the blockchain.")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("In "),a("code",[e._v("extensions-gui.tsx")]),e._v(" declare another extension method to "),a("code",[e._v("CheckersStargateClient")]),e._v(" dedicated to getting the game as expected by the GUI:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZGVjbGFyZSBtb2R1bGUgJnF1b3Q7Li4vLi4vY2hlY2tlcnNfc3RhcmdhdGVjbGllbnQmcXVvdDsgewogICAgaW50ZXJmYWNlIENoZWNrZXJzU3RhcmdhdGVDbGllbnQgewogICAgICAgIC4uLgogICAgICAgIGdldEd1aUdhbWUoaW5kZXg6IHN0cmluZyk6IFByb21pc2UmbHQ7SUdhbWVJbmZvIHwgdW5kZWZpbmVkJmd0OwogICAgfQp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L13"}}),e._v(" "),a("p",[e._v("Now define "),a("code",[e._v("getGuiGame")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Q2hlY2tlcnNTdGFyZ2F0ZUNsaWVudC5wcm90b3R5cGUuZ2V0R3VpR2FtZSA9IGFzeW5jIGZ1bmN0aW9uIChpbmRleDogc3RyaW5nKTogUHJvbWlzZSZsdDtJR2FtZUluZm8gfCB1bmRlZmluZWQmZ3Q7IHsKICAgIGNvbnN0IHN0b3JlZEdhbWU6IFN0b3JlZEdhbWUgfCB1bmRlZmluZWQgPSBhd2FpdCB0aGlzLmNoZWNrZXJzUXVlcnlDbGllbnQhLmNoZWNrZXJzLmdldFN0b3JlZEdhbWUoaW5kZXgpCiAgICBpZiAoIXN0b3JlZEdhbWUpIHJldHVybiB1bmRlZmluZWQKICAgIHJldHVybiBzdG9yZWRUb0dhbWVJbmZvKHN0b3JlZEdhbWUpCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L40-L44"}})],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("GameContainer.tsx")]),e._v(" add an empty import to the extension methods:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHt9IGZyb20gJnF1b3Q7Li4vLi4vdHlwZXMvY2hlY2tlcnMvZXh0ZW5zaW9ucy1ndWkmcXVvdDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L6"}})],1),e._v(" "),a("li",[a("p",[e._v("Make the "),a("code",[e._v("componentDidMount")]),e._v(" method "),a("code",[e._v("async")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCk6IFByb21pc2UmbHQ7dm9pZCZndDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L72"}})],1),e._v(" "),a("li",[a("p",[e._v("Split the "),a("code",[e._v("componentDidMount")]),e._v(" method, and move the game loading lines to their own "),a("code",[e._v("loadGame")]),e._v(" function:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIGNvbXBvbmVudERpZE1vdW50KCk6IFByb21pc2UmbHQ7dm9pZCZndDsgewogICAgLy8gQWxsb3cgYSBwbGF5ZXIgdG8gbWFrZSBhIG1vdmUgYnkgZG91YmxlLWNsaWNraW5nIHRoZSBzY3JlZW4uCiAgICAvLyBUaGlzIGlzIG1haW5seSBmb3IgdG91Y2hzY3JlZW4gdXNlcnMuCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigmcXVvdDtkYmxjbGljayZxdW90OywgdGhpcy5tYWtlTW92ZSkKICAgIGF3YWl0IHRoaXMubG9hZEdhbWUoKQp9CgpwdWJsaWMgYXN5bmMgbG9hZEdhbWUoKTogUHJvbWlzZSZsdDt2b2lkJmd0OyB7CiAgICAuLi4KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L76-L79"}})],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("loadGame")]),e._v(" replace the storage actions with a fetch from the blockchain:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIGxvYWRHYW1lKCk6IFByb21pc2UmbHQ7dm9pZCZndDsgewogICAgY29uc3QgZ2FtZTogSUdhbWVJbmZvIHwgdW5kZWZpbmVkID0gYXdhaXQgKAogICAgICAgIGF3YWl0IHRoaXMuZ2V0U3RhcmdhdGVDbGllbnQoKQogICAgKS5nZXRHdWlHYW1lKHRoaXMucHJvcHMuaW5kZXgpCiAgICBpZiAoIWdhbWUpIHsKICAgICAgICBhbGVydCgmcXVvdDtHYW1lIGRvZXMgbm90IGV4aXN0JnF1b3Q7KQogICAgICAgIHJldHVybgogICAgfQogICAgdGhpcy5zZXRTdGF0ZSh7CiAgICAgICAgLi4uCiAgICB9KQogICAgLi4uCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L80-L86"}})],1),e._v(" "),a("li",[a("p",[e._v("Adjust the "),a("code",[e._v("setState")]),e._v(" call so that "),a("code",[e._v("isSaved")]),e._v(" is always "),a("code",[e._v("true")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIGxvYWRHYW1lKCk6IFByb21pc2UmbHQ7dm9pZCZndDsgewogICAgLi4uCiAgICB0aGlzLnNldFN0YXRlKHsKICAgICAgICAuLi4KICAgICAgICBpc1NhdmVkOiB0cnVlLAogICAgICAgIC4uLgogICAgfSk7CiAgICAuLi4KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L90"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Here:")]),e._v(" "),a("ul",[a("li",[e._v("You force "),a("code",[e._v("isSaved")]),e._v(" to "),a("code",[e._v("true")]),e._v(" since it is always saved in the blockchain.")]),e._v(" "),a("li",[e._v("Saving "),a("code",[e._v("game.index")]),e._v(" to state is unimportant because it is actually passed in "),a("code",[e._v("IGameContainerProps.index")]),e._v(".")]),e._v(" "),a("li",[e._v("By having a separate "),a("code",[e._v("loadGame")]),e._v(", you can call it again if you know the game has changed.")])])])],1)]),e._v(" "),a("p",[e._v("Restart "),a("code",[e._v("npm start")]),e._v(" and you should now see your game. If you have access to "),a("code",[e._v("checkersd")]),e._v(", or any other way to send a transaction, you can make a move from the command line and refresh to confirm the change. If not, wait for the procedure about playing.")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/show-game-1-move.png"}})],1),e._v(" "),a("h2",{attrs:{id:"integrate-with-keplr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#integrate-with-keplr"}},[e._v("#")]),e._v(" Integrate with Keplr")]),e._v(" "),a("p",[e._v("So far you have "),a("em",[e._v("only")]),e._v(" made it possible to show the state of games and of the blockchain. This allows your users to poke around without unnecessarily asking them to connect. However, to create a game or play in one, you need to make transactions. This is where you need to make integration with Keplr possible.")]),e._v(" "),a("p",[e._v("Install the necessary packages:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucG0gaW5zdGFsbCBAa2VwbHItd2FsbGV0L3R5cGVzQDAuMTAuMiAtLXNhdmUtZXhhY3QgLS1zYXZlLWRldgo="}}),e._v(" "),a("h3",{attrs:{id:"identify-the-checkers-blockchain"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#identify-the-checkers-blockchain"}},[e._v("#")]),e._v(" Identify the Checkers blockchain")]),e._v(" "),a("p",[e._v("Keplr will need information to differentiate your Checkers blockchain from the other chains. Prepare your Checkers blockchain info in a new "),a("code",[e._v("src/types/checkers/chain.ts")]),e._v(" file:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgQ2hhaW5JbmZvIH0gZnJvbSAmcXVvdDtAa2VwbHItd2FsbGV0L3R5cGVzJnF1b3Q7CgpleHBvcnQgY29uc3QgY2hlY2tlcnNDaGFpbklkID0gJnF1b3Q7Y2hlY2tlcnMmcXVvdDsKCmV4cG9ydCBjb25zdCBnZXRDaGVja2Vyc0NoYWluSW5mbyA9ICgpOiBDaGFpbkluZm8gPSZndDsgKHsKICAgIGNoYWluSWQ6IGNoZWNrZXJzQ2hhaW5JZCwKICAgIGNoYWluTmFtZTogY2hlY2tlcnNDaGFpbklkLAogICAgcnBjOiBwcm9jZXNzLmVudi5SUENfVVJMISwKICAgIHJlc3Q6ICZxdW90O2h0dHA6Ly8wLjAuMC4wOjEzMTcmcXVvdDssCiAgICBiaXA0NDogewogICAgICAgIGNvaW5UeXBlOiAxMTgsCiAgICB9LAogICAgYmVjaDMyQ29uZmlnOiB7CiAgICAgICAgYmVjaDMyUHJlZml4QWNjQWRkcjogJnF1b3Q7Y29zbW9zJnF1b3Q7LAogICAgICAgIGJlY2gzMlByZWZpeEFjY1B1YjogJnF1b3Q7Y29zbW9zJnF1b3Q7ICsgJnF1b3Q7cHViJnF1b3Q7LAogICAgICAgIGJlY2gzMlByZWZpeFZhbEFkZHI6ICZxdW90O2Nvc21vcyZxdW90OyArICZxdW90O3ZhbG9wZXImcXVvdDssCiAgICAgICAgYmVjaDMyUHJlZml4VmFsUHViOiAmcXVvdDtjb3Ntb3MmcXVvdDsgKyAmcXVvdDt2YWxvcGVycHViJnF1b3Q7LAogICAgICAgIGJlY2gzMlByZWZpeENvbnNBZGRyOiAmcXVvdDtjb3Ntb3MmcXVvdDsgKyAmcXVvdDt2YWxjb25zJnF1b3Q7LAogICAgICAgIGJlY2gzMlByZWZpeENvbnNQdWI6ICZxdW90O2Nvc21vcyZxdW90OyArICZxdW90O3ZhbGNvbnNwdWImcXVvdDssCiAgICB9LAogICAgY3VycmVuY2llczogWwogICAgICAgIHsKICAgICAgICAgICAgY29pbkRlbm9tOiAmcXVvdDtTVEFLRSZxdW90OywKICAgICAgICAgICAgY29pbk1pbmltYWxEZW5vbTogJnF1b3Q7c3Rha2UmcXVvdDssCiAgICAgICAgICAgIGNvaW5EZWNpbWFsczogMCwKICAgICAgICAgICAgY29pbkdlY2tvSWQ6ICZxdW90O3N0YWtlJnF1b3Q7LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBjb2luRGVub206ICZxdW90O1RPS0VOJnF1b3Q7LAogICAgICAgICAgICBjb2luTWluaW1hbERlbm9tOiAmcXVvdDt0b2tlbiZxdW90OywKICAgICAgICAgICAgY29pbkRlY2ltYWxzOiAwLAogICAgICAgIH0sCiAgICBdLAogICAgZmVlQ3VycmVuY2llczogWwogICAgICAgIHsKICAgICAgICAgICAgY29pbkRlbm9tOiAmcXVvdDtTVEFLRSZxdW90OywKICAgICAgICAgICAgY29pbk1pbmltYWxEZW5vbTogJnF1b3Q7c3Rha2UmcXVvdDssCiAgICAgICAgICAgIGNvaW5EZWNpbWFsczogMCwKICAgICAgICAgICAgY29pbkdlY2tvSWQ6ICZxdW90O3N0YWtlJnF1b3Q7LAogICAgICAgIH0sCiAgICBdLAogICAgc3Rha2VDdXJyZW5jeTogewogICAgICAgIGNvaW5EZW5vbTogJnF1b3Q7U1RBS0UmcXVvdDssCiAgICAgICAgY29pbk1pbmltYWxEZW5vbTogJnF1b3Q7c3Rha2UmcXVvdDssCiAgICAgICAgY29pbkRlY2ltYWxzOiAwLAogICAgICAgIGNvaW5HZWNrb0lkOiAmcXVvdDtzdGFrZSZxdW90OywKICAgIH0sCiAgICBjb2luVHlwZTogMTE4LAogICAgZ2FzUHJpY2VTdGVwOiB7CiAgICAgICAgbG93OiAxLAogICAgICAgIGF2ZXJhZ2U6IDEsCiAgICAgICAgaGlnaDogMSwKICAgIH0sCiAgICBmZWF0dXJlczogWyZxdW90O3N0YXJnYXRlJnF1b3Q7LCAmcXVvdDtpYmMtdHJhbnNmZXImcXVvdDssICZxdW90O25vLWxlZ2FjeS1zdGRUeCZxdW90O10sCn0pCg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/chain.ts"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("The "),a("code",[e._v("chainId")]),e._v(" value has to "),a("strong",[e._v("match exactly")]),e._v(" that returned by "),a("code",[e._v("client.getChainId()")]),e._v(", or the transaction signer will balk. The "),a("code",[e._v("ChainInfo")]),e._v(" object is copied from the one you used for Theta in the "),a("RouterLink",{attrs:{to:"/academy/5-cosmjs/with-keplr.html"}},[e._v("first steps with Keplr")]),e._v(" section.")],1)]),e._v(" "),a("h3",{attrs:{id:"prepare-a-signing-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prepare-a-signing-client"}},[e._v("#")]),e._v(" Prepare a signing client")]),e._v(" "),a("p",[e._v("Just as components that need a "),a("code",[e._v("CheckersStargateClient")]),e._v(" keep one in their state, components that need a "),a("code",[e._v("SigningCheckersStargateClient")]),e._v(" keep one in their state. Some components may have both. The steps to take are the same for each such component.")]),e._v(" "),a("p",[e._v("For instance, in "),a("code",[e._v("src/components/Menu/NewGameModal/NewGameModal.tsx")]),e._v(":")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Add an "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L25",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("rpcUrl: string")]),a("OutboundLink")],1),e._v(" to the props, passed along "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/Menu.tsx#L47",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("Menu.tsx")]),a("OutboundLink")],1),e._v(" which also needs it "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/Menu.tsx#L17",target:"_blank",rel:"noopener noreferrer"}},[e._v("as a new prop"),a("OutboundLink")],1),e._v(", in turn passed from "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/MenuContainer.tsx#L81",target:"_blank",rel:"noopener noreferrer"}},[a("code",[e._v("MenuContainer.tsx")]),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("Add a signing client to the component's state, as well as the potential address of the Keplr user:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW50ZXJmYWNlIElOZXdHYW1lTW9kYWxTdGF0ZSB7CiAgICAuLi4KICAgIGNyZWF0b3I6IHN0cmluZzsKICAgIHNpZ25pbmdDbGllbnQ6IENoZWNrZXJzU2lnbmluZ1N0YXJnYXRlQ2xpZW50IHwgdW5kZWZpbmVkOwp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L29-L30"}}),e._v(" "),a("p",[e._v("Do not forget to initialize them to nothing in the constructor:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"dGhpcy5zdGF0ZSA9IHsKICAgIC4uLgogICAgY3JlYXRvcjogJnF1b3Q7JnF1b3Q7LAogICAgc2lnbmluZ0NsaWVudDogdW5kZWZpbmVkLAp9Owo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L49-L50"}}),e._v(" "),a("p",[e._v("The address of Keplr is saved because it is accessible from the "),a("code",[e._v("OfflineSigner")]),e._v(" but not from the "),a("code",[e._v("SigningStargateClient")]),e._v(".")])],1),e._v(" "),a("li",[a("p",[e._v("Add a tuple type to return both of them:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typecript",base64:"aW50ZXJmYWNlIENyZWF0b3JJbmZvIHsKICAgIGNyZWF0b3I6IHN0cmluZzsKICAgIHNpZ25pbmdDbGllbnQ6IENoZWNrZXJzU2lnbmluZ1N0YXJnYXRlQ2xpZW50Owp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L17-L20"}}),e._v(" "),a("p",[e._v("This is done because the "),a("code",[e._v("setState")]),e._v(" function does not ensure the state is updated immediately after it has been called, so the lazy instantiation method has to return both.")])],1),e._v(" "),a("li",[a("p",[e._v("Inform TypeScript of the "),a("em",[e._v("Keplr "),a("code",[e._v("window")])]),e._v(" object:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgV2luZG93IGFzIEtlcGxyV2luZG93IH0gZnJvbSAmcXVvdDtAa2VwbHItd2FsbGV0L3R5cGVzJnF1b3Q7CgpkZWNsYXJlIGdsb2JhbCB7CiAgICBpbnRlcmZhY2UgV2luZG93IGV4dGVuZHMgS2VwbHJXaW5kb3cge30KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L5-L15"}})],1),e._v(" "),a("li",[a("p",[e._v("Add a function that obtains the signing client and signer's address (a.k.a. future transaction "),a("code",[e._v("creator")]),e._v(") by setting up Keplr and connecting to it:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHJvdGVjdGVkIGFzeW5jIGdldFNpZ25pbmdTdGFyZ2F0ZUNsaWVudCgpOiBQcm9taXNlJmx0O0NyZWF0b3JJbmZvJmd0OyB7CiAgICBpZiAodGhpcy5zdGF0ZS5jcmVhdG9yICZhbXA7JmFtcDsgdGhpcy5zdGF0ZS5zaWduaW5nQ2xpZW50KQogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNyZWF0b3I6IHRoaXMuc3RhdGUuY3JlYXRvciwKICAgICAgICAgICAgc2lnbmluZ0NsaWVudDogdGhpcy5zdGF0ZS5zaWduaW5nQ2xpZW50LAogICAgICAgIH0KICAgIGNvbnN0IHsga2VwbHIgfSA9IHdpbmRvdwogICAgaWYgKCFrZXBscikgewogICAgICAgIGFsZXJ0KCZxdW90O1lvdSBuZWVkIHRvIGluc3RhbGwgS2VwbHImcXVvdDspCiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCZxdW90O1lvdSBuZWVkIHRvIGluc3RhbGwgS2VwbHImcXVvdDspCiAgICB9CiAgICBhd2FpdCBrZXBsci5leHBlcmltZW50YWxTdWdnZXN0Q2hhaW4oZ2V0Q2hlY2tlcnNDaGFpbkluZm8oKSkKICAgIGNvbnN0IG9mZmxpbmVTaWduZXI6IE9mZmxpbmVTaWduZXIgPSBrZXBsci5nZXRPZmZsaW5lU2lnbmVyIShjaGVja2Vyc0NoYWluSWQpCiAgICBjb25zdCBjcmVhdG9yID0gKGF3YWl0IG9mZmxpbmVTaWduZXIuZ2V0QWNjb3VudHMoKSlbMF0uYWRkcmVzcwogICAgY29uc3QgY2xpZW50OiBDaGVja2Vyc1NpZ25pbmdTdGFyZ2F0ZUNsaWVudCA9IGF3YWl0IENoZWNrZXJzU2lnbmluZ1N0YXJnYXRlQ2xpZW50LmNvbm5lY3RXaXRoU2lnbmVyKAogICAgICAgIHRoaXMucHJvcHMucnBjVXJsLAogICAgICAgIG9mZmxpbmVTaWduZXIsCiAgICAgICAgewogICAgICAgICAgICBnYXNQcmljZTogR2FzUHJpY2UuZnJvbVN0cmluZygmcXVvdDsxc3Rha2UmcXVvdDspLAogICAgICAgIH0sCiAgICApCiAgICB0aGlzLnNldFN0YXRlKHsgY3JlYXRvcjogY3JlYXRvciwgc2lnbmluZ0NsaWVudDogY2xpZW50IH0pCiAgICByZXR1cm4geyBjcmVhdG9yOiBjcmVhdG9yLCBzaWduaW5nQ2xpZW50OiBjbGllbnQgfQp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L60-L83"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Setting up Keplr is "),a("a",{attrs:{href:"https://www.merriam-webster.com/dictionary/idempotent#:~:text=Definition%20of%20idempotent,plural%20idempotents",target:"_blank",rel:"noopener noreferrer"}},[e._v("idempotent"),a("OutboundLink")],1),e._v(", so repeating these operations more than once is harmless. You may want to separate these actions into more defined methods at a later optimization stage.\n"),a("br"),a("br"),e._v("\nNote too that a default gas price is passed in, so that you can use "),a("code",[e._v('"auto"')]),e._v(" when sending a transaction.")])])],1)]),e._v(" "),a("p",[e._v("Your component is now ready to send transactions to the blockchain. Why choose "),a("code",[e._v("NewGameModal.tsx")]),e._v(" as the example? Because this is where a new game is created.")]),e._v(" "),a("h2",{attrs:{id:"create-a-new-game"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-new-game"}},[e._v("#")]),e._v(" Create a new game")]),e._v(" "),a("p",[e._v("This modal window pops up when you click on "),a("kbd",[e._v("New Game")]),e._v(":")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/window-create-game.png"}})],1),e._v(" "),a("p",[e._v("The player names look ready-made to take the player's Cosmos addresses.")]),e._v(" "),a("p",[e._v("Examine the code, and focus on "),a("code",[e._v("src/components/Menu/NewGameModal/NewGameModal.tsx")]),e._v(". Thanks to the previous preparation with "),a("code",[e._v("CheckersSigningStargateClient")]),e._v(" it is ready to send transactions:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("In "),a("code",[e._v("extensions-gui.ts")]),e._v(" declare an extension method to your "),a("code",[e._v("CheckersSigningStargateClient")]),e._v(" that encapsulates knowledge about how to get the newly created game index out of the events:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZGVjbGFyZSBtb2R1bGUgJnF1b3Q7Li4vLi4vY2hlY2tlcnNfc2lnbmluZ3N0YXJnYXRlY2xpZW50JnF1b3Q7IHsKICAgIGludGVyZmFjZSBDaGVja2Vyc1NpZ25pbmdTdGFyZ2F0ZUNsaWVudCB7CiAgICAgICAgY3JlYXRlR3VpR2FtZShjcmVhdG9yOiBzdHJpbmcsIGJsYWNrOiBzdHJpbmcsIHJlZDogc3RyaW5nKTogUHJvbWlzZSZsdDtzdHJpbmcmZ3Q7CiAgICB9Cn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L22-L24"}}),e._v(" "),a("p",[e._v("Now define it:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Q2hlY2tlcnNTaWduaW5nU3RhcmdhdGVDbGllbnQucHJvdG90eXBlLmNyZWF0ZUd1aUdhbWUgPSBhc3luYyBmdW5jdGlvbiAoCiAgICBjcmVhdG9yOiBzdHJpbmcsCiAgICBibGFjazogc3RyaW5nLAogICAgcmVkOiBzdHJpbmcsCik6IFByb21pc2UmbHQ7c3RyaW5nJmd0OyB7CiAgICByZXR1cm4gZ2V0Q3JlYXRlZEdhbWVJZChhd2FpdCB0aGlzLmNyZWF0ZUdhbWUoY3JlYXRvciwgYmxhY2ssIHJlZCwgJnF1b3Q7c3Rha2UmcXVvdDssIExvbmcuWkVSTywgJnF1b3Q7YXV0byZxdW90OyksIDApCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L60-L66"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("Keep in mind:")]),e._v(" "),a("ul",[a("li",[e._v("For the sake of simplicity, a possible wager is completely omitted.")]),e._v(" "),a("li",[e._v("The "),a("code",[e._v("getCreatedGameId")]),e._v(" is defined in a "),a("RouterLink",{attrs:{to:"/academy/cosmjs-checkers-sections/cosmjs-messages.html"}},[e._v("previous section")]),e._v(".")],1)])])],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("NewGameModal.tsx")]),e._v(" add an empty import of the extension method so that it is compiled in:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHt9IGZyb20gJnF1b3Q7Li4vLi4vLi4vdHlwZXMvY2hlY2tlcnMvZXh0ZW5zaW9ucy1ndWkmcXVvdDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L6"}})],1),e._v(" "),a("li",[a("p",[e._v("Since you are going to paste addresses into the name field, make sure that the GUI does not truncate them. In "),a("code",[e._v("src/components/Menu/NewGameModal/PlayerNameInput.tsx")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Li4uCm1heExlbmd0aD17NDV9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/PlayerNameInput.tsx#L34"}})],1),e._v(" "),a("li",[a("p",[e._v("Back in "),a("code",[e._v("NewGameModal.tsx")]),e._v(", change the declaration of "),a("code",[e._v("handleSubmit")]),e._v(" and make it "),a("code",[e._v("async")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHJpdmF0ZSBhc3luYyBoYW5kbGVTdWJtaXQoZXZlbnQ6IGFueSk6IFByb21pc2UmbHQ7dm9pZCZndDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L127"}})],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("handleSubmit")]),e._v(", avert the need to save to local storage and call your create game extension method:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgeyBjcmVhdG9yLCBzaWduaW5nQ2xpZW50IH0gPSBhd2FpdCB0aGlzLmdldFNpZ25pbmdTdGFyZ2F0ZUNsaWVudCgpCmNvbnN0IGluZGV4OiBzdHJpbmcgPSBhd2FpdCBzaWduaW5nQ2xpZW50LmNyZWF0ZUd1aUdhbWUoY3JlYXRvciwgcDFOYW1lLCBwMk5hbWUpCg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L155-L156"}})],1),e._v(" "),a("li",[a("p",[e._v("Next send the player directly to the newly created game:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"dGhpcy5wcm9wcy5jbG9zZSgpCndpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKGAvcGxheS8ke2luZGV4fWApCg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L157-L158"}})],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("render()")]),e._v(" change the React link around the "),a("code",[e._v("Button")]),e._v(" to a regular "),a("code",[e._v("div")]),e._v(" so that window redirection appears smooth:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIHJlbmRlcigpIHsKICAgIHJldHVybiAoCiAgICAgICAgLi4uCiAgICAgICAgJmx0O2RpdiBzdHlsZT17dGhpcy5saW5rU3R5bGVzfSBvbkNsaWNrPXt0aGlzLmhhbmRsZVN1Ym1pdH0mZ3Q7CiAgICAgICAgICAgICZsdDtCdXR0b24gY29sb3I9JnF1b3Q7c3VjY2VzcyZxdW90OyBzaXplPSZxdW90O2xnJnF1b3Q7Jmd0OwogICAgICAgICAgICAgICAgUGxheSBHYW1lIQogICAgICAgICAgICAmbHQ7L0J1dHRvbiZndDsKICAgICAgICAmbHQ7L2RpdiZndDsKICAgICAgICAuLi4KICAgICkKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Menu/NewGameModal/NewGameModal.tsx#L114-L118"}})],1)]),e._v(" "),a("p",[e._v("You have now added game creation to your GUI.")]),e._v(" "),a("p",[e._v("If you do not yet know your Keplr address on the Checkers network, you will have to test in two passes. To test properly, you need to:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Run the initialization code by pretending to create a game. This makes Keplr prompt you to accept adding the "),a("code",[e._v("checkers")]),e._v(" network and accessing your account. Accept both, but optionally reject the prompt to accept a transaction if your balance is zero.")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/checkers-add-support.png"}}),a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/checkers-access-address.png"}})],1)]),e._v(" "),a("li",[a("p",[e._v("Select "),a("em",[e._v("Checkers")]),e._v(" in Keplr. Make a note of your address, for instance "),a("code",[e._v("cosmos17excjd99u45c4fkzljwlx8eqyn5dplcujkwag8")]),e._v(".")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/list-keplr-beta-support.png"}})],1)]),e._v(" "),a("li",[a("p",[e._v("Put enough tokens in your Keplr "),a("em",[e._v("Checkers")]),e._v(" account. "),a("code",[e._v('"1000000stake"')]),e._v(" will satisfy by a 10x margin.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("If you have access to "),a("code",[e._v("checkersd")]),e._v(" built by Ignite CLI, use this command:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBleHBvcnQgYWxpY2U9JChjaGVja2Vyc2Qga2V5cyBzaG93IGFsaWNlIC1hKQokIGNoZWNrZXJzZCB0eCBiYW5rIHNlbmQgJGFsaWNlICZxdW90O2Nvc21vczE3ZXhjamQ5OXU0NWM0Zmt6bGp3bHg4ZXF5bjVkcGxjdWprd2FnOCZxdW90OyAxMDAwMDAwc3Rha2UgLXkK"}})],1),e._v(" "),a("li",[a("p",[e._v("If you do not have access to "),a("code",[e._v("checkersd")]),e._v(", look for instructions on how to start your locally-running Checkers or tap the faucet of a public Checkers test net.")])])])]),e._v(" "),a("li",[a("p",[e._v("Now start again to actually create a game. Accept the transaction, and you are redirected to the game page. This time the content of the game is from the blockchain.")])])]),e._v(" "),a("h2",{attrs:{id:"play-a-move"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#play-a-move"}},[e._v("#")]),e._v(" Play a move")]),e._v(" "),a("p",[e._v("In the "),a("code",[e._v("GameContainer.tsx")]),e._v(" there are "),a("code",[e._v("makeMove")]),e._v(" and "),a("code",[e._v("saveGame")]),e._v(" functions. In a blockchain context, "),a("code",[e._v("saveGame")]),e._v(" is irrelevant, as on each move done with a transaction the game will be automatically "),a("em",[e._v("saved")]),e._v(" in the blockchain.")]),e._v(" "),a("p",[e._v("Add a "),a("code",[e._v("console.log")]),e._v(" to  "),a("code",[e._v("makeMove")]),e._v(" to demonstrate the format it uses:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgbW92ZTogUG9zaXRpb25bXSA9IGtleXMubWFwKChrOiBzdHJpbmcpOiBQb3NpdGlvbiA9Jmd0OyBrLnNwbGl0KCZxdW90OywmcXVvdDspLm1hcChOdW1iZXIpIGFzIFBvc2l0aW9uKQpjb25zb2xlLmxvZyhtb3ZlKQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L210"}}),e._v(" "),a("p",[e._v("Now play a move with the current interface. Move your first black piece:")]),e._v(" "),a("p",[a("tm-image",{attrs:{src:"/academy/3-my-own-chain/images/black-moves-first-piece.png"}})],1),e._v(" "),a("p",[e._v("In the blockchain code, this is "),a("code",[e._v("fromX: 1, fromY: 2, toX: 2, toY: 3")]),e._v(". However, the GUI prints:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"WyBbIDIsIDEgXSwgWyAzLCAyIF0gXQo="}}),e._v(" "),a("p",[e._v("Evidently for each position X and Y are flipped. You can encapsulate this knowledge in a helper function:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGZ1bmN0aW9uIGd1aU1vdmVUb1Bvcyhtb3ZlOiBudW1iZXJbXSk6IFBvcyB7CiAgICByZXR1cm4geyB4OiBtb3ZlWzFdLCB5OiBtb3ZlWzBdIH07Cn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/board.ts#L45-L47"}}),e._v(" "),a("p",[e._v("This is likely a familiar situation. Do some more preparation:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("In "),a("code",[e._v("extensions-gui.ts")]),e._v(" declare an extension method to "),a("code",[e._v("CheckersStargateClient")]),e._v(" to check whether the move is valid, with parameters as they are given in the GUI components:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZGVjbGFyZSBtb2R1bGUgJnF1b3Q7Li4vLi4vY2hlY2tlcnNfc3RhcmdhdGVjbGllbnQmcXVvdDsgewogICAgaW50ZXJmYWNlIENoZWNrZXJzU3RhcmdhdGVDbGllbnQgewogICAgICAgIC4uLgogICAgICAgIGNhblBsYXlHdWlNb3ZlKAogICAgICAgICAgICBnYW1lSW5kZXg6IHN0cmluZywKICAgICAgICAgICAgcGxheWVySWQ6IG51bWJlciwKICAgICAgICAgICAgbW92ZTogbnVtYmVyW11bXSwKICAgICAgICApOiBQcm9taXNlJmx0O1F1ZXJ5Q2FuUGxheU1vdmVSZXNwb25zZSZndDsKICAgIH0KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/board.ts#L45-L47"}}),e._v(" "),a("p",[e._v("Now define it:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Q2hlY2tlcnNTdGFyZ2F0ZUNsaWVudC5wcm90b3R5cGUuY2FuUGxheUd1aU1vdmUgPSBhc3luYyBmdW5jdGlvbiAoCiAgICBnYW1lSW5kZXg6IHN0cmluZywKICAgIHBsYXllcklkOiBudW1iZXIsCiAgICBtb3ZlOiBudW1iZXJbXVtdLAopOiBQcm9taXNlJmx0O1F1ZXJ5Q2FuUGxheU1vdmVSZXNwb25zZSZndDsgewogICAgaWYgKHBsYXllcklkICZsdDsgMSB8fCAyICZsdDsgcGxheWVySWQpIHRocm93IG5ldyBFcnJvcihgV3JvbmcgcGxheWVySWQ6ICR7cGxheWVySWR9YCkKICAgIHJldHVybiBhd2FpdCB0aGlzLmNoZWNrZXJzUXVlcnlDbGllbnQhLmNoZWNrZXJzLmNhblBsYXlNb3ZlKAogICAgICAgIGdhbWVJbmRleCwKICAgICAgICBwbGF5ZXJJZCA9PT0gMSA/ICZxdW90O2ImcXVvdDsgOiAmcXVvdDtyJnF1b3Q7LAogICAgICAgIGd1aU1vdmVUb1Bvcyhtb3ZlWzBdKSwKICAgICAgICBndWlNb3ZlVG9Qb3MobW92ZVsxXSksCiAgICApCn0K",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L46-L58"}})],1),e._v(" "),a("li",[a("p",[e._v("Declare another extension method, this time for "),a("code",[e._v("CheckersSigningStargateClient")]),e._v(", to actually make the move with parameters as they are given in the GUI components:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZGVjbGFyZSBtb2R1bGUgJnF1b3Q7Li4vLi4vY2hlY2tlcnNfc2lnbmluZ3N0YXJnYXRlY2xpZW50JnF1b3Q7IHsKICAgIGludGVyZmFjZSBDaGVja2Vyc1NpZ25pbmdTdGFyZ2F0ZUNsaWVudCB7CiAgICAgICAgLi4uCiAgICAgICAgcGxheUd1aU1vdmUoY3JlYXRvcjogc3RyaW5nLCBnYW1lSW5kZXg6IHN0cmluZywgbW92ZTogbnVtYmVyW11bXSk6IFByb21pc2UmbHQ7dm9pZCZndDsKICAgIH0KfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L25"}}),e._v(" "),a("p",[e._v("Now define it:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Q2hlY2tlcnNTaWduaW5nU3RhcmdhdGVDbGllbnQucHJvdG90eXBlLnBsYXlHdWlNb3ZlID0gYXN5bmMgZnVuY3Rpb24gKAogICAgY3JlYXRvcjogc3RyaW5nLAogICAgZ2FtZUluZGV4OiBzdHJpbmcsCiAgICBtb3ZlOiBudW1iZXJbXVtdLAopOiBQcm9taXNlJmx0O3ZvaWQmZ3Q7IHsKICAgIGF3YWl0IHRoaXMucGxheU1vdmUoY3JlYXRvciwgZ2FtZUluZGV4LCBndWlNb3ZlVG9Qb3MobW92ZVswXSksIGd1aU1vdmVUb1Bvcyhtb3ZlWzFdKSwgJnF1b3Q7YXV0byZxdW90OykKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/types/checkers/extensions-gui.ts#L68-L74"}})],1)]),e._v(" "),a("p",[e._v("With this done:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Repeat in "),a("code",[e._v("GameContainer")]),e._v(" what you did in "),a("code",[e._v("NewGameModal")]),e._v(":")]),e._v(" "),a("ol",[a("li",[e._v("Keep a "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L39-L40",target:"_blank",rel:"noopener noreferrer"}},[e._v("signing client and "),a("code",[e._v("creator")]),a("OutboundLink")],1),e._v(" in the component's state.")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L62-L63",target:"_blank",rel:"noopener noreferrer"}},[e._v("Initialize"),a("OutboundLink")],1),e._v(" it in the constructor.")]),e._v(" "),a("li",[e._v("Add "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L16-L19",target:"_blank",rel:"noopener noreferrer"}},[e._v("a tuple"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("li",[e._v("Add a method to "),a("a",{attrs:{href:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L121-L144",target:"_blank",rel:"noopener noreferrer"}},[e._v("lazily instantiate it"),a("OutboundLink")],1),e._v(".")])])]),e._v(" "),a("li",[a("p",[e._v("Change the declaration of "),a("code",[e._v("makeMove")]),e._v(" to make it "),a("code",[e._v("async")]),e._v(":")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"cHVibGljIGFzeW5jIG1ha2VNb3ZlKCk6IFByb21pc2UmbHQ7dm9pZCZndDsK",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L201"}})],1),e._v(" "),a("li",[a("p",[e._v("In "),a("code",[e._v("makeMove")]),e._v(" make sure that the move is likely to be accepted immediately after the existing code that extracts the move. It uses the read-only "),a("code",[e._v("StargateClient")]),e._v(", which allows players to look around without being asked to disclose their address:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgbW92ZTogUG9zaXRpb25bXSA9IGtleXMubWFwKChrOiBzdHJpbmcpOiBQb3NpdGlvbiA9Jmd0OyBrLnNwbGl0KCZxdW90OywmcXVvdDspLm1hcChOdW1iZXIpIGFzIFBvc2l0aW9uKQoKY29uc3QgY2xpZW50ID0gYXdhaXQgdGhpcy5nZXRTdGFyZ2F0ZUNsaWVudCgpCmNvbnN0IGNhblBsYXlPck5vdCA9IGF3YWl0IGNsaWVudC5jYW5QbGF5R3VpTW92ZSgKICAgIHRoaXMucHJvcHMuaW5kZXgsCiAgICB0aGlzLnN0YXRlLmJvYXJkLmN1cnJlbnRfcGxheWVyLAogICAgbW92ZSwKKQppZiAoIWNhblBsYXlPck5vdC5wb3NzaWJsZSkgewogICAgY29uc3QgZXJyb3IgPSBgQ2Fubm90IG1ha2UgdGhpcyBtb3ZlICR7Y2FuUGxheU9yTm90LnJlYXNvbn1gCiAgICBhbGVydChlcnJvcikKICAgIHRocm93IG5ldyBFcnJvcihlcnJvcikKfQo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L210-L222"}})],1),e._v(" "),a("li",[a("p",[e._v("With this partial assurance, you can make an actual move:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgeyBjcmVhdG9yLCBzaWduaW5nQ2xpZW50IH0gPSBhd2FpdCB0aGlzLmdldFNpZ25pbmdTdGFyZ2F0ZUNsaWVudCgpCnRyeSB7CiAgICBhd2FpdCBzaWduaW5nQ2xpZW50LnBsYXlHdWlNb3ZlKGNyZWF0b3IsIHRoaXMucHJvcHMuaW5kZXgsIG1vdmUpCn0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoZSkKICAgIGFsZXJ0KCZxdW90O0ZhaWxlZCB0byBwbGF5OiAmcXVvdDsgKyBlKQp9Cg==",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L224-L230"}}),e._v(" "),a("HighlightBox",{attrs:{type:"note"}},[a("p",[e._v("The assurance is "),a("strong",[e._v("partial")]),e._v(" because what was tested with "),a("code",[e._v("canPlayGuiMove")]),e._v(" is whether a player of a certain color can make a move or not. When making the move, it takes the Keplr address without cross-checking whether this is indeed the address of the colored player that tested a move. This "),a("strong",[e._v("could be improved")]),e._v(" either at the cost of another call to get the game, or better by adding the black and red addresses in the component's status.")])]),e._v(" "),a("p",[e._v("The remaining code of the "),a("code",[e._v("makeMove")]),e._v(" method can be deleted.")])],1),e._v(" "),a("li",[a("p",[e._v("Finish with a reload of the game to show its new state:")]),e._v(" "),a("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3Qgc2VsZWN0ZWQgPSBPYmplY3QuY3JlYXRlKG51bGwpCnRoaXMuc2V0U3RhdGUoeyBzZWxlY3RlZCB9KQpyZXR1cm4gdGhpcy5sb2FkR2FtZSgpOwo=",url:"https://github.com/cosmos/academy-checkers-ui/blob/f6a96b7/src/components/Game/GameContainer.tsx#L231-L233"}}),e._v(" "),a("HighlightBox",{attrs:{type:"tip"}},[a("p",[e._v("There is a potentially hard-to-reproduce-in-production "),a("strong",[e._v("race condition")]),e._v(" bug here. The "),a("code",[e._v("loadGame")]),e._v(" is done immediately after the transaction has completed. However, depending on the implementation of the RPC end point, the "),a("code",[e._v("playGuiMove")]),e._v(" and "),a("code",[e._v("loadGame")]),e._v(" calls may hit two different servers on the backend. In some instances, the server that answers your "),a("code",[e._v("loadGame")]),e._v(" may not have fully updated its store and may in fact serve you the "),a("strong",[e._v("old")]),e._v(" version of your game.\n"),a("br"),a("br"),e._v("\nAs your GUI matures, you may want to show the "),a("em",[e._v("expected")]),e._v(" state of the game before you eventually show its "),a("em",[e._v("finalized")]),e._v(" state. Sometimes you may want to show the expected state of the game even before the transaction has completed, and add visual cues hinting at the fact it is a "),a("strong",[e._v("provisional")]),e._v(" state.\n"),a("br"),a("br"),e._v("\nThe same can happen when creating a game, where the second server may return "),a("code",[e._v("null")]),e._v(" if it has not been updated yet.")])])],1)]),e._v(" "),a("p",[e._v("Now you can play test in the GUI. Make sure to put your Keplr address as the black player, so that you start with this one. You will need a second account on Keplr with which to play red, otherwise you must play red from the command line. Alternatively, put the same Keplr address for both black and red.")]),e._v(" "),a("p",[e._v("Either way, it is now possible to play the game from the GUI. Congratulations!")]),e._v(" "),a("h2",{attrs:{id:"further-exercise-ideas"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#further-exercise-ideas"}},[e._v("#")]),e._v(" Further exercise ideas")]),e._v(" "),a("ul",[a("li",[e._v("Use the "),a("kbd",[e._v("Quit Game")]),e._v(" button to handle a reject.")]),e._v(" "),a("li",[e._v("Add pagination to the game list.")]),e._v(" "),a("li",[e._v("Implement typical GUI features, like disabling buttons when their action should be unavailable, or adding a countdown to the forfeit deadline.")]),e._v(" "),a("li",[e._v("Implement a Web socket to listen to changes. That would be useful when there are two players who cannot communicate otherwise (instead of polling).")]),e._v(" "),a("li",[e._v("When a double capture (or more) is possible, the GUI allows you to make multiple moves at once (with "),a("code",[e._v("move.length >= 2")]),e._v("). However, the code handles only a single hop ("),a("code",[e._v("move[0]")]),e._v(" and "),a("code",[e._v("move[1]")]),e._v("). It is technically possible to pack more than one "),a("code",[e._v("PlayMove")]),e._v(" message in a single transaction, saving the player from sending multiple transactions.")])]),e._v(" "),a("h2",{attrs:{id:"next-up"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#next-up"}},[e._v("#")]),e._v(" Next up")]),e._v(" "),a("p",[e._v("In the "),a("RouterLink",{attrs:{to:"/academy/cosmjs-checkers-sections/server-side.html"}},[e._v("next section")]),e._v(", explore how server-side scripts can help you improve the user experience of your application.")],1)],1)}),[],!1,null,null,null);t.default=s.exports}}]);