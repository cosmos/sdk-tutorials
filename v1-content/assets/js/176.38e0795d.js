(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{795:function(e,t,s){"use strict";s.r(t);var o=s(1),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"your-first-cosmjs-actions-send-tokens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#your-first-cosmjs-actions-send-tokens"}},[e._v("#")]),e._v(" Your First CosmJS Actions - Send Tokens")]),e._v(" "),s("HighlightBox",{attrs:{type:"learning"}},[s("p",[e._v("Take your first steps with CosmJS. Use it to send some simple transactions.\n"),s("br"),s("br"),e._v("\nIn this section, you will:")]),e._v(" "),s("ul",[s("li",[e._v("Download and install CosmJS.")]),e._v(" "),s("li",[e._v("Create a small experiment.")]),e._v(" "),s("li",[e._v("Prepare a simple testnet.")]),e._v(" "),s("li",[e._v("Establish your connection.")]),e._v(" "),s("li",[e._v("Inspect a balance.")]),e._v(" "),s("li",[e._v("Send transactions.")])])]),e._v(" "),s("p",[e._v("Now that you know what CosmJS is, you should take your first steps in using it. A basic feature of a Cosmos chain is the ability to send tokens via the "),s("code",[e._v("bank")]),e._v(" module. CosmJS naturally offers functions to cover this facility. You are going to:")]),e._v(" "),s("ol",[s("li",[e._v("Use an existing test network (testnet) with a key of your own.")]),e._v(" "),s("li",[e._v("Run basic CosmJS commands in a script that you run using the CLI.")])]),e._v(" "),s("p",[e._v("Additionally, you can choose to:")]),e._v(" "),s("ol",[s("li",[e._v("Start a local chain that exposes RPCs instead of using a testnet.")]),e._v(" "),s("li",[e._v("Run the same basic CosmJS commands, but for this local chain.")])]),e._v(" "),s("p",[e._v("Along the way, you learn the basic CosmJS concepts needed to start interacting with the Cosmos ecosystem.")]),e._v(" "),s("h2",{attrs:{id:"script-preparation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#script-preparation"}},[e._v("#")]),e._v(" Script preparation")]),e._v(" "),s("p",[e._v("A small, ready-made repository exists so you can experiment with CosmJS. Clone it from "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(". You need "),s("a",{attrs:{href:"https://nodejs.org/en/download/",target:"_blank",rel:"noopener noreferrer"}},[e._v("NodeJs"),s("OutboundLink")],1),e._v(". If you open the folder in "),s("a",{attrs:{href:"https://code.visualstudio.com/Download",target:"_blank",rel:"noopener noreferrer"}},[e._v("Visual Studio Code"),s("OutboundLink")],1),e._v(", the IDE should give you all the coding help you require. In the cloned folder you need to install the required modules:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucG0gaW5zdGFsbAo="}}),e._v(" "),s("p",[e._v("Create a new file named "),s("code",[e._v("experiment.ts")]),e._v(". In it, put these lines to confirm it works:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgcnVuQWxsID0gYXN5bmMoKTogUHJvbWlzZSZsdDt2b2lkJmd0OyA9Jmd0OyB7CiAgICBjb25zb2xlLmxvZygmcXVvdDtUT0RPJnF1b3Q7KQp9CgpydW5BbGwoKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/3fe8942/experiment.ts#L1-L5"}}),e._v(" "),s("p",[e._v("To execute, this TypeScript file needs to be compiled into JavaScript before being interpreted by NodeJs. Add this as a run target in "),s("code",[e._v("package.json")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"Li4uCiAgICAmcXVvdDtzY3JpcHRzJnF1b3Q7OiB7CiAgICAgICAgLi4uCiAgICAgICAgJnF1b3Q7ZXhwZXJpbWVudCZxdW90OzogJnF1b3Q7dHMtbm9kZSBleHBlcmltZW50LnRzJnF1b3Q7CiAgICB9Ci4uLgo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/3fe8942/package.json#L7"}}),e._v(" "),s("p",[e._v("Confirm that it does what you want:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucG0gcnVuIGV4cGVyaW1lbnQK"}}),e._v(" "),s("p",[e._v("This returns:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"Jmd0OyBjb3NtanMtc2FuZGJveEAxLjAuMCBleHBlcmltZW50CiZndDsgdHMtbm9kZSBleHBlcmltZW50LnRzCgpUT0RPCg=="}}),e._v(" "),s("p",[e._v("You soon make this script more meaningful. With the basic script ready, you need to prepare some elements.")]),e._v(" "),s("h2",{attrs:{id:"testnet-preparation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#testnet-preparation"}},[e._v("#")]),e._v(" Testnet preparation")]),e._v(" "),s("p",[e._v("The Cosmos Ecosystem has a number of testnets running. The Cosmos Hub is currently running a "),s("a",{attrs:{href:"https://github.com/cosmos/testnets/tree/master/v7-theta#theta-public-testnet",target:"_blank",rel:"noopener noreferrer"}},[e._v("public testnet"),s("OutboundLink")],1),e._v(" for the Theta upgrade that you are connecting to and running your script on. You need to connect to a public node so that you can query information and broadcast transactions. One of the available nodes is:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"https",base64:"UlBDOiBodHRwczovL3JwYy5zZW50cnktMDEudGhldGEtdGVzdG5ldC5wb2x5cG9yZS54eXoK",url:"https://github.com/cosmos/testnets/tree/master/v7-theta#endpoints-1"}}),e._v(" "),s("p",[e._v("You need a wallet address on the testnet and you must create a 24-word mnemonic in order to do so. CosmJS can generate one for you. Create a new file "),s("code",[e._v("generate_mnemonic.ts")]),e._v(" with the following script:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgRGlyZWN0U2VjcDI1NmsxSGRXYWxsZXQgfSBmcm9tICZxdW90O0Bjb3NtanMvcHJvdG8tc2lnbmluZyZxdW90OwoKY29uc3QgZ2VuZXJhdGVLZXkgPSBhc3luYyAoKTogUHJvbWlzZSZsdDt2b2lkJmd0OyA9Jmd0OyB7CiAgICBjb25zdCB3YWxsZXQ6IERpcmVjdFNlY3AyNTZrMUhkV2FsbGV0ID0gYXdhaXQgRGlyZWN0U2VjcDI1NmsxSGRXYWxsZXQuZ2VuZXJhdGUoMjQpCiAgICBwcm9jZXNzLnN0ZG91dC53cml0ZSh3YWxsZXQubW5lbW9uaWMpCiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IHdhbGxldC5nZXRBY2NvdW50cygpCiAgICBjb25zb2xlLmVycm9yKCZxdW90O01uZW1vbmljIHdpdGggMXN0IGFjY291bnQ6JnF1b3Q7LCBhY2NvdW50c1swXS5hZGRyZXNzKQp9CgpnZW5lcmF0ZUtleSgpCg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/generate_mnemonic.ts#L1-L10"}}),e._v(" "),s("p",[e._v("Now create a "),s("strong",[e._v("key")]),e._v(" for our imaginary user "),s("strong",[e._v("Alice")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucHggdHMtbm9kZSBnZW5lcmF0ZV9tbmVtb25pYy50cyAmZ3Q7IHRlc3RuZXQuYWxpY2UubW5lbW9uaWMua2V5Cg=="}}),e._v(" "),s("p",[e._v("When done, it should also tell you the address of the first account:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"TW5lbW9uaWMgd2l0aCAxc3QgYWNjb3VudDogY29zbW9zMTd0dmQ0aGNzenE3bGN4dXd6cnFrZXB1YXU5ZnllM2RhbDYwNnpmCg=="}}),e._v(" "),s("p",[e._v("Temporarily keep this address for convenience, although CosmJS can always recalculate it from the mnemonic. Privately examine the file to confirm it contains your 24 words.")]),e._v(" "),s("HighlightBox",{attrs:{type:"warn"}},[s("p",[e._v("Important considerations:")]),e._v(" "),s("ol",[s("li",[s("p",[s("code",[e._v("process.stdout.write")]),e._v(" was used to avoid any line return. Be careful not to add any empty lines or any other character in your "),s("code",[e._v(".key")]),e._v(" file (this occurs with VSCode under certain conditions). If you add any characters, ComsJs may not be able to parse it.")])]),e._v(" "),s("li",[s("p",[e._v("Adjust the "),s("code",[e._v(".gitignore")]),e._v(" file to not commit your "),s("code",[e._v(".key")]),e._v(" file by mistake:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"https",base64:"bm9kZV9tb2R1bGVzCioua2V5Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/.gitignore#L2"}})],1)])]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("For your convenience, we have a branch available "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/tree/file-preparation",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(" that contains all the code and files you've added so far.")])]),e._v(" "),s("h2",{attrs:{id:"add-your-imports"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add-your-imports"}},[e._v("#")]),e._v(" Add your imports")]),e._v(" "),s("p",[e._v("You need a small, simple interface to a blockchain, one which could eventually have users. Good practice is to refrain from requesting a user address until necessary (e.g. when a user clicks a relevant button). Therefore, in "),s("code",[e._v("experiment.ts")]),e._v(" you first use the read-only client. Import it at the top of the file:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgU3RhcmdhdGVDbGllbnQgfSBmcm9tICZxdW90O0Bjb3NtanMvc3RhcmdhdGUmcXVvdDsK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L1"}}),e._v(" "),s("HighlightBox",{attrs:{type:"info"}},[s("p",[e._v("Note that VSCode assists you to auto-complete "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/stargateclient.ts#L139",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("StargateClient")]),s("OutboundLink")],1),e._v(" if you type "),s("kbd",[e._v("CTRL-Space")]),e._v(" inside the "),s("code",[e._v("{}")]),e._v(" of the "),s("code",[e._v("import")]),e._v(" line.")])]),e._v(" "),s("h2",{attrs:{id:"define-your-connection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#define-your-connection"}},[e._v("#")]),e._v(" Define your connection")]),e._v(" "),s("p",[e._v("Next, you need to tell the client how to connect to the RPC port of your blockchain:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgcnBjID0gJnF1b3Q7aHR0cHM6Ly9ycGMuc2VudHJ5LTAxLnRoZXRhLXRlc3RuZXQucG9seXBvcmUueHl6JnF1b3Q7Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L5"}}),e._v(" "),s("p",[e._v("Inside the "),s("code",[e._v("runAll")]),e._v(" function you "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/stargateclient.ts#L146",target:"_blank",rel:"noopener noreferrer"}},[e._v("initialize the connection"),s("OutboundLink")],1),e._v(" and immediately "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/stargateclient.ts#L194",target:"_blank",rel:"noopener noreferrer"}},[e._v("check"),s("OutboundLink")],1),e._v(" you connected to the right place:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgcnVuQWxsID0gYXN5bmMoKTogUHJvbWlzZSZsdDt2b2lkJmd0OyA9Jmd0OyB7CiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBTdGFyZ2F0ZUNsaWVudC5jb25uZWN0KHJwYykKICAgIGNvbnNvbGUubG9nKCZxdW90O1dpdGggY2xpZW50LCBjaGFpbiBpZDomcXVvdDssIGF3YWl0IGNsaWVudC5nZXRDaGFpbklkKCksICZxdW90OywgaGVpZ2h0OiZxdW90OywgYXdhaXQgY2xpZW50LmdldEhlaWdodCgpKQp9Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L8-L9"}}),e._v(" "),s("p",[e._v("Run again to check with "),s("code",[e._v("npm run experiment")]),e._v(", and you get:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"V2l0aCBjbGllbnQsIGNoYWluIGlkOiB0aGV0YS10ZXN0bmV0LTAwMSAsIGhlaWdodDogOTUwNzAzMgo="}}),e._v(" "),s("h2",{attrs:{id:"get-a-balance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-a-balance"}},[e._v("#")]),e._v(" Get a balance")]),e._v(" "),s("p",[e._v("Normally you would not yet have access to your user's address. However, for this exercise you need to know how many tokens Alice has, so add a temporary new command inside "),s("code",[e._v("runAll")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coCiAgICAmcXVvdDtBbGljZSBiYWxhbmNlczomcXVvdDssCiAgICBhd2FpdCBjbGllbnQuZ2V0QWxsQmFsYW5jZXMoJnF1b3Q7Y29zbW9zMTd0dmQ0aGNzenE3bGN4dXd6cnFrZXB1YXU5ZnllM2RhbDYwNnpmJnF1b3Q7KSwKKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L10-L13"}}),e._v(" "),s("p",[s("code",[e._v("getAllBalances")]),e._v(" is used because the default token name is not yet known. When you run it again, you get:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"QWxpY2UgYmFsYW5jZXM6IFtdCg=="}}),e._v(" "),s("p",[e._v("If you just created this account, Alice's balance is zero. Alice needs tokens to be able to send transactions and participate in the network. A common practice with testnets is to expose "),s("strong",[e._v("faucets")]),e._v(" (services that send you test tokens for free, within limits).")]),e._v(" "),s("p",[e._v("The Cosmos Hub Testnet faucet has a dedicated "),s("a",{attrs:{href:"https://discord.com/channels/669268347736686612/953697793476821092/958291295741313024",target:"_blank",rel:"noopener noreferrer"}},[e._v("Discord channel"),s("OutboundLink")],1),e._v(" where you can ask for tokens once per day "),s("em",[e._v("per Discord user")]),e._v(".")]),e._v(" "),s("p",[e._v("Go to the faucet channel and request tokens for Alice by entering this command in the channel:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"JHJlcXVlc3QgW0FsaWNlJ3MgYWRkcmVzc10gdGhldGEKCi8vIEZvciBleGFtcGxlOgokcmVxdWVzdCBjb3Ntb3MxN3R2ZDRoY3N6cTdsY3h1d3pycWtlcHVhdTlmeWUzZGFsNjA2emYgdGhldGEK"}}),e._v(" "),s("p",[e._v("The faucet bot replies with a link to the transaction from the block explorer:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"4pyFICBodHRwczovL2V4cGxvcmVyLnRoZXRhLXRlc3RuZXQucG9seXBvcmUueHl6L3RyYW5zYWN0aW9ucy81NDA0ODRCREQzNDI3MDJGMTk2Rjg0QzJGRDQyRDYzRkE3N0Y3NEIyNkE4RDczODNGQUE1QUI0NkU0MTE0QTlCCg=="}}),e._v(" "),s("p",[e._v("Check that Alice received the tokens with "),s("code",[e._v("npm run experiment")]),e._v(", which should return:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"QWxpY2UgYmFsYW5jZXM6IFsgeyBkZW5vbTogJ3VhdG9tJywgYW1vdW50OiAnMTAwMDAwMDAnIH0gXQo="}}),e._v(" "),s("p",[s("code",[e._v("uatom")]),e._v(" is the indivisible token unit on the Testnet. It is short for micro-ATOM, or µ-ATOM. So 10 million "),s("code",[e._v("uatom")]),e._v(" equal 10 ATOM. After this confirmation you can comment out the balance query.")]),e._v(" "),s("h2",{attrs:{id:"get-the-faucet-address"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-the-faucet-address"}},[e._v("#")]),e._v(" Get the faucet address")]),e._v(" "),s("p",[e._v("As an exercise you want Alice to send some tokens back to the faucet, so you need its address. You can request this from the faucet bot, but it is also possible to get it using the transaction hash in "),s("code",[e._v("experiment.ts")]),e._v(".")]),e._v(" "),s("p",[e._v("First you need to get the transaction.")]),e._v(" "),s("p",[e._v("Add the necessary import at the top:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgSW5kZXhlZFR4LCBTdGFyZ2F0ZUNsaWVudCB9IGZyb20gJnF1b3Q7QGNvc21qcy9zdGFyZ2F0ZSZxdW90Owo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L1"}}),e._v(" "),s("p",[e._v("Then, make sure you replace the hash with the one you received from the faucet bot.")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZmF1Y2V0VHg6IEluZGV4ZWRUeCA9IChhd2FpdCBjbGllbnQuZ2V0VHgoCiAgICAmcXVvdDs1NDA0ODRCREQzNDI3MDJGMTk2Rjg0QzJGRDQyRDYzRkE3N0Y3NEIyNkE4RDczODNGQUE1QUI0NkU0MTE0QTlCJnF1b3Q7LAopKSEK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L14-L16"}}),e._v(" "),s("h3",{attrs:{id:"deserialize-the-transaction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deserialize-the-transaction"}},[e._v("#")]),e._v(" Deserialize the transaction")]),e._v(" "),s("p",[e._v("What does "),s("code",[e._v("faucetTx")]),e._v(" contain? Add the following line to find out:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coJnF1b3Q7RmF1Y2V0IFR4OiZxdW90OywgZmF1Y2V0VHgpCg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L17"}}),e._v(" "),s("p",[e._v("Then run the script again using "),s("code",[e._v("npm run experiment")]),e._v(". You find the following output, which in your case contains different values:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"RmF1Y2V0IFR4OiB7CiAgaGVpZ2h0OiA5NDg3Nzg1LAogIGhhc2g6ICc1NDA0ODRCREQzNDI3MDJGMTk2Rjg0QzJGRDQyRDYzRkE3N0Y3NEIyNkE4RDczODNGQUE1QUI0NkU0MTE0QTlCJywKICBjb2RlOiAwLAogIHJhd0xvZzogJ1t7JnF1b3Q7ZXZlbnRzJnF1b3Q7Olt7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDtjb2luX3JlY2VpdmVkJnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7cmVjZWl2ZXImcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7Y29zbW9zMTd0dmQ0aGNzenE3bGN4dXd6cnFrZXB1YXU5ZnllM2RhbDYwNnpmJnF1b3Q7fSx7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O2Ftb3VudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDsxMDAwMDAwMHVhdG9tJnF1b3Q7fV19LHsmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O2NvaW5fc3BlbnQmcXVvdDssJnF1b3Q7YXR0cmlidXRlcyZxdW90OzpbeyZxdW90O2tleSZxdW90OzomcXVvdDtzcGVuZGVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczE1YXB0ZHFtbTdkZGd0Y3JqdmM1aHM5ODhybHJremU0MGw0cTBoZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDthbW91bnQmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7MTAwMDAwMDB1YXRvbSZxdW90O31dfSx7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDttZXNzYWdlJnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7YWN0aW9uJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90Oy9jb3Ntb3MuYmFuay52MWJldGExLk1zZ1NlbmQmcXVvdDt9LHsmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7c2VuZGVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczE1YXB0ZHFtbTdkZGd0Y3JqdmM1aHM5ODhybHJremU0MGw0cTBoZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDttb2R1bGUmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7YmFuayZxdW90O31dfSx7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDt0cmFuc2ZlciZxdW90OywmcXVvdDthdHRyaWJ1dGVzJnF1b3Q7Olt7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O3JlY2lwaWVudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDtjb3Ntb3MxN3R2ZDRoY3N6cTdsY3h1d3pycWtlcHVhdTlmeWUzZGFsNjA2emYmcXVvdDt9LHsmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7c2VuZGVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczE1YXB0ZHFtbTdkZGd0Y3JqdmM1aHM5ODhybHJremU0MGw0cTBoZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDthbW91bnQmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7MTAwMDAwMDB1YXRvbSZxdW90O31dfV19XScsCiAgdHg6IFVpbnQ4QXJyYXkoMzIxKSBbCiAgICAgMTAsIDE0OCwgICAxLCAgMTAsIDE0NSwgICAxLCAgMTAsICAyOCwgIDQ3LCAgOTksIDExMSwgMTE1LAogICAgMTA5LCAxMTEsIDExNSwgIDQ2LCAgOTgsICA5NywgMTEwLCAxMDcsICA0NiwgMTE4LCAgNDksICA5OCwKICAgIDEwMSwgMTE2LCAgOTcsICA0OSwgIDQ2LCAgNzcsIDExNSwgMTAzLCAgODMsIDEwMSwgMTEwLCAxMDAsCiAgICAgMTgsIDExMywgIDEwLCAgNDUsICA5OSwgMTExLCAxMTUsIDEwOSwgMTExLCAxMTUsICA0OSwgIDUzLAogICAgIDk3LCAxMTIsIDExNiwgMTAwLCAxMTMsIDEwOSwgMTA5LCAgNTUsIDEwMCwgMTAwLCAxMDMsIDExNiwKICAgICA5OSwgMTE0LCAxMDYsIDExOCwgIDk5LCAgNTMsIDEwNCwgMTE1LCAgNTcsICA1NiwgIDU2LCAxMTQsCiAgICAxMDgsIDExNCwgMTA3LCAxMjIsIDEwMSwgIDUyLCAgNDgsIDEwOCwgIDUyLCAxMTMsICA0OCwgMTA0LAogICAgMTAxLCAgMTgsICA0NSwgIDk5LCAxMTEsIDExNSwgMTA5LCAxMTEsIDExNSwgIDQ5LCAgNTUsIDExNiwKICAgIDExOCwgMTAwLCAgNTIsIDEwNCwKICAgIC4uLiAyMjEgbW9yZSBpdGVtcwogIF0sCiAgZ2FzVXNlZDogNzY2NTcsCiAgZ2FzV2FudGVkOiAyMDAwMDAKfQo="}}),e._v(" "),s("p",[e._v("The structure of this output is JSON. There is a serialized "),s("code",[e._v("faucetTx.tx")]),e._v(" of the type "),s("code",[e._v("Uint8Array")]),e._v(". The serialized transaction are the bytes (i.e. "),s("code",[e._v("Uint8")]),e._v(") of the actual transaction that was sent over the testnet by the faucet. It is unintelligible to humans until you deserialize it properly. Use the methods offered by "),s("code",[e._v("cosmjs-types")]),e._v(" "),s("a",{attrs:{href:"https://github.com/confio/cosmjs-types/blob/a14662d/src/cosmos/tx/v1beta1/tx.ts#L230",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("Tx")]),s("OutboundLink")],1),e._v(" to deserialize it.")]),e._v(" "),s("p",[e._v("Add the necessary import at the top:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgVHggfSBmcm9tICZxdW90O2Nvc21qcy10eXBlcy9jb3Ntb3MvdHgvdjFiZXRhMS90eCZxdW90Owo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L3"}}),e._v(" "),s("p",[e._v("Then deserialize the transaction:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZGVjb2RlZFR4OiBUeCA9IFR4LmRlY29kZShmYXVjZXRUeC50eCkKY29uc29sZS5sb2coJnF1b3Q7RGVjb2RlZFR4OiZxdW90OywgZGVjb2RlZFR4KQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L18-L19"}}),e._v(" "),s("p",[e._v("Which, on your next "),s("code",[e._v("npm run experiment")]),e._v(", prints:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"RGVjb2RlZFR4OiB7CiAgc2lnbmF0dXJlczogWwogICAgVWludDhBcnJheSg2NCkgWwogICAgICAxMDYsIDI0NCwgIDI2LCAyMzIsIDE3NSwgIDk2LCAyMzUsIDE2OCwgIDk2LCAgNTUsIDE1NywKICAgICAgMjIyLCAgNDksIDE0MiwgIDY0LCAyMDcsICA2NywgMTA5LCAgNDAsICA0NSwgMTUzLCAyMzIsCiAgICAgIDExMiwgMTM0LCAyNTEsICA5NywgIDcyLCAxNjIsIDE2OSwgIDYyLCAyNDUsIDEzNCwgIDU5LAogICAgICAyNDEsICA3NSwgIDMxLCAxNDYsICAxMSwgMTc2LCAxNTksIDE4NSwgIDQxLCAxMDAsIDE3MSwKICAgICAgMTc1LCAgNzgsIDEyMCwgMTg2LCAgMjQsIDEzNiwgMTAzLCAxNjAsIDIwNSwgIDY0LCAxODAsCiAgICAgIDEzMSwgICA5LCAxMzcsIDE3OCwgMjIxLCAgNjgsICAyOCwgMTIyLCAxNjkKICAgIF0KICBdLAogIGJvZHk6IHsKICAgIG1lbW86ICcnLAogICAgdGltZW91dEhlaWdodDogTG9uZyB7IGxvdzogMCwgaGlnaDogMCwgdW5zaWduZWQ6IHRydWUgfSwKICAgIG1lc3NhZ2VzOiBbIFtPYmplY3RdIF0sCiAgICBleHRlbnNpb25PcHRpb25zOiBbXSwKICAgIG5vbkNyaXRpY2FsRXh0ZW5zaW9uT3B0aW9uczogW10KICB9LAogIGF1dGhJbmZvOiB7CiAgICBzaWduZXJJbmZvczogWyBbT2JqZWN0XSBdLAogICAgZmVlOiB7IGdhc0xpbWl0OiBbTG9uZ10sIHBheWVyOiAnJywgZ3JhbnRlcjogJycsIGFtb3VudDogW0FycmF5XSB9CiAgfQp9Cg=="}}),e._v(" "),s("p",[e._v("The faucet address information you are looking for is inside the "),s("code",[e._v("body.messages")]),e._v(", and must be printed. Add:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coJnF1b3Q7RGVjb2RlZCBtZXNzYWdlczomcXVvdDssIGRlY29kZWRUeC5ib2R5IS5tZXNzYWdlcykK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L20"}}),e._v(" "),s("p",[e._v("Which, on your next "),s("code",[e._v("npm run experiment")]),e._v(", prints:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"RGVjb2RlZCBtZXNzYWdlczogWwogIHsKICAgIHR5cGVVcmw6ICcvY29zbW9zLmJhbmsudjFiZXRhMS5Nc2dTZW5kJywKICAgIHZhbHVlOiBVaW50OEFycmF5KDExMykgWwogICAgICAgMTAsICA0NSwgIDk5LCAxMTEsIDExNSwgMTA5LCAxMTEsIDExNSwgIDQ5LCAgNTMsICA5NywgMTEyLAogICAgICAxMTYsIDEwMCwgMTEzLCAxMDksIDEwOSwgIDU1LCAxMDAsIDEwMCwgMTAzLCAxMTYsICA5OSwgMTE0LAogICAgICAxMDYsIDExOCwgIDk5LCAgNTMsIDEwNCwgMTE1LCAgNTcsICA1NiwgIDU2LCAxMTQsIDEwOCwgMTE0LAogICAgICAxMDcsIDEyMiwgMTAxLCAgNTIsICA0OCwgMTA4LCAgNTIsIDExMywgIDQ4LCAxMDQsIDEwMSwgIDE4LAogICAgICAgNDUsICA5OSwgMTExLCAxMTUsIDEwOSwgMTExLCAxMTUsICA0OSwgIDU1LCAxMTYsIDExOCwgMTAwLAogICAgICAgNTIsIDEwNCwgIDk5LCAxMTUsIDEyMiwgMTEzLCAgNTUsIDEwOCwgIDk5LCAxMjAsIDExNywgMTE5LAogICAgICAxMjIsIDExNCwgMTEzLCAxMDcsIDEwMSwgMTEyLCAxMTcsICA5NywgMTE3LCAgNTcsIDEwMiwgMTIxLAogICAgICAxMDEsICA1MSwgMTAwLCAgOTcsIDEwOCwgIDU0LCAgNDgsICA1NCwgMTIyLCAxMDIsICAyNiwgIDE3LAogICAgICAgMTAsICAgNSwgMTE3LCAgOTcsCiAgICAgIC4uLiAxMyBtb3JlIGl0ZW1zCiAgICBdCiAgfQpdCg=="}}),e._v(" "),s("p",[e._v("Deserializing the transaction has not fully deserialized any messages that it contains, nor their "),s("code",[e._v("value")]),e._v(", which is again a "),s("code",[e._v("Uint8Array")]),e._v(". The transaction deserializer knows how to properly decode any transaction, but it does not know how to do the same for messages. Messages can in fact be of any type, and each type has its own deserializer. This is not something that the "),s("code",[e._v("Tx.decode")]),e._v(" transaction deserializer function knows.")]),e._v(" "),s("h3",{attrs:{id:"what-is-this-long-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-is-this-long-string"}},[e._v("#")]),e._v(" What is this long string?")]),e._v(" "),s("p",[e._v("Note the "),s("code",[e._v('typeUrl: "/cosmos.bank.v1beta1.MsgSend"')]),e._v(" string. This comes from the "),s("RouterLink",{attrs:{to:"/academy/2-main-concepts/protobuf.html"}},[e._v("Protobuf")]),e._v(" definitions and is a mixture of:")],1),e._v(" "),s("ol",[s("li",[s("p",[e._v("The "),s("code",[e._v("package")]),e._v(" where "),s("code",[e._v("MsgSend")]),e._v(" is initially declared:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"protobuf",base64:"cGFja2FnZSBjb3Ntb3MuYmFuay52MWJldGExOwo=",url:"https://github.com/cosmos/cosmos-sdk/blob/3a1027c/proto/cosmos/bank/v1beta1/tx.proto#L2"}})],1),e._v(" "),s("li",[s("p",[e._v("And the name of the message itself, "),s("code",[e._v("MsgSend")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"protobuf",base64:"bWVzc2FnZSBNc2dTZW5kIHsKICAgIC4uLgp9Cg==",url:"https://github.com/cosmos/cosmos-sdk/blob/3a1027c/proto/cosmos/bank/v1beta1/tx.proto#L22"}})],1)]),e._v(" "),s("p",[e._v("This "),s("code",[e._v("typeUrl")]),e._v(" string you see in the decoded message is the canonical identifier of the type of message that's serialized under the "),s("code",[e._v("value")]),e._v(" array. There are many different message types, each coming from different modules or base layers from the Cosmos SDK, and you can find an overview of them "),s("a",{attrs:{href:"https://buf.build/cosmos/cosmos-sdk",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("The blockchain client itself knows how to serialize or deserialize it only because this "),s("code",[e._v('"/cosmos.bank.v1beta1.MsgSend"')]),e._v(" string is passed along. With this "),s("code",[e._v("typeUrl")]),e._v(", the blockchain client and CosmJS are able to pick the right deserializer. This object is also named "),s("code",[e._v("MsgSend")]),e._v(" in "),s("code",[e._v("cosmjs-types")]),e._v(". But in this tutorial, you have picked the deserializer manually.")]),e._v(" "),s("HighlightBox",{attrs:{type:"info"}},[s("p",[e._v("To learn how to make your own types for your own blockchain project, head to "),s("RouterLink",{attrs:{to:"/academy/xl-cosmjs/create-custom.html"}},[e._v("Create my own CosmJS objects")]),e._v(".")],1)]),e._v(" "),s("h3",{attrs:{id:"deserialize-the-message"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deserialize-the-message"}},[e._v("#")]),e._v(" Deserialize the message")]),e._v(" "),s("p",[e._v("Now that you know the only message in the transaction is a "),s("code",[e._v("MsgSend")]),e._v(", you need to deserialize it. First add the necessary import at the top:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgTXNnU2VuZCB9IGZyb20gJnF1b3Q7Y29zbWpzLXR5cGVzL2Nvc21vcy9iYW5rL3YxYmV0YTEvdHgmcXVvdDsK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L2"}}),e._v(" "),s("p",[e._v("Then you deserialize the message. Add:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3Qgc2VuZE1lc3NhZ2U6IE1zZ1NlbmQgPSBNc2dTZW5kLmRlY29kZShkZWNvZGVkVHguYm9keSEubWVzc2FnZXNbMF0udmFsdWUpCmNvbnNvbGUubG9nKCZxdW90O1NlbnQgbWVzc2FnZTomcXVvdDssIHNlbmRNZXNzYWdlKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L2"}}),e._v(" "),s("p",[e._v("Which, on your next "),s("code",[e._v("npm run experiment")]),e._v(", prints:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"U2VudCBtZXNzYWdlOiB7CiAgZnJvbUFkZHJlc3M6ICdjb3Ntb3MxNWFwdGRxbW03ZGRndGNyanZjNWhzOTg4cmxya3plNDBsNHEwaGUnLAogIHRvQWRkcmVzczogJ2Nvc21vczE3dHZkNGhjc3pxN2xjeHV3enJxa2VwdWF1OWZ5ZTNkYWw2MDZ6ZicsCiAgYW1vdW50OiBbIHsgZGVub206ICd1YXRvbScsIGFtb3VudDogJzEwMDAwMDAwJyB9IF0KfQo="}}),e._v(" "),s("p",[e._v("In this message, the "),s("code",[e._v("fromAddress")]),e._v(" is that of the faucet:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZmF1Y2V0OiBzdHJpbmcgPSBzZW5kTWVzc2FnZS5mcm9tQWRkcmVzcwo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L23"}}),e._v(" "),s("p",[e._v("Similar to how you got the balance for Alice, you get the faucet's balance as well. Try this by "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L24",target:"_blank",rel:"noopener noreferrer"}},[e._v("copying"),s("OutboundLink")],1),e._v(" the code to print Alice's balances. When running, you should get:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"RmF1Y2V0IGJhbGFuY2VzOiBbIHsgZGVub206ICd1YXRvbScsIGFtb3VudDogJzg2Nzc3NzMzNzIzNScgfSBdCg=="}}),e._v(" "),s("ExpansionPanel",{attrs:{title:"Getting the faucet address another way"}},[s("p",[e._v("Instead of using the "),s("code",[e._v("decode")]),e._v(" functions that come with the "),s("code",[e._v("Tx")]),e._v(" and "),s("code",[e._v("MsgSend")]),e._v(" imports, you process the data yourself via alternative means. If you would like to experiment more, parse the "),s("code",[e._v("rawLog")]),e._v(" manually as opposed to deserializing the transaction as suggested previously.\n"),s("br"),s("br"),e._v("\nNote the conceptual difference between "),s("code",[e._v("Tx")]),e._v(" and the "),s("code",[e._v("rawLog")]),e._v(". The "),s("code",[e._v("Tx")]),e._v(", or "),s("code",[e._v("MsgSend")]),e._v(", object is an input to the computation that takes place when the transaction is included in a block. The "),s("code",[e._v("rawLog")]),e._v(" is the resulting output of said computation and its content depends on what the blockchain code emitted when executing the transaction.\n"),s("br"),s("br"),e._v("\nFrom the "),s("code",[e._v("IndexedTx")]),e._v(" you see that there is a "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/13ce43c/packages/stargate/src/stargateclient.ts#L64",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("rawLog")]),s("OutboundLink")],1),e._v(", which happens to be a stringified JSON.")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgcmF3TG9nID0gSlNPTi5wYXJzZShmYXVjZXRUeC5yYXdMb2cpCmNvbnNvbGUubG9nKCZxdW90O1JhdyBsb2c6JnF1b3Q7LCBKU09OLnN0cmluZ2lmeShyYXdMb2csIG51bGwsIDQpKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L28-L29"}}),e._v(" "),s("p",[e._v("The structure of the raw log is not always obvious, but in this example it contains:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"WwogICAgewogICAgICAgICZxdW90O2V2ZW50cyZxdW90OzogWwogICAgICAgICAgICAuLi4KICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJnF1b3Q7dHlwZSZxdW90OzogJnF1b3Q7Y29pbl9zcGVudCZxdW90OywKICAgICAgICAgICAgICAgICZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6IFsKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICZxdW90O2tleSZxdW90OzogJnF1b3Q7c3BlbmRlciZxdW90OywKICAgICAgICAgICAgICAgICAgICAgICAgJnF1b3Q7dmFsdWUmcXVvdDs6ICZxdW90O2Nvc21vczE1YXB0ZHFtbTdkZGd0Y3JqdmM1aHM5ODhybHJremU0MGw0cTBoZSZxdW90OwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgLi4uCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICAuLi4KICAgICAgICAgICAgfQogICAgICAgICAgICAuLi4KICAgICAgICBdCiAgICB9Cl0K"}}),e._v(" "),s("p",[e._v("Because this is a JSON file, you're able to fetch the faucet's address as follows:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZmF1Y2V0OiBzdHJpbmcgPSByYXdMb2dbMF0uZXZlbnRzCiAgICAuZmluZCgoZXZlbnRFbDogYW55KSA9Jmd0OyBldmVudEVsLnR5cGUgPT09ICZxdW90O2NvaW5fc3BlbnQmcXVvdDspCiAgICAuYXR0cmlidXRlcy5maW5kKChhdHRyaWJ1dGU6IGFueSkgPSZndDsgYXR0cmlidXRlLmtleSA9PT0gJnF1b3Q7c3BlbmRlciZxdW90OykudmFsdWUK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/723d2a9/experiment.ts#L30-L32"}}),e._v(" "),s("p",[e._v("Although this is a perfectly valid way to extract specific values from a transaction's message, it is not the recommended way to do so. The benefit of importing the message types is that you do not have to manually dig through the raw log of each "),s("code",[e._v("Tx")]),e._v(" you're looking to use in your application.")])],1),e._v(" "),s("p",[e._v("These actions are example uses of the read-only "),s("code",[e._v("StargateClient")]),e._v(" and of the serialization tools that come with CosmJS.")]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("Get the result of the above steps "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/tree/with-stargate-client",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("p",[e._v("Now it is time for Alice to send some tokens back to the faucet.")]),e._v(" "),s("h2",{attrs:{id:"prepare-a-signing-client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prepare-a-signing-client"}},[e._v("#")]),e._v(" Prepare a signing client")]),e._v(" "),s("p",[e._v("If you go through the methods inside "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/stargateclient.ts#L139",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("StargateClient")]),s("OutboundLink")],1),e._v(", you see that it only contains query-type methods and none for sending transactions.")]),e._v(" "),s("p",[e._v("Now, for Alice to send transactions, she needs to be able to sign them. And to be able to sign transactions, she needs access to her "),s("em",[e._v("private keys")]),e._v(" or "),s("em",[e._v("mnemonics")]),e._v(". Or rather she needs a client that has access to those. That is where "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/signingstargateclient.ts#L147",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("SigningStargateClient")]),s("OutboundLink")],1),e._v(" comes in. Conveniently, "),s("code",[e._v("SigningStargateClient")]),e._v(" inherits from "),s("code",[e._v("StargateClient")]),e._v(".")]),e._v(" "),s("p",[e._v("Update your import line:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgSW5kZXhlZFR4LCBTaWduaW5nU3RhcmdhdGVDbGllbnQsIFN0YXJnYXRlQ2xpZW50IH0gZnJvbSAmcXVvdDtAY29zbWpzL3N0YXJnYXRlJnF1b3Q7Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L3"}}),e._v(" "),s("p",[e._v("Look at its declaration by right-clicking on the "),s("code",[e._v("SigningStargateClient")]),e._v(" in your imports and choosing "),s("kbd",[e._v("Go to Definition")]),e._v(".")]),e._v(" "),s("p",[e._v("When you instantiate "),s("code",[e._v("SigningStargateClient")]),e._v(" by using the "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/signingstargateclient.ts#L156",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("connectWithSigner")]),s("OutboundLink")],1),e._v(" method, you need to pass it a "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/signingstargateclient.ts#L158",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[e._v("signer")]),s("OutboundLink")],1),e._v(". In this case, use the "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/proto-signing/src/signer.ts#L21-L24",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("OfflineDirectSigner")]),s("OutboundLink")],1),e._v(" interface.")]),e._v(" "),s("HighlightBox",{attrs:{type:"info"}},[s("p",[e._v("The recommended way to encode messages is by using "),s("code",[e._v("OfflineDirectSigner")]),e._v(", which uses Protobuf. However, hardware wallets such as Ledger do not support this and still require the legacy Amino encoder. If your app requires Amino support, you have to use the "),s("code",[e._v("OfflineAminoSigner")]),e._v(".\n"),s("br"),s("br"),e._v("\nRead more about encoding "),s("a",{attrs:{href:"https://docs.cosmos.network/master/core/encoding.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("p",[e._v("The signer needs access to Alice's "),s("strong",[e._v("private key")]),e._v(", and there are several ways to accomplish this. In this example, use Alice's saved "),s("strong",[e._v("mnemonic")]),e._v(". To load the mnemonic as text in your code you need this import:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgcmVhZEZpbGUgfSBmcm9tICZxdW90O2ZzL3Byb21pc2VzJnF1b3Q7Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L1"}}),e._v(" "),s("p",[e._v("There are several implementations of "),s("code",[e._v("OfflineDirectSigner")]),e._v(" available. The "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/proto-signing/src/directsecp256k1hdwallet.ts#L133",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("DirectSecp256k1HdWallet")]),s("OutboundLink")],1),e._v(" implementation is most relevant to us due to its "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/proto-signing/src/directsecp256k1hdwallet.ts#L140-L141",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("fromMnemonic")]),s("OutboundLink")],1),e._v(" method. Add the import:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgRGlyZWN0U2VjcDI1NmsxSGRXYWxsZXQsIE9mZmxpbmVEaXJlY3RTaWduZXIgfSBmcm9tICZxdW90O0Bjb3NtanMvcHJvdG8tc2lnbmluZyZxdW90Owo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L2"}}),e._v(" "),s("p",[e._v("The "),s("code",[e._v("fromMnemonic")]),e._v(" factory function needs a string with the mnemonic. You read this string from the mnemonic file. Create a new top-level function that returns an "),s("code",[e._v("OfflineDirectSigner")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZ2V0QWxpY2VTaWduZXJGcm9tTW5lbW9uaWMgPSBhc3luYyAoKTogUHJvbWlzZSZsdDtPZmZsaW5lRGlyZWN0U2lnbmVyJmd0OyA9Jmd0OyB7CiAgICByZXR1cm4gRGlyZWN0U2VjcDI1NmsxSGRXYWxsZXQuZnJvbU1uZW1vbmljKChhd2FpdCByZWFkRmlsZSgmcXVvdDsuL3Rlc3RuZXQuYWxpY2UubW5lbW9uaWMua2V5JnF1b3Q7KSkudG9TdHJpbmcoKSwgewogICAgICAgIHByZWZpeDogJnF1b3Q7Y29zbW9zJnF1b3Q7LAogICAgfSkKfQoK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L9-L13"}}),e._v(" "),s("p",[e._v("The Cosmos Hub Testnet uses the "),s("code",[e._v("cosmos")]),e._v(" address prefix. This is the default used by "),s("code",[e._v("DirectSecp256k1HdWallet")]),e._v(", but you are encouraged to explicitly define it as you might be working with different prefixes on different blockchains. In your "),s("code",[e._v("runAll")]),e._v(" function, add:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgYWxpY2VTaWduZXI6IE9mZmxpbmVEaXJlY3RTaWduZXIgPSBhd2FpdCBnZXRBbGljZVNpZ25lckZyb21NbmVtb25pYygpCg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L44"}}),e._v(" "),s("p",[e._v("As a first step, confirm that it recovers Alice's address as expected:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgYWxpY2UgPSAoYXdhaXQgYWxpY2VTaWduZXIuZ2V0QWNjb3VudHMoKSlbMF0uYWRkcmVzcwpjb25zb2xlLmxvZygmcXVvdDtBbGljZSdzIGFkZHJlc3MgZnJvbSBzaWduZXImcXVvdDssIGFsaWNlKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L45-L46"}}),e._v(" "),s("p",[e._v("Now add the line that finally creates the signing client:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3Qgc2lnbmluZ0NsaWVudCA9IGF3YWl0IFNpZ25pbmdTdGFyZ2F0ZUNsaWVudC5jb25uZWN0V2l0aFNpZ25lcihycGMsIGFsaWNlU2lnbmVyKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L47"}}),e._v(" "),s("p",[e._v("Check that it works like the read-only client that you used earlier, and from which "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/signingstargateclient.ts#L147",target:"_blank",rel:"noopener noreferrer"}},[e._v("it inherits"),s("OutboundLink")],1),e._v(", by adding:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coCiAgICAmcXVvdDtXaXRoIHNpZ25pbmcgY2xpZW50LCBjaGFpbiBpZDomcXVvdDssCiAgICBhd2FpdCBzaWduaW5nQ2xpZW50LmdldENoYWluSWQoKSwKICAgICZxdW90OywgaGVpZ2h0OiZxdW90OywKICAgIGF3YWl0IHNpZ25pbmdDbGllbnQuZ2V0SGVpZ2h0KCkKKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/4168b97/experiment.ts#L48-L53"}}),e._v(" "),s("p",[e._v("Run it with "),s("code",[e._v("npm run experiment")]),e._v(".")]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("Get the result of the previous steps "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/tree/with-signing-stargate-client",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("h2",{attrs:{id:"send-tokens"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#send-tokens"}},[e._v("#")]),e._v(" Send tokens")]),e._v(" "),s("p",[e._v("Alice can now send some tokens back to the faucet, but to do so she also needs to pay the network's gas fee. How much gas should she use, and at what price?")]),e._v(" "),s("p",[e._v("She can copy what the faucet did. To discover this, add:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coJnF1b3Q7R2FzIGZlZTomcXVvdDssIGRlY29kZWRUeC5hdXRoSW5mbyEuZmVlIS5hbW91bnQpCmNvbnNvbGUubG9nKCZxdW90O0dhcyBsaW1pdDomcXVvdDssIGRlY29kZWRUeC5hdXRoSW5mbyEuZmVlIS5nYXNMaW1pdC50b1N0cmluZygxMCkpCg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/2c7b137/experiment.ts#L55-L56"}}),e._v(" "),s("p",[e._v("When you run it, it prints:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"R2FzIGZlZTogWyB7IGRlbm9tOiAndWF0b20nLCBhbW91bnQ6ICc1MDAnIH0gXQpHYXMgbGltaXQ6IDIwMDAwMAo="}}),e._v(" "),s("p",[e._v("With the gas information now decided, how does Alice structure her command so that she sends 1% of her holdings, i.e. "),s("code",[e._v("100000uatom")]),e._v(", back to the faucet? "),s("code",[e._v("SigningStargateClient")]),e._v("'s "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/stargate/src/signingstargateclient.ts#L217-L223",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("sendTokens")]),s("OutboundLink")],1),e._v(" function takes a "),s("code",[e._v("Coin[]")]),e._v(" as input. "),s("code",[e._v("Coin")]),e._v(" is simply defined as:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"ZXhwb3J0IGludGVyZmFjZSBDb2luIHsKICAgIGRlbm9tOiBzdHJpbmc7CiAgICBhbW91bnQ6IHN0cmluZzsKfQo=",url:"https://github.com/confio/cosmjs-types/blob/a14662d/src/cosmos/base/v1beta1/coin.ts#L13-L16"}}),e._v(" "),s("p",[e._v("Alice can pick any "),s("code",[e._v("denom")]),e._v(" and any "),s("code",[e._v("amount")]),e._v(" as long as she owns them, the signing client signs the transaction and broadcasts it. In this case it is:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"eyBkZW5vbTogJnF1b3Q7dWF0b20mcXVvdDssIGFtb3VudDogJnF1b3Q7MTAwMDAwJnF1b3Q7IH0K"}}),e._v(" "),s("p",[e._v("With this gas and coin information, add the command:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Ly8gQ2hlY2sgdGhlIGJhbGFuY2Ugb2YgQWxpY2UgYW5kIHRoZSBGYXVjZXQKY29uc29sZS5sb2coJnF1b3Q7QWxpY2UgYmFsYW5jZSBiZWZvcmU6JnF1b3Q7LCBhd2FpdCBjbGllbnQuZ2V0QWxsQmFsYW5jZXMoYWxpY2UpKQpjb25zb2xlLmxvZygmcXVvdDtGYXVjZXQgYmFsYW5jZSBiZWZvcmU6JnF1b3Q7LCBhd2FpdCBjbGllbnQuZ2V0QWxsQmFsYW5jZXMoZmF1Y2V0KSkKLy8gRXhlY3V0ZSB0aGUgc2VuZFRva2VucyBUeCBhbmQgc3RvcmUgdGhlIHJlc3VsdApjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduaW5nQ2xpZW50LnNlbmRUb2tlbnMoCiAgICBhbGljZSwKICAgIGZhdWNldCwKICAgIFt7IGRlbm9tOiAmcXVvdDt1YXRvbSZxdW90OywgYW1vdW50OiAmcXVvdDsxMDAwMDAmcXVvdDsgfV0sCiAgICB7CiAgICAgICAgYW1vdW50OiBbeyBkZW5vbTogJnF1b3Q7dWF0b20mcXVvdDssIGFtb3VudDogJnF1b3Q7NTAwJnF1b3Q7IH1dLAogICAgICAgIGdhczogJnF1b3Q7MjAwMDAwJnF1b3Q7LAogICAgfSwKKQovLyBPdXRwdXQgdGhlIHJlc3VsdCBvZiB0aGUgVHgKY29uc29sZS5sb2coJnF1b3Q7VHJhbnNmZXIgcmVzdWx0OiZxdW90OywgcmVzdWx0KQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/2c7b137/experiment.ts#L57-L63"}}),e._v(" "),s("p",[e._v("To confirm that it worked, add another balance check:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc29sZS5sb2coJnF1b3Q7QWxpY2UgYmFsYW5jZSBhZnRlcjomcXVvdDssIGF3YWl0IGNsaWVudC5nZXRBbGxCYWxhbmNlcyhhbGljZSkpCmNvbnNvbGUubG9nKCZxdW90O0ZhdWNldCBiYWxhbmNlIGFmdGVyOiZxdW90OywgYXdhaXQgY2xpZW50LmdldEFsbEJhbGFuY2VzKGZhdWNldCkpCg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/2c7b137/experiment.ts#L64-L65"}}),e._v(" "),s("p",[e._v("Run this with "),s("code",[e._v("npm run experiment")]),e._v(" and you should get:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"Li4uClRyYW5zZmVyIHJlc3VsdDogewogIGNvZGU6IDAsCiAgaGVpZ2h0OiA5NTA3MTUxLAogIHJhd0xvZzogJ1t7JnF1b3Q7ZXZlbnRzJnF1b3Q7Olt7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDtjb2luX3JlY2VpdmVkJnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7cmVjZWl2ZXImcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7Y29zbW9zMTVhcHRkcW1tN2RkZ3Rjcmp2YzVoczk4OHJscmt6ZTQwbDRxMGhlJnF1b3Q7fSx7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O2Ftb3VudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDsxMDAwMDB1YXRvbSZxdW90O31dfSx7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDtjb2luX3NwZW50JnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7c3BlbmRlciZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDtjb3Ntb3MxN3R2ZDRoY3N6cTdsY3h1d3pycWtlcHVhdTlmeWUzZGFsNjA2emYmcXVvdDt9LHsmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7YW1vdW50JnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90OzEwMDAwMHVhdG9tJnF1b3Q7fV19LHsmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O21lc3NhZ2UmcXVvdDssJnF1b3Q7YXR0cmlidXRlcyZxdW90OzpbeyZxdW90O2tleSZxdW90OzomcXVvdDthY3Rpb24mcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7L2Nvc21vcy5iYW5rLnYxYmV0YTEuTXNnU2VuZCZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDtzZW5kZXImcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7Y29zbW9zMTd0dmQ0aGNzenE3bGN4dXd6cnFrZXB1YXU5ZnllM2RhbDYwNnpmJnF1b3Q7fSx7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O21vZHVsZSZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDtiYW5rJnF1b3Q7fV19LHsmcXVvdDt0eXBlJnF1b3Q7OiZxdW90O3RyYW5zZmVyJnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7cmVjaXBpZW50JnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczE1YXB0ZHFtbTdkZGd0Y3JqdmM1aHM5ODhybHJremU0MGw0cTBoZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDtzZW5kZXImcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7Y29zbW9zMTd0dmQ0aGNzenE3bGN4dXd6cnFrZXB1YXU5ZnllM2RhbDYwNnpmJnF1b3Q7fSx7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O2Ftb3VudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDsxMDAwMDB1YXRvbSZxdW90O31dfV19XScsCiAgdHJhbnNhY3Rpb25IYXNoOiAnN0Y3NzBGMjRDQjNDODA1RkU0NUE4RDI2REQ1RUM1QUEzRjdCOTA2QUE3RDZDQjFGM0ZFOEI1NTRDQkE5M0UxMicsCiAgZ2FzVXNlZDogNzQxOTAsCiAgZ2FzV2FudGVkOiAyMDAwMDAKfQpBbGljZSBiYWxhbmNlIGFmdGVyOiBbIHsgZGVub206ICd1YXRvbScsIGFtb3VudDogJzk4OTk1MDAnIH0gXQpGYXVjZXQgYmFsYW5jZSBhZnRlcjogWyB7IGRlbm9tOiAndWF0b20nLCBhbW91bnQ6ICc4Njc3Nzc0MzcyMzUnIH0gXQo="}}),e._v(" "),s("p",[e._v("According to the "),s("code",[e._v("rawLog")]),e._v(", the faucet received "),s("code",[e._v("100000uatom")]),e._v(". Since Alice ends up with "),s("code",[e._v('"9899500uatom"')]),e._v(", it means she also paid "),s("code",[e._v("500uatom")]),e._v(" for gas.")]),e._v(" "),s("p",[e._v("This concludes your first use of CosmJS to send tokens.")]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("Find the result of all the previous steps "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/tree/send-tokens",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("HighlightBox",{attrs:{type:"note"}},[s("p",[e._v("You connected to a publicly running testnet. Therefore, you depended on someone else to have a blockchain running with an open and publicly available RPC port and faucet. What if you wanted to try connecting to your own locally running blockchain?")])]),e._v(" "),s("h2",{attrs:{id:"with-a-locally-started-chain"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#with-a-locally-started-chain"}},[e._v("#")]),e._v(" With a locally started chain")]),e._v(" "),s("p",[e._v("The easiest option is to reuse the "),s("code",[e._v("simd")]),e._v(" chain that you started in a "),s("RouterLink",{attrs:{to:"/academy/3-my-own-chain/node-api-and-cli.html"}},[e._v("previous module")]),e._v(". Make sure that you have created two accounts, Alice and Bob. You also sent tokens using "),s("code",[e._v("simd")]),e._v(". Be sure to credit enough tokens to Alice.")],1),e._v(" "),s("p",[e._v("When you finally launch "),s("code",[e._v("simd")]),e._v(", you see the line:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL2J1aWxkL3NpbWQgc3RhcnQKLi4uCjQ6MzdQTSBJTkYgU3RhcnRpbmcgUlBDIEhUVFAgc2VydmVyIG9uIDEyNy4wLjAuMToyNjY1NyBtb2R1bGU9cnBjLXNlcnZlcgouLi4K"}}),e._v(" "),s("p",[e._v("Port "),s("code",[e._v("26657")]),e._v(" is the default port for RPC endpoints built with the SDK, unless otherwise configured in "),s("code",[e._v("~/.simapp/config/config.toml")]),e._v(". "),s("code",[e._v("127.0.0.1:26657")]),e._v(" is the URL you need to add to your script later.")]),e._v(" "),s("p",[e._v("Make a copy of your "),s("code",[e._v("experiment.ts")]),e._v(" script, with some adjustments. Name it "),s("code",[e._v("experiment-local.ts")]),e._v(". Add a new run target in "),s("code",[e._v("package.json")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICAgLi4uCiAgICAmcXVvdDtzY3JpcHRzJnF1b3Q7OiB7CiAgICAgICAgLi4uCiAgICAgICAgJnF1b3Q7ZXhwZXJpbWVudC1sb2NhbCZxdW90OzogJnF1b3Q7dHMtbm9kZSBleHBlcmltZW50LWxvY2FsLnRzJnF1b3Q7LAogICAgICAgIC4uLgogICAgfQp9Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/package.json#L8"}}),e._v(" "),s("h2",{attrs:{id:"preparing-your-keys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#preparing-your-keys"}},[e._v("#")]),e._v(" Preparing your keys")]),e._v(" "),s("p",[e._v("Although you have Alice's address, you may not have her mnemonic or private key. The private key is stored in your operating system's keyring backend. For the purpose of this exercise, extract it - generally this is an unsafe operation:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL2J1aWxkL3NpbWQga2V5cyBleHBvcnQgYWxpY2UgLS11bnNhZmUgLS11bmFybW9yZWQtaGV4Cg=="}}),e._v(" "),s("p",[e._v("You get a 64-digit-long hex value. Copy-paste it into a new "),s("code",[e._v("simd.alice.private.key")]),e._v(" file in your "),s("code",[e._v("cosmjs-sandbox")]),e._v(" folder. The "),s("code",[e._v(".gitignore")]),e._v(" was already configured earlier to ignore it, which mitigates the risk.")]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("If you cannot remember which alias you gave your keys, "),s("code",[e._v("list")]),e._v(" them:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCAuL2J1aWxkL3NpbWQga2V5cyBsaXN0Ci0gYWRkcmVzczogY29zbW9zMWMzc3JndXduemFoNW5kNGNuNDlzaGx0dnI2dHNyY2wyanduOGplCiAgbmFtZTogYWxpY2UKICBwdWJrZXk6ICd7JnF1b3Q7QHR5cGUmcXVvdDs6JnF1b3Q7L2Nvc21vcy5jcnlwdG8uc2VjcDI1NmsxLlB1YktleSZxdW90OywmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7QWhSN1NXV0RzYVN4QkQ5ci9tSWhiVk9XYXA3MGpBM1dwQklxak9KbzREd3AmcXVvdDt9JwogIHR5cGU6IGxvY2FsCi0gYWRkcmVzczogY29zbW9zMXVtcHh3YWV6bWFkNDI2bnQ3ZHgzeHp2NXUwdTd3amMwa2o3cGxlCiAgbmFtZTogYm9iCiAgcHVia2V5OiAneyZxdW90O0B0eXBlJnF1b3Q7OiZxdW90Oy9jb3Ntb3MuY3J5cHRvLnNlY3AyNTZrMS5QdWJLZXkmcXVvdDssJnF1b3Q7a2V5JnF1b3Q7OiZxdW90O0F2MVZXMjMvbGFYV3Rid1d3T1VIQ3ZqamVMTHFiZHphelJuZWVSc0Uvc2hMJnF1b3Q7fScKICB0eXBlOiBsb2NhbAo="}})],1),e._v(" "),s("h2",{attrs:{id:"update-your-script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-your-script"}},[e._v("#")]),e._v(" Update your script")]),e._v(" "),s("p",[e._v("With the new elements in place, update your "),s("code",[e._v("experiment-local.ts")]),e._v(" script. Change "),s("code",[e._v("rpc")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgcnBjID0gJnF1b3Q7aHR0cDovLzEyNy4wLjAuMToyNjY1NyZxdW90Owo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L6"}}),e._v(" "),s("p",[e._v("And skip the lengthy process to get the faucet address. Just set "),s("code",[e._v("faucet")]),e._v(" to Bob's address:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZmF1Y2V0OiBzdHJpbmcgPSAmcXVvdDtjb3Ntb3MxdW1weHdhZXptYWQ0MjZudDdkeDN4enY1dTB1N3dqYzBrajdwbGUmcXVvdDsK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L22"}}),e._v(" "),s("p",[e._v("Next, you need to replace the function to create Alice's signer because you're using a private key instead of a mnemonic, so the "),s("code",[e._v("fromMnemonic")]),e._v(" method that comes with "),s("code",[e._v("DirectSecp256k1HdWallet")]),e._v(" does not work. The "),s("a",{attrs:{href:"https://github.com/cosmos/cosmjs/blob/0f0c9d8/packages/proto-signing/src/directsecp256k1wallet.ts#L21",target:"_blank",rel:"noopener noreferrer"}},[s("code",[e._v("fromKey")]),s("OutboundLink")],1),e._v(" method that comes with "),s("code",[e._v("DirectSecp256k1Wallet")]),e._v(" is the more appropriate choice this time.")]),e._v(" "),s("p",[e._v("Adjust the import:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgRGlyZWN0U2VjcDI1NmsxV2FsbGV0LCBPZmZsaW5lRGlyZWN0U2lnbmVyIH0gZnJvbSAmcXVvdDtAY29zbWpzL3Byb3RvLXNpZ25pbmcmcXVvdDsK",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L3"}}),e._v(" "),s("p",[e._v("In "),s("code",[e._v("DirectSecp256k1Wallet")]),e._v(" the "),s("code",[e._v("fromKey")]),e._v(" factory function needs a "),s("code",[e._v("Uint8Array")]),e._v(". Fortunately, CosmJS includes a utility to convert a hexadecimal string into a "),s("code",[e._v("Uint8Array")]),e._v(". Import it:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"aW1wb3J0IHsgZnJvbUhleCB9IGZyb20gJnF1b3Q7QGNvc21qcy9lbmNvZGluZyZxdW90Owo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L2"}}),e._v(" "),s("p",[e._v("Now create a new function to get a signer to replace the previous one:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgZ2V0QWxpY2VTaWduZXJGcm9tUHJpS2V5ID0gYXN5bmMoKTogUHJvbWlzZSZsdDtPZmZsaW5lRGlyZWN0U2lnbmVyJmd0OyA9Jmd0OyB7CiAgICByZXR1cm4gRGlyZWN0U2VjcDI1NmsxV2FsbGV0LmZyb21LZXkoCiAgICAgICAgZnJvbUhleCgoYXdhaXQgcmVhZEZpbGUoJnF1b3Q7Li9zaW1kLmFsaWNlLnByaXZhdGUua2V5JnF1b3Q7KSkudG9TdHJpbmcoKSksCiAgICAgICAgJnF1b3Q7Y29zbW9zJnF1b3Q7LAogICAgKQp9Cg==",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L8-L13"}}),e._v(" "),s("p",[e._v("Replace "),s("code",[e._v("getAliceSignerFromMnemonic")]),e._v(" with the newly created "),s("code",[e._v("getAliceSignerFromPriKey")]),e._v(":")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"typescript",base64:"Y29uc3QgYWxpY2VTaWduZXI6IE9mZmxpbmVEaXJlY3RTaWduZXIgPSBhd2FpdCBnZXRBbGljZVNpZ25lckZyb21QcmlLZXkoKQo=",url:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L24"}}),e._v(" "),s("p",[e._v("Also change the token unit from "),s("code",[e._v("uatom")]),e._v(" "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/blob/8466986/experiment-local.ts#L37-L38",target:"_blank",rel:"noopener noreferrer"}},[e._v("to "),s("code",[e._v("stake")]),s("OutboundLink")],1),e._v(" in your "),s("code",[e._v("sendTokens")]),e._v(" transaction, because this is the default token when using "),s("code",[e._v("simapp")]),e._v(". Experiment with adjusting the values as desired. Run it with:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"sh",base64:"JCBucG0gcnVuIGV4cGVyaW1lbnQtbG9jYWwK"}}),e._v(" "),s("p",[e._v("And confirm the output is as expected. For instance something like:")]),e._v(" "),s("tm-code-block",{staticClass:"codeblock",attrs:{language:"undefined",base64:"Jmd0OyBjb3NtanMtc2FuZGJveEAxLjAuMCBleHBlcmltZW50LWxvY2FsCiZndDsgdHMtbm9kZSBleHBlcmltZW50LWxvY2FsLnRzCgpXaXRoIGNsaWVudCwgY2hhaW4gaWQ6IGRlbW8gLCBoZWlnaHQ6IDQ0ODgzCkFsaWNlIGJhbGFuY2VzOiBbXQpBbGljZSdzIGFkZHJlc3MgZnJvbSBzaWduZXIgY29zbW9zMWMzc3JndXduemFoNW5kNGNuNDlzaGx0dnI2dHNyY2wyanduOGplCldpdGggc2lnbmluZyBjbGllbnQsIGNoYWluIGlkOiBkZW1vICwgaGVpZ2h0OiA0NDg4MwpBbGljZSBiYWxhbmNlIGJlZm9yZTogWyB7IGRlbm9tOiAnc3Rha2UnLCBhbW91bnQ6ICcxOTg5MTgzNScgfSBdCkZhdWNldCBiYWxhbmNlIGJlZm9yZTogWyB7IGRlbm9tOiAnc3Rha2UnLCBhbW91bnQ6ICcxMDAxMDAwMCcgfSBdClRyYW5zZmVyIHJlc3VsdDogewogIGNvZGU6IDAsCiAgaGVpZ2h0OiA0NDg4NSwKICByYXdMb2c6ICdbeyZxdW90O2V2ZW50cyZxdW90OzpbeyZxdW90O3R5cGUmcXVvdDs6JnF1b3Q7Y29pbl9yZWNlaXZlZCZxdW90OywmcXVvdDthdHRyaWJ1dGVzJnF1b3Q7Olt7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O3JlY2VpdmVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczF1bXB4d2Flem1hZDQyNm50N2R4M3h6djV1MHU3d2pjMGtqN3BsZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDthbW91bnQmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7MTAwMDAwc3Rha2UmcXVvdDt9XX0seyZxdW90O3R5cGUmcXVvdDs6JnF1b3Q7Y29pbl9zcGVudCZxdW90OywmcXVvdDthdHRyaWJ1dGVzJnF1b3Q7Olt7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O3NwZW5kZXImcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7Y29zbW9zMWMzc3JndXduemFoNW5kNGNuNDlzaGx0dnI2dHNyY2wyanduOGplJnF1b3Q7fSx7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O2Ftb3VudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDsxMDAwMDBzdGFrZSZxdW90O31dfSx7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDttZXNzYWdlJnF1b3Q7LCZxdW90O2F0dHJpYnV0ZXMmcXVvdDs6W3smcXVvdDtrZXkmcXVvdDs6JnF1b3Q7YWN0aW9uJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90Oy9jb3Ntb3MuYmFuay52MWJldGExLk1zZ1NlbmQmcXVvdDt9LHsmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7c2VuZGVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczFjM3NyZ3V3bnphaDVuZDRjbjQ5c2hsdHZyNnRzcmNsMmp3bjhqZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDttb2R1bGUmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7YmFuayZxdW90O31dfSx7JnF1b3Q7dHlwZSZxdW90OzomcXVvdDt0cmFuc2ZlciZxdW90OywmcXVvdDthdHRyaWJ1dGVzJnF1b3Q7Olt7JnF1b3Q7a2V5JnF1b3Q7OiZxdW90O3JlY2lwaWVudCZxdW90OywmcXVvdDt2YWx1ZSZxdW90OzomcXVvdDtjb3Ntb3MxdW1weHdhZXptYWQ0MjZudDdkeDN4enY1dTB1N3dqYzBrajdwbGUmcXVvdDt9LHsmcXVvdDtrZXkmcXVvdDs6JnF1b3Q7c2VuZGVyJnF1b3Q7LCZxdW90O3ZhbHVlJnF1b3Q7OiZxdW90O2Nvc21vczFjM3NyZ3V3bnphaDVuZDRjbjQ5c2hsdHZyNnRzcmNsMmp3bjhqZSZxdW90O30seyZxdW90O2tleSZxdW90OzomcXVvdDthbW91bnQmcXVvdDssJnF1b3Q7dmFsdWUmcXVvdDs6JnF1b3Q7MTAwMDAwc3Rha2UmcXVvdDt9XX1dfV0nLAogIHRyYW5zYWN0aW9uSGFzaDogJ0E0OUVCRDQxRTM3Q0RBQ0YyNThGMEJDRDA5NTRDNTIxMzhGQjUxMjFDOUEzQjU4MTM4QTIyNzlFREI1MjZCNkQnLAogIGdhc1VzZWQ6IDcyNzAyLAogIGdhc1dhbnRlZDogMjAwMDAwCn0KQWxpY2UgYmFsYW5jZSBhZnRlcjogWyB7IGRlbm9tOiAnc3Rha2UnLCBhbW91bnQ6ICcxOTc5MTMzNScgfSBdCkZhdWNldCBiYWxhbmNlIGFmdGVyOiBbIHsgZGVub206ICdzdGFrZScsIGFtb3VudDogJzEwMTEwMDAwJyB9IF0K"}}),e._v(" "),s("p",[e._v("You have now used CosmJS's bank module on a locally running Cosmos blockchain.")]),e._v(" "),s("HighlightBox",{attrs:{type:"tip"}},[s("p",[e._v("Find the complete set of files "),s("a",{attrs:{href:"https://github.com/b9lab/cosmjs-sandbox/tree/send-tokens-local",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("h2",{attrs:{id:"next-up"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-up"}},[e._v("#")]),e._v(" Next up")]),e._v(" "),s("p",[e._v("You have sent a transaction with a single message. How about you send a transaction with more than one message? That is the object of the "),s("RouterLink",{attrs:{to:"/academy/xl-cosmjs/multi-msg.html"}},[e._v("next section")]),e._v(". Or skip ahead and send a simple transaction, but this time from a Web browser with the help of "),s("RouterLink",{attrs:{to:"/academy/xl-cosmjs/with-keplr.html"}},[e._v("Keplr")]),e._v(".")],1)],1)}),[],!1,null,null,null);t.default=a.exports}}]);