(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{752:function(c,e,l){"use strict";l.r(e);var a=l(1),t=Object(a.a)({},(function(){var c=this,e=c.$createElement,l=c._self._c||e;return l("ContentSlotsDistributor",{attrs:{"slot-key":c.$parent.slotKey}},[l("h1",{attrs:{id:"interchain-accounts"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#interchain-accounts"}},[c._v("#")]),c._v(" Interchain Accounts")]),c._v(" "),l("HighlightBox",{attrs:{type:"learning"}},[l("p",[l("strong",[c._v("Interchain accounts (ICAs)")]),c._v(" allow you to control an account on a "),l("strong",[c._v("host chain")]),c._v(" from a "),l("strong",[c._v("controller chain")]),c._v(".\n"),l("br"),l("br"),c._v("\nIn this section, you will learn more about:")]),c._v(" "),l("ul",[l("li",[c._v("Hosting chains and controller chains")]),c._v(" "),l("li",[c._v("ICA module code")]),c._v(" "),l("li",[c._v("The authentication module")])])]),c._v(" "),l("p",[c._v("Another application module "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/tree/main/docs/apps/interchain-accounts",target:"_blank",rel:"noopener noreferrer"}},[c._v("implemented in the IBC-Go"),l("OutboundLink")],1),c._v(" repository is "),l("a",{attrs:{href:"https://github.com/cosmos/ibc/blob/master/spec/app/ics-027-interchain-accounts/README.md",target:"_blank",rel:"noopener noreferrer"}},[c._v("interchain accounts (ICS-27)"),l("OutboundLink")],1),c._v(".")]),c._v(" "),l("p",[l("tm-image",{attrs:{src:"/academy/4-ibc/images/icaoverview.png"}})],1),c._v(" "),l("p",[l("strong",[c._v("Host Chain:")]),c._v(" the chain where the interchain account is registered. The host chain listens for IBC packets from a controller chain which should contain instructions (e.g. cosmos SDK messages) which the interchain account will execute.")]),c._v(" "),l("p",[l("strong",[c._v("Controller Chain:")]),c._v(" the chain that registers and controls an account on a host chain. The controller chain sends IBC packets to the host chain to control the account. A controller chain must have at least one interchain accounts authentication module in order to act as a controller chain.")]),c._v(" "),l("HighlightBox",{attrs:{type:"info"}},[l("p",[c._v("The interchain accounts application module is structured to support the ability of exclusively enabling controller or host functionality. This can be achieved by simply omitting either controller or host "),l("code",[c._v("Keeper")]),c._v(" from the interchain accounts "),l("code",[c._v("NewAppModule")]),c._v(" constructor function, and mounting only the desired submodule via the "),l("code",[c._v("IBCRouter")]),c._v(". Alternatively, submodules can be enabled and disabled dynamically using on-chain parameters.")])]),c._v(" "),l("p",[l("strong",[c._v("Authentication Module:")]),c._v(" a custom IBC application module on the controller chain that uses the interchain accounts module API to build custom logic for the creation and management of interchain accounts. An authentication module is required for a controller chain to utilize the interchain accounts module functionality.")]),c._v(" "),l("p",[l("strong",[c._v("interchain account (ICA):")]),c._v(" an account on a host chain. An interchain account has all the capabilities of a normal account. However, rather than signing transactions with a private key, a controller chain's authentication module will send IBC packets to the host chain which signal what transactions the interchain account should execute.")]),c._v(" "),l("p",[c._v("The ICA module provides an API for registering an account and for sending interchain transactions. A developer will use this module by implementing an "),l("strong",[c._v("ICA Auth Module")]),c._v(" ("),l("em",[c._v("authentication module")]),c._v(") and can expose gRPC endpoints for an application or user. Regular accounts use a private key to sign transactions on-chain. interchain accounts are instead controlled programmatically by separate chains via IBC transactions. interchain accounts are implemented as sub-accounts of the interchain accounts module account.")]),c._v(" "),l("p",[c._v("First, look how an account is registered:")]),c._v(" "),l("p",[l("tm-image",{attrs:{src:"/academy/4-ibc/images/icaregister.png"}})],1),c._v(" "),l("p",[c._v("To register an account on the host chain, the function "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/controller/keeper/account.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("RegisterInterchainAccount")]),l("OutboundLink")],1),c._v(" is called on the controller chain:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gUmVnaXN0ZXJJbnRlcmNoYWluQWNjb3VudCBpcyB0aGUgZW50cnkgcG9pbnQgdG8gcmVnaXN0ZXJpbmcgYW4gaW50ZXJjaGFpbiBhY2NvdW50LgovLyBJdCBnZW5lcmF0ZXMgYSBuZXcgcG9ydCBpZGVudGlmaWVyIHVzaW5nIHRoZSBvd25lciBhZGRyZXNzLiBJdCB3aWxsIGJpbmQgdG8gdGhlCi8vIHBvcnQgaWRlbnRpZmllciBhbmQgY2FsbCAwNC1jaGFubmVsICdDaGFuT3BlbkluaXQnLiBBbiBlcnJvciBpcyByZXR1cm5lZCBpZiB0aGUgcG9ydAovLyBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdXNlLiBHYWluaW5nIGFjY2VzcyB0byBpbnRlcmNoYWluIGFjY291bnRzIHdob3NlIGNoYW5uZWxzCi8vIGhhdmUgY2xvc2VkIGNhbm5vdCBiZSBkb25lIHdpdGggdGhpcyBmdW5jdGlvbi4gQSByZWd1bGFyIE1zZ0NoYW5PcGVuSW5pdCBtdXN0IGJlIHVzZWQuCmZ1bmMgKGsgS2VlcGVyKSBSZWdpc3RlckludGVyY2hhaW5BY2NvdW50KGN0eCBzZGsuQ29udGV4dCwgY29ubmVjdGlvbklELCBvd25lciBzdHJpbmcpIGVycm9yIHsKICAgIHBvcnRJRCwgZXJyIDo9IGljYXR5cGVzLk5ld0NvbnRyb2xsZXJQb3J0SUQob3duZXIpCgogICAgLi4uCgogICAgLy8gaWYgdGhlcmUgaXMgYW4gYWN0aXZlIGNoYW5uZWwgZm9yIHRoaXMgcG9ydElEIC8gY29ubmVjdGlvbklEIHJldHVybiBhbiBlcnJvcgogICAgYWN0aXZlQ2hhbm5lbElELCBmb3VuZCA6PSBrLkdldE9wZW5BY3RpdmVDaGFubmVsKGN0eCwgY29ubmVjdGlvbklELCBwb3J0SUQpCiAgICBpZiBmb3VuZCB7CiAgICAgICAgcmV0dXJuIHNka2Vycm9ycy5XcmFwZihpY2F0eXBlcy5FcnJBY3RpdmVDaGFubmVsQWxyZWFkeVNldCwgJnF1b3Q7ZXhpc3RpbmcgYWN0aXZlIGNoYW5uZWwgJXMgZm9yIHBvcnRJRCAlcyBvbiBjb25uZWN0aW9uICVzIGZvciBvd25lciAlcyZxdW90OywgYWN0aXZlQ2hhbm5lbElELCBwb3J0SUQsIGNvbm5lY3Rpb25JRCwgb3duZXIpCiAgICB9CgogICAgLi4uCgogICAgY29ubmVjdGlvbkVuZCwgZXJyIDo9IGsuY2hhbm5lbEtlZXBlci5HZXRDb25uZWN0aW9uKGN0eCwgY29ubmVjdGlvbklEKQoKICAgIC4uLgoKICAgIG1zZyA6PSBjaGFubmVsdHlwZXMuTmV3TXNnQ2hhbm5lbE9wZW5Jbml0KHBvcnRJRCwgc3RyaW5nKHZlcnNpb25CeXRlcyksIGNoYW5uZWx0eXBlcy5PUkRFUkVELCBbXXN0cmluZ3tjb25uZWN0aW9uSUR9LCBpY2F0eXBlcy5Qb3J0SUQsIGljYXR5cGVzLk1vZHVsZU5hbWUpCgogICAgLi4uCn0K"}}),c._v(" "),l("p",[c._v("The "),l("code",[c._v("portID")]),c._v(" will be the address of the "),l("strong",[c._v("interchain account Owner")]),c._v(" prefixed by the default port prefix of the interchain accounts controller submodule "),l("code",[c._v("icacontroller-")]),c._v(". The ICA module assumes that there is already an IBC connection established between the host and controller chains. As part of "),l("code",[c._v("RegisterInterchainAccount")]),c._v(", it will open an "),l("code",[c._v("ORDERED")]),c._v(" channel.")]),c._v(" "),l("p",[c._v("The ICA module uses "),l("code",[c._v("ORDERED")]),c._v(" channels to maintain the order of transactions when sending packets from a controller chain to a host chain. A limitation when using "),l("code",[c._v("ORDERED")]),c._v(" channels is that when a packet times out the channel will be closed. In the case of a channel closing, a controller chain needs to be able to regain access to the interchain account registered on this channel.")]),c._v(" "),l("p",[c._v("ICAs offer "),l("strong",[c._v("active channels")]),c._v(" to create a new channel using the same controller prefixed chain "),l("code",[c._v("portID")]),c._v(". This means that when an interchain account is registered using the "),l("code",[c._v("RegisterInterchainAccount")]),c._v(" API, a new channel is created on a particular port. During the "),l("code",[c._v("OnChanOpenAck")]),c._v(" and "),l("code",[c._v("OnChanOpenConfirm")]),c._v(" steps (controller & host chain), the "),l("code",[c._v("Active Channel")]),c._v(" for this interchain account is stored in state.")]),c._v(" "),l("p",[c._v("Using the "),l("code",[c._v("Active Channel")]),c._v(" stored in state, it is then possible to create a new channel using the same controller chain portID even if the previously set "),l("code",[c._v("Active Channel")]),c._v(" is in a "),l("code",[c._v("CLOSED")]),c._v(" state.")]),c._v(" "),l("p",[c._v("If the message gets to the host chain (with the "),l("code",[c._v("NewMsgChannelOpenInit")]),c._v(" call shown previously), the ICA module on the host chain also calls "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/host/keeper/account.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("RegisterInterchainAccount")]),l("OutboundLink")],1),c._v(":")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gUmVnaXN0ZXJJbnRlcmNoYWluQWNjb3VudCBhdHRlbXB0cyB0byBjcmVhdGUgYSBuZXcgYWNjb3VudCB1c2luZyB0aGUgcHJvdmlkZWQgYWRkcmVzcyBhbmQKLy8gc3RvcmVzIGl0IGluIHN0YXRlIGtleWVkIGJ5IHRoZSBwcm92aWRlZCBjb25uZWN0aW9uIGFuZCBwb3J0IGlkZW50aWZpZXJzCi8vIElmIGFuIGFjY291bnQgZm9yIHRoZSBwcm92aWRlZCBhZGRyZXNzIGFscmVhZHkgZXhpc3RzIHRoaXMgZnVuY3Rpb24gcmV0dXJucyBlYXJseSAobm8tb3ApCmZ1bmMgKGsgS2VlcGVyKSBSZWdpc3RlckludGVyY2hhaW5BY2NvdW50KGN0eCBzZGsuQ29udGV4dCwgY29ubmVjdGlvbklELCBjb250cm9sbGVyUG9ydElEIHN0cmluZywgYWNjQWRkcmVzcyBzZGsuQWNjQWRkcmVzcykgewogICAgaWYgYWNjIDo9IGsuYWNjb3VudEtlZXBlci5HZXRBY2NvdW50KGN0eCwgYWNjQWRkcmVzcyk7IGFjYyAhPSBuaWwgewogICAgICAgIHJldHVybgogICAgfQoKICAgIGludGVyY2hhaW5BY2NvdW50IDo9IGljYXR5cGVzLk5ld0ludGVyY2hhaW5BY2NvdW50KAogICAgICAgIGF1dGh0eXBlcy5OZXdCYXNlQWNjb3VudFdpdGhBZGRyZXNzKGFjY0FkZHJlc3MpLAogICAgICAgIGNvbnRyb2xsZXJQb3J0SUQsCiAgICApCgogICAgay5hY2NvdW50S2VlcGVyLk5ld0FjY291bnQoY3R4LCBpbnRlcmNoYWluQWNjb3VudCkKICAgIGsuYWNjb3VudEtlZXBlci5TZXRBY2NvdW50KGN0eCwgaW50ZXJjaGFpbkFjY291bnQpCgogICAgay5TZXRJbnRlcmNoYWluQWNjb3VudEFkZHJlc3MoY3R4LCBjb25uZWN0aW9uSUQsIGNvbnRyb2xsZXJQb3J0SUQsIGludGVyY2hhaW5BY2NvdW50LkFkZHJlc3MpCn0K"}}),c._v(" "),l("p",[c._v("This call goes through the "),l("code",[c._v("OnChanOpenTry")]),c._v(" implementation in the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/host/keeper/handshake.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("handshake.go")]),l("OutboundLink")],1),c._v(" on the host chain:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gT25DaGFuT3BlblRyeSBwZXJmb3JtcyBiYXNpYyB2YWxpZGF0aW9uIG9mIHRoZSBJQ0EgY2hhbm5lbAovLyBhbmQgcmVnaXN0ZXJzIGEgbmV3IGludGVyY2hhaW4gYWNjb3VudCAoaWYgaXQgZG9lc24ndCBleGlzdCkuCi8vIFRoZSB2ZXJzaW9uIHJldHVybmVkIHdpbGwgaW5jbHVkZSB0aGUgcmVnaXN0ZXJlZCBpbnRlcmNoYWluCi8vIGFjY291bnQgYWRkcmVzcy4KZnVuYyAoayBLZWVwZXIpIE9uQ2hhbk9wZW5UcnkoCiAgICAuLi4KKSAoc3RyaW5nLCBlcnJvcikgewogICAgLi4uCgogICAgLy8gUmVnaXN0ZXIgaW50ZXJjaGFpbiBhY2NvdW50IGlmIGl0IGRvZXMgbm90IGFscmVhZHkgZXhpc3QKICAgIGsuUmVnaXN0ZXJJbnRlcmNoYWluQWNjb3VudChjdHgsIG1ldGFkYXRhLkhvc3RDb25uZWN0aW9uSWQsIGNvdW50ZXJwYXJ0eS5Qb3J0SWQsIGFjY0FkZHJlc3MpCgogICAgLi4uCn0K"}}),c._v(" "),l("p",[c._v("As a result, a fresh "),l("strong",[c._v("interchain account")]),c._v(" is created on the host chain. You can find the implementations of "),l("code",[c._v("OnChanOpenInit")]),c._v(" and "),l("code",[c._v("OnChanOpenAck")]),c._v(" in the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/controller/keeper/handshake.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("handshake.go")]),l("OutboundLink")],1),c._v(":")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gT25DaGFuT3BlbkluaXQgcGVyZm9ybXMgYmFzaWMgdmFsaWRhdGlvbiBvZiBjaGFubmVsIGluaXRpYWxpemF0aW9uLgovLyBUaGUgY2hhbm5lbCBvcmRlciBtdXN0IGJlIE9SREVSRUQsIHRoZSBjb3VudGVycGFydHkgcG9ydCBpZGVudGlmaWVyCi8vIG11c3QgYmUgdGhlIGhvc3QgY2hhaW4gcmVwcmVzZW50YXRpb24gYXMgZGVmaW5lZCBpbiB0aGUgdHlwZXMgcGFja2FnZSwKLy8gdGhlIGNoYW5uZWwgdmVyc2lvbiBtdXN0IGJlIGVxdWFsIHRvIHRoZSB2ZXJzaW9uIGluIHRoZSB0eXBlcyBwYWNrYWdlLAovLyB0aGVyZSBtdXN0IG5vdCBiZSBhbiBhY3RpdmUgY2hhbm5lbCBmb3IgdGhlIHNwZWNmaWVkIHBvcnQgaWRlbnRpZmllciwKLy8gYW5kIHRoZSBpbnRlcmNoYWluIGFjY291bnRzIG1vZHVsZSBtdXN0IGJlIGFibGUgdG8gY2xhaW0gdGhlIGNoYW5uZWwKLy8gY2FwYWJpbGl0eS4KZnVuYyAoayBLZWVwZXIpIE9uQ2hhbk9wZW5Jbml0KAogICAgY3R4IHNkay5Db250ZXh0LAogICAgb3JkZXIgY2hhbm5lbHR5cGVzLk9yZGVyLAogICAgY29ubmVjdGlvbkhvcHMgW11zdHJpbmcsCiAgICBwb3J0SUQgc3RyaW5nLAogICAgY2hhbm5lbElEIHN0cmluZywKICAgIGNoYW5DYXAgKmNhcGFiaWxpdHl0eXBlcy5DYXBhYmlsaXR5LAogICAgY291bnRlcnBhcnR5IGNoYW5uZWx0eXBlcy5Db3VudGVycGFydHksCiAgICB2ZXJzaW9uIHN0cmluZywKKSBlcnJvciB7CiAgICAuLi4KCiAgICBhY3RpdmVDaGFubmVsSUQsIGZvdW5kIDo9IGsuR2V0QWN0aXZlQ2hhbm5lbElEKGN0eCwgY29ubmVjdGlvbkhvcHNbMF0sIHBvcnRJRCkKICAgIGlmIGZvdW5kIHsKICAgICAgICBjaGFubmVsLCBmb3VuZCA6PSBrLmNoYW5uZWxLZWVwZXIuR2V0Q2hhbm5lbChjdHgsIHBvcnRJRCwgYWN0aXZlQ2hhbm5lbElEKQogICAgICAgIGlmICFmb3VuZCB7CiAgICAgICAgICAgIHBhbmljKGZtdC5TcHJpbnRmKCZxdW90O2FjdGl2ZSBjaGFubmVsIG1hcHBpbmcgc2V0IGZvciAlcyBidXQgY2hhbm5lbCBkb2VzIG5vdCBleGlzdCBpbiBjaGFubmVsIHN0b3JlJnF1b3Q7LCBhY3RpdmVDaGFubmVsSUQpKQogICAgICAgIH0KCiAgICAgICAgaWYgY2hhbm5lbC5TdGF0ZSA9PSBjaGFubmVsdHlwZXMuT1BFTiB7CiAgICAgICAgICAgIHJldHVybiBzZGtlcnJvcnMuV3JhcGYoaWNhdHlwZXMuRXJyQWN0aXZlQ2hhbm5lbEFscmVhZHlTZXQsICZxdW90O2V4aXN0aW5nIGFjdGl2ZSBjaGFubmVsICVzIGZvciBwb3J0SUQgJXMgaXMgYWxyZWFkeSBPUEVOJnF1b3Q7LCBhY3RpdmVDaGFubmVsSUQsIHBvcnRJRCkKICAgICAgICB9CgogICAgICAgIGlmICFpY2F0eXBlcy5Jc1ByZXZpb3VzTWV0YWRhdGFFcXVhbChjaGFubmVsLlZlcnNpb24sIG1ldGFkYXRhKSB7CiAgICAgICAgICAgIHJldHVybiBzZGtlcnJvcnMuV3JhcChpY2F0eXBlcy5FcnJJbnZhbGlkVmVyc2lvbiwgJnF1b3Q7cHJldmlvdXMgYWN0aXZlIGNoYW5uZWwgbWV0YWRhdGEgZG9lcyBub3QgbWF0Y2ggcHJvdmlkZWQgdmVyc2lvbiZxdW90OykKICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIG5pbAp9Cg=="}}),c._v(" "),l("HighlightBox",{attrs:{type:"note"}},[l("p",[c._v("There is a one-to-one mapping between an interchain account and a channel to fulfill the requirements for the Active Channels.")])]),c._v(" "),l("p",[c._v("In the "),l("code",[c._v("OnChanOpenAck")]),c._v(" you can see that the channel ID and account address will be set in the state:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gT25DaGFuT3BlbkFjayBzZXRzIHRoZSBhY3RpdmUgY2hhbm5lbCBmb3IgdGhlIGludGVyY2hhaW4gYWNjb3VudC9vd25lciBwYWlyCi8vIGFuZCBzdG9yZXMgdGhlIGFzc29jaWF0ZWQgaW50ZXJjaGFpbiBhY2NvdW50IGFkZHJlc3MgaW4gc3RhdGUga2V5ZWQgYnkgaXQncyBjb3JyZXNwb25kaW5nIHBvcnQgaWRlbnRpZmllcgpmdW5jIChrIEtlZXBlcikgT25DaGFuT3BlbkFjaygKICAgIGN0eCBzZGsuQ29udGV4dCwKICAgIHBvcnRJRCwKICAgIGNoYW5uZWxJRCBzdHJpbmcsCiAgICBjb3VudGVycGFydHlWZXJzaW9uIHN0cmluZywKKSBlcnJvciB7CiAgICAuLi4KCiAgICBrLlNldEFjdGl2ZUNoYW5uZWxJRChjdHgsIG1ldGFkYXRhLkNvbnRyb2xsZXJDb25uZWN0aW9uSWQsIHBvcnRJRCwgY2hhbm5lbElEKQogICAgay5TZXRJbnRlcmNoYWluQWNjb3VudEFkZHJlc3MoY3R4LCBtZXRhZGF0YS5Db250cm9sbGVyQ29ubmVjdGlvbklkLCBwb3J0SUQsIG1ldGFkYXRhLkFkZHJlc3MpCgogICAgcmV0dXJuIG5pbAp9Cg=="}}),c._v(" "),l("p",[c._v("After registration, the registered account can be used to sign transactions on the host chain:")]),c._v(" "),l("p",[l("tm-image",{attrs:{src:"/academy/4-ibc/images/icasendtx.png"}})],1),c._v(" "),l("p",[c._v("You can find "),l("code",[c._v("SendTx")]),c._v(" in the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/controller/keeper/relay.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("relay.go")]),l("OutboundLink")],1),c._v(":")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gU2VuZFR4IHRha2VzIHByZS1idWlsdCBwYWNrZXQgZGF0YSBjb250YWluaW5nIG1lc3NhZ2VzIHRvIGJlIGV4ZWN1dGVkIG9uIHRoZSBob3N0IGNoYWluIGZyb20gYW4gYXV0aGVudGljYXRpb24gbW9kdWxlIGFuZCBhdHRlbXB0cyB0byBzZW5kIHRoZSBwYWNrZXQuCi8vIFRoZSBwYWNrZXQgc2VxdWVuY2UgZm9yIHRoZSBvdXRnb2luZyBwYWNrZXQgaXMgcmV0dXJuZWQgYXMgYSByZXN1bHQuCi8vIElmIHRoZSBiYXNlIGFwcGxpY2F0aW9uIGhhcyB0aGUgY2FwYWJpbGl0eSB0byBzZW5kIG9uIHRoZSBwcm92aWRlZCBwb3J0SUQuIEFuIGFwcHJvcHJpYXRlCi8vIGFic29sdXRlIHRpbWVvdXRUaW1lc3RhbXAgbXVzdCBiZSBwcm92aWRlZC4gSWYgdGhlIHBhY2tldCBpcyB0aW1lZCBvdXQsIHRoZSBjaGFubmVsIHdpbGwgYmUgY2xvc2VkLgovLyBJbiB0aGUgY2FzZSBvZiBjaGFubmVsIGNsb3N1cmUsIGEgbmV3IGNoYW5uZWwgbWF5IGJlIHJlb3BlbmVkIHRvIHJlY29ubmVjdCB0byB0aGUgaG9zdCBjaGFpbi4KZnVuYyAoayBLZWVwZXIpIFNlbmRUeChjdHggc2RrLkNvbnRleHQsIGNoYW5DYXAgKmNhcGFiaWxpdHl0eXBlcy5DYXBhYmlsaXR5LCBjb25uZWN0aW9uSUQsIHBvcnRJRCBzdHJpbmcsIGljYVBhY2tldERhdGEgaWNhdHlwZXMuSW50ZXJjaGFpbkFjY291bnRQYWNrZXREYXRhLCB0aW1lb3V0VGltZXN0YW1wIHVpbnQ2NCkgKHVpbnQ2NCwgZXJyb3IpIHsKICAgIGFjdGl2ZUNoYW5uZWxJRCwgZm91bmQgOj0gay5HZXRPcGVuQWN0aXZlQ2hhbm5lbChjdHgsIGNvbm5lY3Rpb25JRCwgcG9ydElEKQoKICAgIC4uLgoKICAgIHNvdXJjZUNoYW5uZWxFbmQsIGZvdW5kIDo9IGsuY2hhbm5lbEtlZXBlci5HZXRDaGFubmVsKGN0eCwgcG9ydElELCBhY3RpdmVDaGFubmVsSUQpCgogICAgLi4uCgogICAgZGVzdGluYXRpb25Qb3J0IDo9IHNvdXJjZUNoYW5uZWxFbmQuR2V0Q291bnRlcnBhcnR5KCkuR2V0UG9ydElEKCkKICAgIGRlc3RpbmF0aW9uQ2hhbm5lbCA6PSBzb3VyY2VDaGFubmVsRW5kLkdldENvdW50ZXJwYXJ0eSgpLkdldENoYW5uZWxJRCgpCgogICAgLi4uCgogICAgcmV0dXJuIGsuY3JlYXRlT3V0Z29pbmdQYWNrZXQoY3R4LCBwb3J0SUQsIGFjdGl2ZUNoYW5uZWxJRCwgZGVzdGluYXRpb25Qb3J0LCBkZXN0aW5hdGlvbkNoYW5uZWwsIGNoYW5DYXAsIGljYVBhY2tldERhdGEsIHRpbWVvdXRUaW1lc3RhbXApCn0K"}}),c._v(" "),l("p",[c._v("This validates the source and destination IDs and uses "),l("code",[c._v("createOutgoingPacket")]),c._v(" to send a transaction, which calls "),l("code",[c._v("SendPacket")]),c._v(" of the IBC core module.")]),c._v(" "),l("p",[c._v("On the host chain, if a packet arrives, "),l("code",[c._v("OnRecvPacket")]),c._v(" in the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/host/keeper/relay.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("relay.go")]),l("OutboundLink")],1),c._v(" is called:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gT25SZWN2UGFja2V0IGhhbmRsZXMgYSBnaXZlbiBpbnRlcmNoYWluIGFjY291bnRzIHBhY2tldCBvbiBhIGRlc3RpbmF0aW9uIGhvc3QgY2hhaW4uCi8vIElmIHRoZSB0cmFuc2FjdGlvbiBpcyBzdWNjZXNzZnVsbHkgZXhlY3V0ZWQsIHRoZSB0cmFuc2FjdGlvbiByZXNwb25zZSBieXRlcyB3aWxsIGJlIHJldHVybmVkLgpmdW5jIChrIEtlZXBlcikgT25SZWN2UGFja2V0KGN0eCBzZGsuQ29udGV4dCwgcGFja2V0IGNoYW5uZWx0eXBlcy5QYWNrZXQpIChbXWJ5dGUsIGVycm9yKSB7CiAgICB2YXIgZGF0YSBpY2F0eXBlcy5JbnRlcmNoYWluQWNjb3VudFBhY2tldERhdGEKCiAgICBpZiBlcnIgOj0gaWNhdHlwZXMuTW9kdWxlQ2RjLlVubWFyc2hhbEpTT04ocGFja2V0LkdldERhdGEoKSwgJmFtcDtkYXRhKTsgZXJyICE9IG5pbCB7CiAgICAgICAgLy8gVW5tYXJzaGFsSlNPTiBlcnJvcnMgYXJlIGluZGV0ZXJtaW5hdGUgYW5kIHRoZXJlZm9yZSBhcmUgbm90IHdyYXBwZWQgYW5kIGluY2x1ZGVkIGluIGZhaWxlZCBhY2tzCiAgICAgICAgcmV0dXJuIG5pbCwgc2RrZXJyb3JzLldyYXBmKGljYXR5cGVzLkVyclVua25vd25EYXRhVHlwZSwgJnF1b3Q7Y2Fubm90IHVubWFyc2hhbCBJQ1MtMjcgaW50ZXJjaGFpbiBhY2NvdW50IHBhY2tldCBkYXRhJnF1b3Q7KQogICAgfQoKICAgIHN3aXRjaCBkYXRhLlR5cGUgewogICAgICAgIGNhc2UgaWNhdHlwZXMuRVhFQ1VURV9UWDoKICAgICAgICAgICAgbXNncywgZXJyIDo9IGljYXR5cGVzLkRlc2VyaWFsaXplQ29zbW9zVHgoay5jZGMsIGRhdGEuRGF0YSkKICAgICAgICAgICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdHhSZXNwb25zZSwgZXJyIDo9IGsuZXhlY3V0ZVR4KGN0eCwgcGFja2V0LlNvdXJjZVBvcnQsIHBhY2tldC5EZXN0aW5hdGlvblBvcnQsIHBhY2tldC5EZXN0aW5hdGlvbkNoYW5uZWwsIG1zZ3MpCiAgICAgICAgICAgIGlmIGVyciAhPSBuaWwgewogICAgICAgICAgICAgICAgcmV0dXJuIG5pbCwgZXJyCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB0eFJlc3BvbnNlLCBuaWwKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4gbmlsLCBpY2F0eXBlcy5FcnJVbmtub3duRGF0YVR5cGUKICAgIH0KfQo="}}),c._v(" "),l("p",[c._v("This calls "),l("code",[c._v("executeTx")]),c._v(" to apply the received transaction on the host chain:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gZXhlY3V0ZVR4IGF0dGVtcHRzIHRvIGV4ZWN1dGUgdGhlIHByb3ZpZGVkIHRyYW5zYWN0aW9uLiBJdCBiZWdpbnMgYnkgYXV0aGVudGljYXRpbmcgdGhlIHRyYW5zYWN0aW9uIHNpZ25lci4KLy8gSWYgYXV0aGVudGljYXRpb24gc3VjY2VlZHMsIGl0IGRvZXMgYmFzaWMgdmFsaWRhdGlvbiBvZiB0aGUgbWVzc2FnZXMgYmVmb3JlIGF0dGVtcHRpbmcgdG8gZGVsaXZlciBlYWNoIG1lc3NhZ2UKLy8gaW50byBzdGF0ZS4gVGhlIHN0YXRlIGNoYW5nZXMgd2lsbCBvbmx5IGJlIGNvbW1pdHRlZCBpZiBhbGwgbWVzc2FnZXMgaW4gdGhlIHRyYW5zYWN0aW9uIHN1Y2NlZWQuIFRodXMgdGhlCi8vIGV4ZWN1dGlvbiBvZiB0aGUgdHJhbnNhY3Rpb24gaXMgYXRvbWljLCBhbGwgc3RhdGUgY2hhbmdlcyBhcmUgcmV2ZXJ0ZWQgaWYgYSBzaW5nbGUgbWVzc2FnZSBmYWlscy4KZnVuYyAoayBLZWVwZXIpIGV4ZWN1dGVUeChjdHggc2RrLkNvbnRleHQsIHNvdXJjZVBvcnQsIGRlc3RQb3J0LCBkZXN0Q2hhbm5lbCBzdHJpbmcsIG1zZ3MgW11zZGsuTXNnKSAoW11ieXRlLCBlcnJvcikgewogICAgY2hhbm5lbCwgZm91bmQgOj0gay5jaGFubmVsS2VlcGVyLkdldENoYW5uZWwoY3R4LCBkZXN0UG9ydCwgZGVzdENoYW5uZWwpCgogICAgLi4uCgogICAgaWYgZXJyIDo9IGsuYXV0aGVudGljYXRlVHgoY3R4LCBtc2dzLCBjaGFubmVsLkNvbm5lY3Rpb25Ib3BzWzBdLCBzb3VyY2VQb3J0KTsKCiAgICAuLi4KCiAgICAvLyBDYWNoZUNvbnRleHQgcmV0dXJucyBhIG5ldyBjb250ZXh0IHdpdGggdGhlIG11bHRpLXN0b3JlIGJyYW5jaGVkIGludG8gYSBjYWNoZWQgc3RvcmFnZSBvYmplY3QKICAgIC8vIHdyaXRlQ2FjaGUgaXMgY2FsbGVkIG9ubHkgaWYgYWxsIG1zZ3Mgc3VjY2VlZCwgcGVyZm9ybWluZyBzdGF0ZSB0cmFuc2l0aW9ucyBhdG9taWNhbGx5CiAgICBjYWNoZUN0eCwgd3JpdGVDYWNoZSA6PSBjdHguQ2FjaGVDb250ZXh0KCkKICAgIGZvciBpLCBtc2cgOj0gcmFuZ2UgbXNncyB7CiAgICAgICAgaWYgZXJyIDo9IG1zZy5WYWxpZGF0ZUJhc2ljKCk7IGVyciAhPSBuaWwgewogICAgICAgICAgICByZXR1cm4gbmlsLCBlcnIKICAgICAgICB9CgogICAgICAgIG1zZ1Jlc3BvbnNlLCBlcnIgOj0gay5leGVjdXRlTXNnKGNhY2hlQ3R4LCBtc2cpCiAgICAgICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgICAgIHJldHVybiBuaWwsIGVycgogICAgICAgIH0KCiAgICAgICAgdHhNc2dEYXRhLkRhdGFbaV0gPSAmYW1wO3Nkay5Nc2dEYXRhewogICAgICAgICAgICBNc2dUeXBlOiBzZGsuTXNnVHlwZVVSTChtc2cpLAogICAgICAgICAgICBEYXRhOiAgICBtc2dSZXNwb25zZSwKICAgICAgICB9CiAgICB9CgogICAgLi4uCn0K"}}),c._v(" "),l("p",[l("code",[c._v("authenticateTx")]),c._v(" ensures that the provided message contains the correct interchain account owner address. "),l("code",[c._v("executeMsg")]),c._v(" will call the message handler and therefore execute the message.")]),c._v(" "),l("h2",{attrs:{id:"sdk-security-model"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#sdk-security-model"}},[c._v("#")]),c._v(" SDK security model")]),c._v(" "),l("p",[c._v("SDK modules on a chain are assumed to be trustworthy. For example, there are no checks to prevent an untrustworthy module from accessing the bank keeper.")]),c._v(" "),l("p",[c._v("The implementation of "),l("a",{attrs:{href:"https://github.com/cosmos/ibc/blob/master/spec/app/ics-027-interchain-accounts/README.md",target:"_blank",rel:"noopener noreferrer"}},[c._v("ICS-27"),l("OutboundLink")],1),c._v(" on "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/tree/main/modules/apps/27-interchain-accounts",target:"_blank",rel:"noopener noreferrer"}},[c._v("ibc-go"),l("OutboundLink")],1),c._v(" uses this assumption in its security considerations. The implementation assumes the authentication module will not try to open channels on owner addresses it does not control.")]),c._v(" "),l("p",[c._v("The implementation assumes other IBC application modules will not bind to ports within the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc/blob/master/spec/app/ics-027-interchain-accounts/README.md",target:"_blank",rel:"noopener noreferrer"}},[c._v("ICS-27"),l("OutboundLink")],1),c._v(" namespace.")]),c._v(" "),l("h2",{attrs:{id:"authentication-module"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#authentication-module"}},[c._v("#")]),c._v(" Authentication module")]),c._v(" "),l("p",[c._v("The "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/tree/main/modules/apps/27-interchain-accounts/controller",target:"_blank",rel:"noopener noreferrer"}},[c._v("controller submodule"),l("OutboundLink")],1),c._v(" is used for account registration and packet sending. It executes only logic required of all controllers of interchain accounts. The type of authentication used to manage the interchain accounts remains unspecified. There may exist many different types of authentication which are desirable for different use cases. Thus the purpose of the authentication module is to wrap the controller module with custom authentication logic.")]),c._v(" "),l("p",[c._v("In "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go",target:"_blank",rel:"noopener noreferrer"}},[c._v("ibc-go"),l("OutboundLink")],1),c._v(", authentication modules are connected to the controller chain via a "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/apps/27-interchain-accounts/controller/ibc_middleware.go",target:"_blank",rel:"noopener noreferrer"}},[c._v("middleware"),l("OutboundLink")],1),c._v(" stack. The controller module is implemented as "),l("a",{attrs:{href:"https://github.com/cosmos/ibc/tree/master/spec/app/ics-030-middleware",target:"_blank",rel:"noopener noreferrer"}},[c._v("middleware"),l("OutboundLink")],1),c._v(" and the authentication module is connected to the controller module as the base application of the middleware stack. To implement an authentication module, the "),l("code",[c._v("IBCModule")]),c._v(" interface must be fulfilled. By implementing the controller module as middleware, any amount of authentication modules can be created and connected to the controller module without writing redundant code.")]),c._v(" "),l("p",[c._v("The "),l("strong",[c._v("authentication module")]),c._v(" must:")]),c._v(" "),l("ul",[l("li",[c._v("Authenticate interchain account owners")]),c._v(" "),l("li",[c._v("Track the associated interchain account address for an owner")]),c._v(" "),l("li",[c._v("Claim the channel capability in "),l("code",[c._v("OnChanOpenInit")])]),c._v(" "),l("li",[c._v("Send packets on behalf of an owner (after authentication)")])]),c._v(" "),l("p",[c._v("The following "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/blob/main/modules/core/05-port/types/module.go",target:"_blank",rel:"noopener noreferrer"}},[l("code",[c._v("IBCModule")]),l("OutboundLink")],1),c._v(" callbacks must be implemented with appropriate custom logic:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gT25DaGFuT3BlbkluaXQgaW1wbGVtZW50cyB0aGUgSUJDTW9kdWxlIGludGVyZmFjZQpmdW5jIChpbSBJQkNNb2R1bGUpIE9uQ2hhbk9wZW5Jbml0KAogICAgY3R4IHNkay5Db250ZXh0LAogICAgb3JkZXIgY2hhbm5lbHR5cGVzLk9yZGVyLAogICAgY29ubmVjdGlvbkhvcHMgW11zdHJpbmcsCiAgICBwb3J0SUQgc3RyaW5nLAogICAgY2hhbm5lbElEIHN0cmluZywKICAgIGNoYW5DYXAgKmNhcGFiaWxpdHl0eXBlcy5DYXBhYmlsaXR5LAogICAgY291bnRlcnBhcnR5IGNoYW5uZWx0eXBlcy5Db3VudGVycGFydHksCiAgICB2ZXJzaW9uIHN0cmluZywKKSBlcnJvciB7CiAgICAvLyB0aGUgYXV0aGVudGljYXRpb24gbW9kdWxlICptdXN0KiBjbGFpbSB0aGUgY2hhbm5lbCBjYXBhYmlsaXR5IG9uIE9uQ2hhbk9wZW5Jbml0CiAgICBpZiBlcnIgOj0gaW0ua2VlcGVyLkNsYWltQ2FwYWJpbGl0eShjdHgsIGNoYW5DYXAsIGhvc3QuQ2hhbm5lbENhcGFiaWxpdHlQYXRoKHBvcnRJRCwgY2hhbm5lbElEKSk7IGVyciAhPSBuaWwgewogICAgICAgIHJldHVybiBlcnIKICAgIH0KCiAgICAvLyBwZXJmb3JtIGN1c3RvbSBsb2dpYwoKICAgIHJldHVybiBuaWwKfQoKLy8gT25DaGFuT3BlbkFjayBpbXBsZW1lbnRzIHRoZSBJQkNNb2R1bGUgaW50ZXJmYWNlCmZ1bmMgKGltIElCQ01vZHVsZSkgT25DaGFuT3BlbkFjaygKICAgIGN0eCBzZGsuQ29udGV4dCwKICAgIHBvcnRJRCwKICAgIGNoYW5uZWxJRCBzdHJpbmcsCiAgICBjb3VudGVycGFydHlWZXJzaW9uIHN0cmluZywKKSBlcnJvciB7CiAgICAvLyBwZXJmb3JtIGN1c3RvbSBsb2dpYwoKICAgIHJldHVybiBuaWwKfQoKLy8gT25DaGFuQ2xvc2VDb25maXJtIGltcGxlbWVudHMgdGhlIElCQ01vZHVsZSBpbnRlcmZhY2UKZnVuYyAoaW0gSUJDTW9kdWxlKSBPbkNoYW5DbG9zZUNvbmZpcm0oCiAgICBjdHggc2RrLkNvbnRleHQsCiAgICBwb3J0SUQsCiAgICBjaGFubmVsSUQgc3RyaW5nLAopIGVycm9yIHsKICAgIC8vIHBlcmZvcm0gY3VzdG9tIGxvZ2ljCgogICAgcmV0dXJuIG5pbAp9CgovLyBPbkFja25vd2xlZGdlbWVudFBhY2tldCBpbXBsZW1lbnRzIHRoZSBJQkNNb2R1bGUgaW50ZXJmYWNlCmZ1bmMgKGltIElCQ01vZHVsZSkgT25BY2tub3dsZWRnZW1lbnRQYWNrZXQoCiAgICBjdHggc2RrLkNvbnRleHQsCiAgICBwYWNrZXQgY2hhbm5lbHR5cGVzLlBhY2tldCwKICAgIGFja25vd2xlZGdlbWVudCBbXWJ5dGUsCiAgICByZWxheWVyIHNkay5BY2NBZGRyZXNzLAopIGVycm9yIHsKICAgIC8vIHBlcmZvcm0gY3VzdG9tIGxvZ2ljCgogICAgcmV0dXJuIG5pbAp9CgovLyBPblRpbWVvdXRQYWNrZXQgaW1wbGVtZW50cyB0aGUgSUJDTW9kdWxlIGludGVyZmFjZS4KZnVuYyAoaW0gSUJDTW9kdWxlKSBPblRpbWVvdXRQYWNrZXQoCiAgICBjdHggc2RrLkNvbnRleHQsCiAgICBwYWNrZXQgY2hhbm5lbHR5cGVzLlBhY2tldCwKICAgIHJlbGF5ZXIgc2RrLkFjY0FkZHJlc3MsCikgZXJyb3IgewogICAgLy8gcGVyZm9ybSBjdXN0b20gbG9naWMKCiAgICByZXR1cm4gbmlsCn0K"}}),c._v(" "),l("p",[c._v("The functions "),l("code",[c._v("OnChanOpenTry")]),c._v(", "),l("code",[c._v("OnChanOpenConfirm")]),c._v(", "),l("code",[c._v("OnChanCloseInit")]),c._v(", and "),l("code",[c._v("OnRecvPacket")]),c._v(" must be defined to fulfill the "),l("code",[c._v("IBCModule")]),c._v(" interface, but they will never be called by the controller module, so they may error or panic.")]),c._v(" "),l("p",[c._v("The authentication module can begin registering interchain accounts by calling "),l("code",[c._v("RegisterInterchainAccount")]),c._v(":")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"aWYgZXJyIDo9IGtlZXBlci5pY2FDb250cm9sbGVyS2VlcGVyLlJlZ2lzdGVySW50ZXJjaGFpbkFjY291bnQoY3R4LCBjb25uZWN0aW9uSUQsIG93bmVyLlN0cmluZygpKTsgZXJyICE9IG5pbCB7CiAgICByZXR1cm4gZXJyCn0KCnJldHVybiBuaWwK"}}),c._v(" "),l("p",[c._v("The authentication module can attempt to send a packet by calling "),l("code",[c._v("SendTx")]),c._v(":")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ci8vIEF1dGhlbnRpY2F0ZSBvd25lcgovLyBwZXJmb3JtIGN1c3RvbSBsb2dpYwoKLy8gQ29uc3RydWN0IGNvbnRyb2xsZXIgcG9ydElEIGJhc2VkIG9uIGludGVyY2hhaW4gYWNjb3VudCBvd25lciBhZGRyZXNzCnBvcnRJRCwgZXJyIDo9IGljYXR5cGVzLk5ld0NvbnRyb2xsZXJQb3J0SUQob3duZXIuU3RyaW5nKCkpCmlmIGVyciAhPSBuaWwgewogICAgcmV0dXJuIGVycgp9CgpjaGFubmVsSUQsIGZvdW5kIDo9IGtlZXBlci5pY2FDb250cm9sbGVyS2VlcGVyLkdldEFjdGl2ZUNoYW5uZWxJRChjdHgsIHBvcnRJRCkKaWYgIWZvdW5kIHsKICAgIHJldHVybiBzZGtlcnJvcnMuV3JhcGYoaWNhdHlwZXMuRXJyQWN0aXZlQ2hhbm5lbE5vdEZvdW5kLCAmcXVvdDtmYWlsZWQgdG8gcmV0cmlldmUgYWN0aXZlIGNoYW5uZWwgZm9yIHBvcnQgJXMmcXVvdDssIHBvcnRJRCkKfQoKLy8gT2J0YWluIHRoZSBjaGFubmVsIGNhcGFiaWxpdHksIGNsYWltZWQgaW4gT25DaGFuT3BlbkluaXQKY2hhbkNhcCwgZm91bmQgOj0ga2VlcGVyLnNjb3BlZEtlZXBlci5HZXRDYXBhYmlsaXR5KGN0eCwgaG9zdC5DaGFubmVsQ2FwYWJpbGl0eVBhdGgocG9ydElELCBjaGFubmVsSUQpKQppZiAhZm91bmQgewogICAgcmV0dXJuIHNka2Vycm9ycy5XcmFwKGNoYW5uZWx0eXBlcy5FcnJDaGFubmVsQ2FwYWJpbGl0eU5vdEZvdW5kLCAmcXVvdDttb2R1bGUgZG9lcyBub3Qgb3duIGNoYW5uZWwgY2FwYWJpbGl0eSZxdW90OykKfQoKLy8gT2J0YWluIGRhdGEgdG8gYmUgc2VudCB0byB0aGUgaG9zdCBjaGFpbi4KLy8gSW4gdGhpcyBleGFtcGxlLCB0aGUgb3duZXIgb2YgdGhlIGludGVyY2hhaW4gYWNjb3VudCB3b3VsZCBsaWtlIHRvIHNlbmQgYSBiYW5rIE1zZ1NlbmQgdG8gdGhlIGhvc3QgY2hhaW4uCi8vIFRoZSBhcHByb3ByaWF0ZSBzZXJpYWxpemF0aW9uIGZ1bmN0aW9uIHNob3VsZCBiZSBjYWxsZWQuIFRoZSBob3N0IGNoYWluIG11c3QgYmUgYWJsZSB0byBkZXNlcmlhbGl6ZSB0aGUgdHJhbnNhY3Rpb24uCi8vIElmIHRoZSBob3N0IGNoYWluIGlzIHVzaW5nIHRoZSBpYmMtZ28gaG9zdCBtb2R1bGUsIGBTZXJpYWxpemVDb3Ntb3NUeGAgc2hvdWxkIGJlIHVzZWQuCm1zZyA6PSAmYW1wO2Jhbmt0eXBlcy5Nc2dTZW5ke0Zyb21BZGRyZXNzOiBmcm9tQWRkciwgVG9BZGRyZXNzOiB0b0FkZHIsIEFtb3VudDogYW10fQpkYXRhLCBlcnIgOj0gaWNhdHlwZXMuU2VyaWFsaXplQ29zbW9zVHgoa2VlcGVyLmNkYywgW11zZGsuTXNne21zZ30pCmlmIGVyciAhPSBuaWwgewogICAgcmV0dXJuIGVycgp9CgovLyBDb25zdHJ1Y3QgcGFja2V0IGRhdGEKcGFja2V0RGF0YSA6PSBpY2F0eXBlcy5JbnRlcmNoYWluQWNjb3VudFBhY2tldERhdGF7CiAgICBUeXBlOiBpY2F0eXBlcy5FWEVDVVRFX1RYLAogICAgRGF0YTogZGF0YSwKfQoKLy8gT2J0YWluIHRpbWVvdXQgdGltZXN0YW1wCi8vIEFuIGFwcHJvcHJpYXRlIHRpbWVvdXQgdGltZXN0YW1wIG11c3QgYmUgZGV0ZXJtaW5lZCBiYXNlZCBvbiB0aGUgdXNhZ2Ugb2YgdGhlIGludGVyY2hhaW4gYWNjb3VudC4KLy8gSWYgdGhlIHBhY2tldCB0aW1lcyBvdXQsIHRoZSBjaGFubmVsIHdpbGwgYmUgY2xvc2VkIHJlcXVpcmluZyBhIG5ldyBjaGFubmVsIHRvIGJlIGNyZWF0ZWQKdGltZW91dFRpbWVzdGFtcCA6PSBvYnRhaW5UaW1lb3V0VGltZXN0YW1wKCkKCi8vIFNlbmQgdGhlIGludGVyY2hhaW4gYWNjb3VudHMgcGFja2V0LCByZXR1cm5pbmcgdGhlIHBhY2tldCBzZXF1ZW5jZQpzZXEsIGVyciA9IGtlZXBlci5pY2FDb250cm9sbGVyS2VlcGVyLlNlbmRUeChjdHgsIGNoYW5DYXAsIHBvcnRJRCwgcGFja2V0RGF0YSwgdGltZW91dFRpbWVzdGFtcCkK"}}),c._v(" "),l("p",[c._v("The data within an "),l("code",[c._v("InterchainAccountPacketData")]),c._v(" must be serialized using a format supported by the host chain. If the host chain is using the "),l("a",{attrs:{href:"https://github.com/cosmos/ibc-go/tree/main/modules/apps/27-interchain-accounts/host",target:"_blank",rel:"noopener noreferrer"}},[c._v("IBC-Go host chain submodule"),l("OutboundLink")],1),c._v(", "),l("code",[c._v("SerializeCosmosTx")]),c._v(" should be used. If the "),l("code",[c._v("InterchainAccountPacketData.Data")]),c._v(" is serialized using a format not support by the host chain, the packet will not be successfully received.")]),c._v(" "),l("p",[c._v("Controller chains will be able to access the acknowledgement written into the host chain state once a relayer relays the acknowledgement. The acknowledgement bytes will be passed to the Authentication Module via the "),l("code",[c._v("OnAcknowledgementPacket")]),c._v(" callback. Authentication Modules are expected to know how to decode the acknowledgement.")]),c._v(" "),l("p",[c._v("If the controller chain is connected to a host chain using the host module on ibc-go, it may interpret the acknowledgement bytes as follows:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"dmFyIGFjayBjaGFubmVsdHlwZXMuQWNrbm93bGVkZ2VtZW50CmlmIGVyciA6PSBjaGFubmVsdHlwZXMuU3ViTW9kdWxlQ2RjLlVubWFyc2hhbEpTT04oYWNrbm93bGVkZ2VtZW50LCAmYW1wO2Fjayk7IGVyciAhPSBuaWwgewogICAgcmV0dXJuIGVycgp9Cgp0eE1zZ0RhdGEgOj0gJmFtcDtzZGsuVHhNc2dEYXRhe30KaWYgZXJyIDo9IHByb3RvLlVubWFyc2hhbChhY2suR2V0UmVzdWx0KCksIHR4TXNnRGF0YSk7IGVyciAhPSBuaWwgewogICAgcmV0dXJuIGVycgp9Cg=="}}),c._v(" "),l("p",[c._v("If the "),l("code",[c._v("txMsgData.Data")]),c._v(" is empty, the host chain is using SDK version > v0.45. The auth module should interpret the "),l("code",[c._v("txMsgData.Responses")]),c._v(" as follows:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Li4uCi8vIHN3aXRjaCBzdGF0ZW1lbnQgZnJvbSBhYm92ZQpjYXNlIDA6CiAgICBmb3IgXywgYW55IDo9IHJhbmdlIHR4TXNnRGF0YS5Nc2dSZXNwb25zZXMgewogICAgICAgIGlmIGVyciA6PSBoYW5kbGVBbnkoYW55KTsgZXJyICE9IG5pbCB7CiAgICAgICAgICAgIHJldHVybiBlcnIKICAgICAgICB9CiAgICB9Cn0K"}}),c._v(" "),l("p",[c._v("A handler is needed to interpret what actions to perform based on the type url of the Any. A router could be used, or more simply a switch statement:")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyBoYW5kbGVBbnkoYW55ICpjb2RlY3R5cGVzLkFueSkgZXJyb3IgewogICAgc3dpdGNoIGFueS5UeXBlVVJMIHsKICAgICAgICBjYXNlIGJhbmt0eXBlcy5Nc2dTZW5kOgogICAgICAgICAgICBtc2dSZXNwb25zZSwgZXJyIDo9IHVucGFja0JhbmtNc2dTZW5kUmVzcG9uc2UoYW55KQogICAgICAgICAgICBpZiBlcnIgIT0gbmlsIHsKICAgICAgICAgICAgICAgIHJldHVybiBlcnIKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaGFuZGxlQmFua1NlbmRNc2cobXNnUmVzcG9uc2UpCgogICAgICAgIGNhc2Ugc3Rha2luZ3R5cGVzLk1zZ0RlbGVnYXRlOgogICAgICAgICAgICBtc2dSZXNwb25zZSwgZXJyIDo9IHVucGFja1N0YWtpbmdEZWxlZ2F0ZVJlc3BvbnNlKGFueSkKICAgICAgICAgICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZVN0YWtpbmdEZWxlZ2F0ZU1zZyhtc2dSZXNwb25zZSkKCiAgICAgICAgICAgIGNhc2UgdHJhbnNmZXJ0eXBlcy5Nc2dUcmFuc2ZlcjoKICAgICAgICAgICAgbXNnUmVzcG9uc2UsIGVyciA6PSB1bnBhY2tJQkNUcmFuc2Zlck1zZ1Jlc3BvbnNlKGFueSkKICAgICAgICAgICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgICAgICAgICByZXR1cm4gZXJyCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGhhbmRsZUlCQ1RyYW5zZmVyTXNnKG1zZ1Jlc3BvbnNlKQoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICByZXR1cm4KICAgIH0KfQo="}}),c._v(" "),l("h2",{attrs:{id:"example-integration"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#example-integration"}},[c._v("#")]),c._v(" Example integration")]),c._v(" "),l("p",[l("a",{attrs:{href:"https://github.com/cosmos/interchain-accounts-demo",target:"_blank",rel:"noopener noreferrer"}},[c._v("Here"),l("OutboundLink")],1),c._v(" is  an end-to-end working demo of interchain accounts. You will notice that it contains a similar "),l("code",[c._v("app.go")]),c._v(" to the generic one which follows.")]),c._v(" "),l("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"Ly8gYXBwLmdvCgovLyBSZWdpc3RlciB0aGUgQXBwTW9kdWxlIGZvciB0aGUgaW50ZXJjaGFpbiBhY2NvdW50cyBtb2R1bGUgYW5kIHRoZSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKLy8gTm90ZTogTm8gYGljYWF1dGhgIGV4aXN0cywgdGhpcyBtdXN0IGJlIHN1YnN0aXR1dGVkIHdpdGggYW4gYWN0dWFsIGludGVyY2hhaW4gYWNjb3VudHMgYXV0aGVudGljYXRpb24gbW9kdWxlCk1vZHVsZUJhc2ljcyA9IG1vZHVsZS5OZXdCYXNpY01hbmFnZXIoCiAgICAuLi4KICAgIGljYS5BcHBNb2R1bGVCYXNpY3t9LAogICAgaWNhYXV0aC5BcHBNb2R1bGVCYXNpY3t9LAogICAgLi4uCikKCi4uLgoKLy8gQWRkIG1vZHVsZSBhY2NvdW50IHBlcm1pc3Npb25zIGZvciB0aGUgaW50ZXJjaGFpbiBhY2NvdW50cyBtb2R1bGUKLy8gT25seSBuZWNlc3NhcnkgZm9yIGhvc3QgY2hhaW4gZnVuY3Rpb25hbGl0eQovLyBFYWNoIGludGVyY2hhaW4gYWNjb3VudCBjcmVhdGVkIG9uIHRoZSBob3N0IGNoYWluIGlzIGRlcml2ZWQgZnJvbSB0aGUgbW9kdWxlIGFjY291bnQgY3JlYXRlZAptYWNjUGVybXMgPSBtYXBbc3RyaW5nXVtdc3RyaW5newogICAgLi4uCiAgICBpY2F0eXBlcy5Nb2R1bGVOYW1lOiAgICAgICAgICAgIG5pbCwKfQoKLi4uCgovLyBBZGQgaW50ZXJjaGFpbiBhY2NvdW50IGtlZXBlcnMgZm9yIGVhY2ggc3VibW9kdWxlIHVzZWQgYW5kIHRoZSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKLy8gSWYgYSBzdWJtb2R1bGUgaXMgYmVpbmcgc3RhdGljYWxseSBkaXNhYmxlZCwgdGhlIGFzc29jaWF0ZWQgS2VlcGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgYWRkZWQuCgp0eXBlIEFwcCBzdHJ1Y3QgewogICAgLi4uCgogICAgSUNBQ29udHJvbGxlcktlZXBlciBpY2Fjb250cm9sbGVya2VlcGVyLktlZXBlcgogICAgSUNBSG9zdEtlZXBlciAgICAgICBpY2Fob3N0a2VlcGVyLktlZXBlcgogICAgSUNBQXV0aEtlZXBlciAgICAgICBpY2FhdXRoa2VlcGVyLktlZXBlcgoKICAgIC4uLgp9CgouLi4KCi8vIENyZWF0ZSBzdG9yZSBrZXlzIGZvciBlYWNoIHN1Ym1vZHVsZSBLZWVwZXIgYW5kIHRoZSBhdXRoZW50aWNhdGlvbiBtb2R1bGUKa2V5cyA6PSBzZGsuTmV3S1ZTdG9yZUtleXMoCiAgICAuLi4KICAgIGljYWNvbnRyb2xsZXJ0eXBlcy5TdG9yZUtleSwKICAgIGljYWhvc3R0eXBlcy5TdG9yZUtleSwKICAgIGljYWF1dGh0eXBlcy5TdG9yZUtleSwKICAgIC4uLgopCgouLi4KCi8vIENyZWF0ZSB0aGUgc2NvcGVkIGtlZXBlcnMgZm9yIGVhY2ggc3VibW9kdWxlIGtlZXBlciBhbmQgYXV0aGVudGljYXRpb24ga2VlcGVyCnNjb3BlZElDQUNvbnRyb2xsZXJLZWVwZXIgOj0gYXBwLkNhcGFiaWxpdHlLZWVwZXIuU2NvcGVUb01vZHVsZShpY2Fjb250cm9sbGVydHlwZXMuU3ViTW9kdWxlTmFtZSkKc2NvcGVkSUNBSG9zdEtlZXBlciA6PSBhcHAuQ2FwYWJpbGl0eUtlZXBlci5TY29wZVRvTW9kdWxlKGljYWhvc3R0eXBlcy5TdWJNb2R1bGVOYW1lKQpzY29wZWRJQ0FBdXRoS2VlcGVyIDo9IGFwcC5DYXBhYmlsaXR5S2VlcGVyLlNjb3BlVG9Nb2R1bGUoaWNhYXV0aHR5cGVzLk1vZHVsZU5hbWUpCgouLi4KCi8vIENyZWF0ZSB0aGUgS2VlcGVyIGZvciBlYWNoIHN1Ym1vZHVsZQphcHAuSUNBQ29udHJvbGxlcktlZXBlciA9IGljYWNvbnRyb2xsZXJrZWVwZXIuTmV3S2VlcGVyKAogICAgYXBwQ29kZWMsIGtleXNbaWNhY29udHJvbGxlcnR5cGVzLlN0b3JlS2V5XSwgYXBwLkdldFN1YnNwYWNlKGljYWNvbnRyb2xsZXJ0eXBlcy5TdWJNb2R1bGVOYW1lKSwKICAgIGFwcC5JQkNLZWVwZXIuQ2hhbm5lbEtlZXBlciwgLy8gbWF5IGJlIHJlcGxhY2VkIHdpdGggbWlkZGxld2FyZSBzdWNoIGFzIGljczI5IGZlZQogICAgYXBwLklCQ0tlZXBlci5DaGFubmVsS2VlcGVyLCAmYW1wO2FwcC5JQkNLZWVwZXIuUG9ydEtlZXBlciwKICAgIGFwcC5BY2NvdW50S2VlcGVyLCBzY29wZWRJQ0FDb250cm9sbGVyS2VlcGVyLCBhcHAuTXNnU2VydmljZVJvdXRlcigpLAopCmFwcC5JQ0FIb3N0S2VlcGVyID0gaWNhaG9zdGtlZXBlci5OZXdLZWVwZXIoCiAgICBhcHBDb2RlYywga2V5c1tpY2Fob3N0dHlwZXMuU3RvcmVLZXldLCBhcHAuR2V0U3Vic3BhY2UoaWNhaG9zdHR5cGVzLlN1Yk1vZHVsZU5hbWUpLAogICAgYXBwLklCQ0tlZXBlci5DaGFubmVsS2VlcGVyLCAmYW1wO2FwcC5JQkNLZWVwZXIuUG9ydEtlZXBlciwKICAgIGFwcC5BY2NvdW50S2VlcGVyLCBzY29wZWRJQ0FIb3N0S2VlcGVyLCBhcHAuTXNnU2VydmljZVJvdXRlcigpLAopCgovLyBDcmVhdGUgaW50ZXJjaGFpbiBhY2NvdW50cyBBcHBNb2R1bGUKaWNhTW9kdWxlIDo9IGljYS5OZXdBcHBNb2R1bGUoJmFtcDthcHAuSUNBQ29udHJvbGxlcktlZXBlciwgJmFtcDthcHAuSUNBSG9zdEtlZXBlcikKCi8vIENyZWF0ZSB5b3VyIGludGVyY2hhaW4gYWNjb3VudHMgYXV0aGVudGljYXRpb24gbW9kdWxlCmFwcC5JQ0FBdXRoS2VlcGVyID0gaWNhYXV0aGtlZXBlci5OZXdLZWVwZXIoYXBwQ29kZWMsIGtleXNbaWNhYXV0aHR5cGVzLlN0b3JlS2V5XSwgYXBwLklDQUNvbnRyb2xsZXJLZWVwZXIsIHNjb3BlZElDQUF1dGhLZWVwZXIpCgovLyBJQ0EgYXV0aCBBcHBNb2R1bGUKaWNhQXV0aE1vZHVsZSA6PSBpY2FhdXRoLk5ld0FwcE1vZHVsZShhcHBDb2RlYywgYXBwLklDQUF1dGhLZWVwZXIpCgovLyBJQ0EgYXV0aCBJQkMgTW9kdWxlCmljYUF1dGhJQkNNb2R1bGUgOj0gaWNhYXV0aC5OZXdJQkNNb2R1bGUoYXBwLklDQUF1dGhLZWVwZXIpCgovLyBDcmVhdGUgaG9zdCBhbmQgY29udHJvbGxlciBJQkMgTW9kdWxlcyBhcyBkZXNpcmVkCmljYUNvbnRyb2xsZXJJQkNNb2R1bGUgOj0gaWNhY29udHJvbGxlci5OZXdJQkNNb2R1bGUoYXBwLklDQUNvbnRyb2xsZXJLZWVwZXIsIGljYUF1dGhJQkNNb2R1bGUpCmljYUhvc3RJQkNNb2R1bGUgOj0gaWNhaG9zdC5OZXdJQkNNb2R1bGUoYXBwLklDQUhvc3RLZWVwZXIpCgovLyBSZWdpc3RlciBob3N0IGFuZCBhdXRoZW50aWNhdGlvbiByb3V0ZXMKaWJjUm91dGVyLkFkZFJvdXRlKGljYWNvbnRyb2xsZXJ0eXBlcy5TdWJNb2R1bGVOYW1lLCBpY2FDb250cm9sbGVySUJDTW9kdWxlKS4KICAgIEFkZFJvdXRlKGljYWhvc3R0eXBlcy5TdWJNb2R1bGVOYW1lLCBpY2FIb3N0SUJDTW9kdWxlKS4KICAgIEFkZFJvdXRlKGljYWF1dGh0eXBlcy5Nb2R1bGVOYW1lLCBpY2FDb250cm9sbGVySUJDTW9kdWxlKSAvLyBOb3RlLCB0aGUgYXV0aGVudGljYXRpb24gbW9kdWxlIGlzIHJvdXRlZCB0byB0aGUgdG9wIGxldmVsIG9mIHRoZSBtaWRkbGV3YXJlIHN0YWNrCgouLi4KCi8vIFJlZ2lzdGVyIGludGVyY2hhaW4gYWNjb3VudHMgYW5kIGF1dGhlbnRpY2F0aW9uIG1vZHVsZSBBcHBNb2R1bGUncwphcHAubW9kdWxlTWFuYWdlciA9IG1vZHVsZS5OZXdNYW5hZ2VyKAogICAgLi4uCiAgICBpY2FNb2R1bGUsCiAgICBpY2FBdXRoTW9kdWxlLAopCgouLi4KCi8vIEFkZCBpbnRlcmNoYWluIGFjY291bnRzIG1vZHVsZSBJbml0R2VuZXNpcyBsb2dpYwphcHAubW0uU2V0T3JkZXJJbml0R2VuZXNpcygKICAgIC4uLgogICAgaWNhdHlwZXMuTW9kdWxlTmFtZSwKICAgIC4uLgopCg=="}}),c._v(" "),l("h2",{attrs:{id:"next-up"}},[l("a",{staticClass:"header-anchor",attrs:{href:"#next-up"}},[c._v("#")]),c._v(" Next up")]),c._v(" "),l("p",[c._v("After having a closer look at the Cosmos SDK security model, the authentication module, and an example integration, discover relaying with IBC in the "),l("RouterLink",{attrs:{to:"/academy/4-ibc/relayer-intro.html"}},[c._v("next section")]),c._v(".")],1)],1)}),[],!1,null,null,null);e.default=t.exports}}]);